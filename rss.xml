<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Hyuto's Blog]]></title><description><![CDATA[Wahyu Setianto Personal Blog.]]></description><link>https://Hyuto.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Tue, 07 Sep 2021 16:38:11 GMT</lastBuildDate><item><title><![CDATA[Digit Recognizer]]></title><description><![CDATA[MNIST Digit Recognizer using Tensorflow.js]]></description><link>https://Hyuto.github.io/showcase/digit-recognizer</link><guid isPermaLink="false">https://Hyuto.github.io/showcase/digit-recognizer</guid><pubDate>Sun, 10 Jan 2021 03:00:00 GMT</pubDate><content:encoded>
                        &lt;div&gt;
                          &lt;h2&gt;Digit Recognizer&lt;/h2&gt;
                          &lt;p&gt;MNIST Digit Recognizer using Tensorflow.js&lt;/p&gt;
                        &lt;/div&gt;
                      </content:encoded></item><item><title><![CDATA[Hoax Classification - BDC Satria Data 2020]]></title><description><![CDATA[Notebook ini adalah script yang kelompok  Catatan Cakrawala  gunakan pada saat mengikuti lomba
BDC Satria Data 2020 yang di selenggarakanâ€¦]]></description><link>https://Hyuto.github.io/bdc-main-notebook/</link><guid isPermaLink="false">https://Hyuto.github.io/bdc-main-notebook/</guid><pubDate>Fri, 16 Oct 2020 17:28:47 GMT</pubDate><content:encoded>var _excluded = [&quot;components&quot;];

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i &lt; arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i &lt; sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i &lt; sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; target[key] = source[key]; } return target; }

/* @jsxRuntime classic */

/* @jsx mdx */
var _frontmatter = {
  &quot;title&quot;: &quot;Hoax Classification - BDC Satria Data 2020&quot;,
  &quot;date&quot;: &quot;2020-10-17T00:28:47&quot;,
  &quot;description&quot;: &quot;Hoax Classification Team Catatan Cakrawala Pada BDC Satria Data 2020&quot;,
  &quot;tags&quot;: &quot;nlp, classification, tensorflow, python&quot;
};
var layoutProps = {
  _frontmatter: _frontmatter
};
var MDXLayout = &quot;wrapper&quot;;
return function MDXContent(_ref) {
  var components = _ref.components,
      props = _objectWithoutProperties(_ref, _excluded);

  return mdx(MDXLayout, _extends({}, layoutProps, props, {
    components: components,
    mdxType: &quot;MDXLayout&quot;
  }), mdx(&quot;p&quot;, null, &quot;Notebook ini adalah script yang kelompok &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Catatan Cakrawala&quot;), &quot; gunakan pada saat mengikuti lomba\nBDC Satria Data 2020 yang di selenggarakan oleh IPB dan PUSPRESNAS.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;author&quot;
  }, &quot;Author&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.linkedin.com/in/dimas-k-jati/&quot;
  }, &quot;Dimas Kuncoro Jati&quot;)), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.linkedin.com/in/muhammadamanda/&quot;
  }, &quot;Muhammad Amanda&quot;)), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.linkedin.com/in/wahyu-setianto/&quot;
  }, &quot;Wahyu Setianto&quot;))), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;running-environment&quot;
  }, &quot;Running Environment&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Platform : Kaggle&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Accelerator : TPU&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Dataset&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Data&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Keterangan&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    href: &quot;https://www.kaggle.com/wahyusetianto/data-bdc&quot;
  }, &quot;BDC - Satria Data Catatan Cakrawala&quot;)), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Data original dan data yang telah di preprocess oleh tim Catatan Cakrawala&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    href: &quot;https://www.kaggle.com/pencarikebahagiaan/modelku&quot;
  }, &quot;Catatan Cakrawala Model&quot;), &quot; &quot;, &quot;[Optional]&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Model terbaik yang telah di train tim Catatan Cakrawala&quot;)))), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;note&quot;
  }, &quot;Note&quot;), mdx(&quot;p&quot;, null, &quot;Github repository : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://github.com/Hyuto/BDC-Satria-Data&quot;
  }, &quot;BDC-Satria-Data&quot;)), mdx(&quot;p&quot;, null, &quot;Notebook ini adalah notebook yang kami run di &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/&quot;
  }, &quot;kaggle&quot;), &quot;, jika anda ingin\nmencoba running notebook ini dengan environment yang sama dengan yang kami gunakan kunjungi link berikut&quot;), mdx(&quot;p&quot;, null, &quot;Kaggle Notebook : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/wahyusetianto/bdc-main-notebook&quot;
  }, &quot;Catatan Cakrawala Notebook - BDC Satria Data&quot;)), mdx(&quot;p&quot;, null, &quot;P.S. Jangan lupa untuk &quot;, mdx(&quot;em&quot;, {
    parentName: &quot;p&quot;
  }, &quot;upvote&quot;), &quot; \uD83D\uDE0A.&quot;), mdx(&quot;h1&quot;, {
    &quot;id&quot;: &quot;bdc---satria-data-2020&quot;
  }, &quot;BDC - Satria Data 2020&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;task&quot;
  }, &quot;Task&quot;), mdx(&quot;p&quot;, null, &quot;Mendeteksi apakah suatu berita adalah hoax atau bukan hoax (&quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Binary Classification&quot;), &quot;).&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;data&quot;
  }, &quot;Data&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Data Gambar&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Data Text (judul dan narasi berita)&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;first-things-first&quot;
  }, &quot;First Things First&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Install &amp; Load Library&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Global SEED-ing&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Keeping Google Cloud Storage PATH&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Install Package yang Dibutuhkan\n!pip install -q --upgrade pip\n!pip install -q efficientnet  # EfficientNet\n!pip -q install sastrawi      # Santrawi\n\n# Imports\nimport os, random, re, string, emoji\nfrom timeit import default_timer\nfrom tqdm.notebook import tqdm\n\n# Kaggle Datasets for checking GCS\nfrom kaggle_datasets import KaggleDatasets\n\n# Scientific tools\nimport numpy as np\nimport pandas as pd\n\n# Plotting tools\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use(\&quot;seaborn-notebook\&quot;)\n\n# Interactive\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\n# Image processing\nfrom PIL import Image\nfrom skimage.transform import rotate\n\n# Tensorflow and Keras\nimport tensorflow as tf\nfrom tensorflow.keras.preprocessing.image import load_img, img_to_array\n\n# Scikit Learn\nfrom sklearn.utils import shuffle\nfrom sklearn.metrics import *\nfrom sklearn.model_selection import *\nfrom sklearn.feature_extraction.text import CountVectorizer\n\n# SEED ALL\nSEED = 42\n\nos.environ[&apos;PYTHONHASHSEED&apos;] = str(SEED)\nrandom.seed(SEED)\nnp.random.seed(SEED)\n\nos.environ[&apos;TF_DETERMINISTIC_OPS&apos;] = str(SEED)\ntf.random.set_seed(SEED)\n\n# GCS PATH\nGCS_PATH = KaggleDatasets().get_gcs_path(&apos;data-bdc&apos;)\n\n# Out\nprint(f&apos;Using Tensorflow Version       : {tf.__version__}&apos;)\nprint(f&apos;Google Cloud Storage Data Path : {GCS_PATH}&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Using Tensorflow Version       : 2.2.0\nGoogle Cloud Storage Data Path : gs://kds-7a3b4bb00789754aa5925da7c7a9217df698684ced337b42a9790257\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;preprocessing-data&quot;
  }, &quot;Preprocessing Data&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan preprocessing data sebelum diolah&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;load-dataset&quot;
  }, &quot;Load Dataset&quot;), mdx(&quot;p&quot;, null, &quot;Load dataset ke memory&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;train = pd.read_excel(&apos;../input/data-bdc/Data BDC - Satria Data 2020/Data Latih/Data Latih BDC.xlsx&apos;)\ntest = pd.read_excel(&apos;../input/data-bdc/Data BDC - Satria Data 2020/Data Uji/Data Uji BDC.xlsx&apos;)\ntrain.head()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;ID&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;label&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;tanggal&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;judul&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;narasi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;nama file gambar&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;71&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-08-17 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Pemakaian Masker Menyebabkan Penyakit Legionna...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;A caller to a radio talk show recently shared ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;71.jpg&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;461&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-17 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Instruksi Gubernur Jateng tentang penilangan ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Yth.Seluruh Anggota Grup Sesuai Instruksi Gube...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;461.png&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;495&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-13 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Foto Jim Rohn: Jokowi adalah presiden terbaik ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Jokowi adalah presiden terbaik dlm sejarah ban...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;495.png&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;550&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-08 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;ini bukan politik, tapi kenyataan Pak Jokowi b...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Maaf Mas2 dan Mbak2, ini bukan politik, tapi k...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;550.png&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;681&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-06-24 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Foto Kadrun kalo lihat foto ini panas dingin&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Kadrun kalo lihat foto ini panas dingin . .&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;681.jpg&quot;)))), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;download-fungsi-tambahan&quot;
  }, &quot;Download Fungsi Tambahan&quot;), mdx(&quot;p&quot;, null, &quot;Mendownload fungsi yang sudah dibuat dari responsitory kami.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;!wget -q https://raw.githubusercontent.com/Hyuto/BDC-Satria-Data/master/Preprocess%20code/RPU.py\n!wget -q https://raw.githubusercontent.com/Hyuto/BDC-Satria-Data/master/Preprocess%20code/Preprocess.py\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;data-gambar&quot;
  }, &quot;Data Gambar&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan preprocessing pada data gambar&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;sesuaikan-path-data-gambar&quot;
  }, &quot;Sesuaikan Path data gambar&quot;), mdx(&quot;p&quot;, null, &quot;Menyesuaikan direktori data gambar&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Train &amp; Test Image PATH\nTRAIN_PATH = &apos;../input/data-bdc/Data BDC - Satria Data 2020/Data Latih/File Gambar Data Latih/&apos;\nTEST_PATH = &apos;../input/data-bdc/Data BDC - Satria Data 2020/Data Uji/File Gambar Data Uji/&apos;\n&quot;)), mdx(&quot;p&quot;, null, &quot;tambahkan Path ke nama file gambar&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to nama file\nTRAIN_IMG = [TRAIN_PATH + x for x in train[&apos;nama file gambar&apos;].values]\nTEST_IMG = [TEST_PATH + x for x in test[&apos;nama file gambar&apos;].values]\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;checking-missing-file&quot;
  }, &quot;Checking Missing File&quot;), mdx(&quot;p&quot;, null, &quot;Mengecek apakah ada file yang hilang / tidak bisa terbaca pada direktori gambar.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def check_missing(files, return_missing_ID = True):\n    \&quot;\&quot;\&quot;\n    Mengecek keberadaan data gambar berdasarkan direktori\n    \&quot;\&quot;\&quot;\n    missing = []\n    for file in files:\n        if not os.path.isfile(file):\n            missing.append(file)\n    print(f&apos;[INFO] Missing {len(missing)} file&apos;)\n    if return_missing_ID:\n        return sorted([int(x.split(&apos;/&apos;)[-1][:-4]) for x in missing])\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Missing pada data TRAIN\nmissing_train = check_missing(TRAIN_IMG)\nmissing_train\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;[INFO] Missing 9 file\n\n[48121, 275477, 343052, 367583, 555990, 697754, 697955, 742855, 743885]\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Missing pada data TEST\nmissing_test = check_missing(TEST_IMG)\nmissing_test\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;[INFO] Missing 2 file\n\n[690192, 693499]\n&quot;)), mdx(&quot;p&quot;, null, &quot;Terdapat 9 file gambar pada data train dan 2 file gambar pada data test yang hilang. Hal ini diduga karena nama file berbeda pada direktori gambar dengan nama file yang ada pada dataframe. Maka dari itu kami melakukan pengecekan nama file pada direktori gambar dengan menyamakan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ID&quot;), &quot;-nya.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def fixing_extensions(missing, path):\n    \&quot;\&quot;\&quot;\n    Membenarkan ekstensi file gambar yang di anggap hilang\n    dari direktori.\n    \&quot;\&quot;\&quot;\n    res = []\n    for miss in missing:\n        fixed = False\n        list_dir = os.listdir(path)\n        for i in range(len(list_dir)):\n            if miss == int(list_dir[i][:-4]):\n                fixed = True\n                res.append((miss, list_dir[i]))\n                break\n        if not fixed:\n            res.append((miss, &apos;404&apos;)) # Not Found\n    return res\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply function\nfixed_missing_train = fixing_extensions(missing_train, TRAIN_PATH)\nfixed_missing_test = fixing_extensions(missing_test, TEST_PATH)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Setelah nama file yang hilang dibenarkan, apply nama file yang benar ke main dataframe.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to train DF\nfor Id, filename in fixed_missing_train:\n    index = train.ID.tolist().index(Id)\n    train.loc[index, &apos;nama file gambar&apos;] = filename\n\n# Apply to test DF\nfor Id, filename in fixed_missing_test:\n    index = test.ID.tolist().index(Id)\n    test.loc[index, &apos;nama file gambar&apos;] = filename\n&quot;)), mdx(&quot;p&quot;, null, &quot;Spesifikasi ulang nama file gambar&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;TRAIN_X = [TRAIN_PATH + x for x in train[&apos;nama file gambar&apos;].values if x != &apos;404&apos;]\nTRAIN_y = train.label.values\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;menampilkan-data-gambar&quot;
  }, &quot;Menampilkan Data Gambar&quot;), mdx(&quot;p&quot;, null, &quot;Menampilkan beberapa data gambar yang ada&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def read_and_resize(path):\n    \&quot;\&quot;\&quot;\n    Read &amp; Resize data gambar\n    \&quot;\&quot;\&quot;\n    img = Image.open(path)\n    img.resize((256, 256), Image.ANTIALIAS)\n    return img\n\ndef show_images(list_dir, label, load_image = read_and_resize, seed = SEED):\n    \&quot;\&quot;\&quot;\n    Menampilkan Gambar Secara acak berdasarkan kelasnya\n    masing - masing sebanyak 5 buah.\n    \&quot;\&quot;\&quot;\n    random.seed(seed)\n    data_0 = random.sample([x for x in zip(list_dir, label) if x[1] == 0], 5)\n    data_1 = random.sample([x for x in zip(list_dir, label) if x[1] == 1], 5)\n    fig, axes = plt.subplots(2, 5, figsize = (20, 10))\n    for i in range(2):\n        if i == 0:\n            data = data_0\n        else:\n            data = data_1\n        for j in range(5):\n            img = load_image(data[j][0])\n            axes[i, j].imshow(img)\n            axes[i, j].set_title(f&apos;Label : {data[j][1]}&apos;, fontsize = 14)\n            axes[i, j].axis(&apos;off&apos;)\n    fig.tight_layout()\n    plt.show()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;show_images(TRAIN_X, TRAIN_y)\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/545399b05d7ca1491d61ceacd714411c/5bd27/output_27_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;50%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAADGUlEQVQoz12SX0xTBxyFf4PhY8GVF+OyhwUDM6iIhOKWGgnEwBJd4txMo4LRJXuZkDmdzogsW5wErYiKDixEENIKSKAFApYJiAW04ril/0vh1tLbll4Y3YXWFuQsNfFlJ/neTr6ch0MsyxKAd9y4XUM7s3Kysz7fo0pLz2xN37U7w84hdWTUsFfzxCBtVk9mvO/GcC+tEuedp3WAloVlMhqmiCwWS9P4+HgfwzBPAFRu2S45vi0nD6mZUuQfOFw0xwX1DtssPF4eVqefDUdXrwCojq5Gby2urF0MBBZlc5z3hIt1nbRbrYdiwpDBMAWGMWCB5+1pmdIjKelZ+CRlK3ILvpKF3oT10y43Xrs86yFB8LTdu7dWf60Cg0PPIIRCYb+fB88vwMN5YTSa18lsNrsZhonGhCvCv2Np0v3F0uztKJR8CtnXhUVRwFlXo4b85+swOfhQj6LGqir/kdcNDi1Eom8mvZy/2+fzDwaFlWGfn28nk8n0Gcuy2+x2+04AmxM2frw/JT0rkLZD8k9mzheFAEqVdzTyWw11lUbXchmATQCSAIjDQSGpt/zCh6Gq7+Kf/3k/3mB7HU/Hjh2lYFAgm9VGcvk1MlvNMufsbNfC0pI6HI3kl589I9L9baox2dgq10TXR68mJ+gV84Ii3DTNDD0mzfkL9KysjEYU9TTj4YhEiUnXh5/qmpSqNiUR/cTa5mvnXAE8H9aDNbrPWuz27KdjFlgcHADkNzS3fH+3rvqmWftIbtW0/qI+VXr6YVHxrx2X/yh3ergSEovF61crf8P5cyWIi/vAqdcOVLUolGi8cxcdivpT4dXIjo6bv0OrvP8WQF5ndw+n7evApH4QvW2qtZfqToz192CsW4N53g8SJydP7duX6yssyA8mbNjQU3+7rvrIQRkuXzqNzubaEiEUydC9MMPhdMcW5t64WqH+9ksJd+aHg6yqRTHqGOofMekGDKN9j6d8AX6ARCKRyOZwJz5o6UqOnbW1XVvVoGhCU2Mj/tJqS6adMxleP4/FJQEmm0tySdFPtYe+SSCieJwrjaP/5T/2SQSXGKzf4QAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/545399b05d7ca1491d61ceacd714411c/f058b/output_27_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/545399b05d7ca1491d61ceacd714411c/c26ae/output_27_0.png 158w&quot;, &quot;/static/545399b05d7ca1491d61ceacd714411c/6bdcf/output_27_0.png 315w&quot;, &quot;/static/545399b05d7ca1491d61ceacd714411c/f058b/output_27_0.png 630w&quot;, &quot;/static/545399b05d7ca1491d61ceacd714411c/40601/output_27_0.png 945w&quot;, &quot;/static/545399b05d7ca1491d61ceacd714411c/78612/output_27_0.png 1260w&quot;, &quot;/static/545399b05d7ca1491d61ceacd714411c/5bd27/output_27_0.png 1432w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Dapat dilihat gambar memiliki resolusi yang &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;berbeda - beda&quot;), &quot;.&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;preprocess-and-resizing&quot;
  }, &quot;Preprocess and Resizing&quot;), mdx(&quot;p&quot;, null, &quot;Untuk mengatasi data gambar dengan resolusi yang berbeda - beda maka dilakukan dengan metode croping pada bagian &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;center&quot;), &quot; gambar dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;resizing&quot;), &quot; gambar tersebut ke ukuran yang di tetapkan.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def load_and_preprocess_image(path: str, size = [256, 256]):\n    \&quot;\&quot;\&quot;\n    Load &amp; Preprocess data gambar\n    \&quot;\&quot;\&quot;\n    image = img_to_array(load_img(path))\n    img = tf.convert_to_tensor(image, dtype=tf.float32)\n    shapes = tf.shape(img)\n    h, w = shapes[-3], shapes[-2]\n    dim = tf.minimum(h, w)\n    img = tf.image.resize_with_crop_or_pad(img, dim, dim)\n    img = tf.image.resize(img, size)\n    img = tf.cast(img, tf.float32) / 255.0\n    return img.numpy()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;show_images(TRAIN_X, TRAIN_y, load_and_preprocess_image)\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/f23197e17aa8023fc2c7acd396292c4d/5bd27/output_31_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;44.93670886075949%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2UlEQVQozwXBiU9SARwA4PdntGWWeWTLI9O5LNfMsUJdp7C0tWqaa820LZ2r2eHWMRWzrWbOqSW4hitX3hfCQhP1oY/34AEiJALv6IE8OQIFj1/fh5AkKdFoNDI9QXxZxnTvY09kN2bkXpBl5gp6zgguvVPNGpoJwx8pStilynlbMwC07OztSXeiUene7m4jx3lanRQj9fJ8j9fjbUJIkgwRBAFWqxUMpHEnMT3Hl5YjgPj0s5B6On+LMFiDLM0C7/MDzXiCRtK0ZVsxg3V9Hfz/Qj6GYXb8/gBsb0cB0+EBBMdxGsMw0Ov1+2r1jCc2+ZQj4XgKxByJg2MpJ1m7y0WptRaYHluEVcsaVVdazFYV5kHt43qgWLfDvrbmYWh6PxzeBkJvcCJms3nDaDSCzboKpNkSSMzKY6/lJkBJ9gG4ei6Zd7g33Z8l30FS0wCYZcOt+vSa/91cB1Njk7C56WMdDioQ3IrCdnQXAsEwhywtLRdgGCbGcZ1obmGx6HxhnrDsZoH4zfOHohf1lYUWm71gbBwT95OYaMXlKyAtpkK7wykOR6Jinl4XLil+FpHKabEZw0U6vUmIJCQmDXv5AGq12RdjDh6ecJj5gU1vWDs1qFy0EY5R3usfYv5yWtgHNBwODT1peDna2SVB9epB1CTvGOi6fWdCVf0I7SkrRycVykEkKzMjaCKXYHi4DzIzUiKoSssP9KugXdIGM2PTIa1y3N9ZUwG9r56Bh+P8TooJWfBZsJp1sG608OqJkciabRXm+r8BoV3wIfFxsayoWAhXLudDemryxpCs3VlVUQndbW9BMSjn5lWTdOvTKuj92AK0y0WLS29xvbIm+DUrh9aOZuekvGOD93Kg+CoDHbpAITGHYrnye3ehqvIBHE1I5j+0dFPFF69DbfV9mBroc7PeCKtZjQDlAwgFfGxuWpK7VJgJNwRpUCLIppZH5Pwez4Gm/wfocZL5D4xx/ne1mvD3AAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/f23197e17aa8023fc2c7acd396292c4d/f058b/output_31_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/f23197e17aa8023fc2c7acd396292c4d/c26ae/output_31_0.png 158w&quot;, &quot;/static/f23197e17aa8023fc2c7acd396292c4d/6bdcf/output_31_0.png 315w&quot;, &quot;/static/f23197e17aa8023fc2c7acd396292c4d/f058b/output_31_0.png 630w&quot;, &quot;/static/f23197e17aa8023fc2c7acd396292c4d/40601/output_31_0.png 945w&quot;, &quot;/static/f23197e17aa8023fc2c7acd396292c4d/78612/output_31_0.png 1260w&quot;, &quot;/static/f23197e17aa8023fc2c7acd396292c4d/5bd27/output_31_0.png 1432w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;image-augmentation&quot;
  }, &quot;Image Augmentation&quot;), mdx(&quot;p&quot;, null, &quot;Karena data yang ada tidak seimbang maka perlu dilakukan penambahan data. Metode yang digunakan untuk menambahkan data yaitu augmentasi data gambar pada kelas yang sedikit dengan melakukan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;random rotation&quot;), &quot;.&quot;), mdx(&quot;p&quot;, null, &quot;Metode Augmentasi yang digunakan.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Rotasi Acak dengan nilai rotasi di random pada kisaran -70 sd 70 derajad\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;data_augmentation = lambda x : (\n    rotate(x, random.randint(-70, 70), mode=&apos;reflect&apos;)\n)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Menampilkan hasil dari augmentasi.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def AUG_test(X):\n    \&quot;\&quot;\&quot;\n    Plot gambar dengan fungsi Augmentasi\n    \&quot;\&quot;\&quot;\n    X = load_and_preprocess_image(X)\n    fig, axes = plt.subplots(1, 5, figsize = (20,10))\n    axes[0].imshow(X)\n    axes[0].set_title(&apos;Actual&apos;, fontsize = 14)\n    axes[0].axis(&apos;off&apos;)\n    for i in range(1, 5):\n        aug = data_augmentation(X)\n        axes[i].imshow(aug)\n        axes[i].set_title(&apos;Augmented&apos;, fontsize = 14)\n        axes[i].axis(&apos;off&apos;)\n    fig.tight_layout()\n    return plt.show()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;for i in random.sample(TRAIN_X, 2):\n    AUG_test(i)\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/6272eec8c1a27d92cf905df980bff40f/5bd27/output_36_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;21.51898734177215%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAABRklEQVQY0wXB20vCUBwA4P15FeFDNwqCXoKILtBLF+zF1yISKcMeAtGofOlFFpaWGArLhZcm1nS6Y9uZ21md1Gkz5n59H6OTr4SqamVCzFITKelyKc8qUrFSfReFbs9K8XwuoTZKglCpCgDuPQxxqlR4EWT0WQHXZT/EWlqSmm8GMQXHcVgGt0RKDAVGjg06btlLs1ME1wtg6BhUFfeWF+aoIr4CMTAoqkYjF6Fe16iDpmH4oZTYHdU22ggsqwMmMQiTScUJx94Ayj+CbmDraGdVy0ROANw+KLpO/Xvr5PkyCAADaCBE1uY99CkcABh1oa23NZ9318pch4AiAX6tb42ZHJ/gNmbG0Jl3U04+JIvx22g2EjhEzp8lm6bOx6Ln3FXQj1xngDSscIm7GH+6vyXLtSoa9ml2cdpTPN5ekcMHPiRKcu4fWZADu740UWMAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/6272eec8c1a27d92cf905df980bff40f/f058b/output_36_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/6272eec8c1a27d92cf905df980bff40f/c26ae/output_36_0.png 158w&quot;, &quot;/static/6272eec8c1a27d92cf905df980bff40f/6bdcf/output_36_0.png 315w&quot;, &quot;/static/6272eec8c1a27d92cf905df980bff40f/f058b/output_36_0.png 630w&quot;, &quot;/static/6272eec8c1a27d92cf905df980bff40f/40601/output_36_0.png 945w&quot;, &quot;/static/6272eec8c1a27d92cf905df980bff40f/78612/output_36_0.png 1260w&quot;, &quot;/static/6272eec8c1a27d92cf905df980bff40f/5bd27/output_36_0.png 1432w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/36ff25b583392546d2970760c1d635cc/5bd27/output_36_1.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;21.51898734177215%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAABQklEQVQY0wXBTUsCQRgAYP9Xx6hbp+gDT2FYQVIkSCEFHroUZERIUpduQQRBB8lC0oOBpO3M7uzXzM7uzOq64mpb6MHb2/MkDNOuqpquYpXgXtCv25RVENZ0BWFiWrSmanrVsigZhF3CGXprfVZrtmUSBWGd6GbFpk5dQaqmIJVglVQSlLKYUQa+78NoFM1c7kXc4eB5AoIgmBimFTPmwG88hofHUlwuH066vgeWRUEjeiQ8b+ZyDg7nIKQfJXCnERkWBi4ccKgyfX+9D1X9G/r9HgxDGWvEiITLoYO/YGtzKTrIrMaIKDAcDIAyGj4/XU6R1oHhcAA/4zBMFM/TrcJxSuaOUmI3u44y6cVmPrch84UdUbo7a9s2bbmOLq+Ke3J7ZaG1tjzXvrk9FZO/sewGsplOzqPsflJcXJ/Ij8bL5z8cvPtEvFtgDgAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/36ff25b583392546d2970760c1d635cc/f058b/output_36_1.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/36ff25b583392546d2970760c1d635cc/c26ae/output_36_1.png 158w&quot;, &quot;/static/36ff25b583392546d2970760c1d635cc/6bdcf/output_36_1.png 315w&quot;, &quot;/static/36ff25b583392546d2970760c1d635cc/f058b/output_36_1.png 630w&quot;, &quot;/static/36ff25b583392546d2970760c1d635cc/40601/output_36_1.png 945w&quot;, &quot;/static/36ff25b583392546d2970760c1d635cc/78612/output_36_1.png 1260w&quot;, &quot;/static/36ff25b583392546d2970760c1d635cc/5bd27/output_36_1.png 1432w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;up-sampling-data&quot;
  }, &quot;Up Sampling Data&quot;), mdx(&quot;p&quot;, null, &quot;Mengapply Preprocess &amp; Augmentasi ke data gambar dan menyimpan gambar pada direktori baru.\nMenggunakan Fungsi tambahan yang sudah di download pada file &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;RPU.py&quot;)), mdx(&quot;p&quot;, null, &quot;Fungsi akan mengembalikan List direktori gambar dan juga labelnya.&quot;), mdx(&quot;p&quot;, null, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ApplyAUG -&gt; IMAGE_DIR, Label&quot;)), mdx(&quot;p&quot;, null, &quot;Contoh Penggunaan&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from RPU import ApplyAUG\n\nTRAIN_X, TRAIN_y = (\n       ApplyAUG(TRAIN_X,               # List atau Array direktori dari gambar\n                TRAIN_y,               # List atau Array kelas(label) dari TRAIN_X [One Hot Encoding]\n                PATH,                  # Direktori data gambar\n                up_sample_ratio = 1,   # Rasio Up Sample\n                up_sample_class = &apos;0&apos;, # Spesifikasi Class yang akan di Up Sample\n                data_aug = data_augmentation,  # Fungsi Augmentasi\n                LP = load_and_preprocess_image # Fungsi Load &amp; Preprocess\n                )\n)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Atau bisa juga menggunakan shell&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;!python RPU.py PATH SIZE TEST_SIZE UP_SAMPLES UP_SAMPLE_CLASS\n&quot;)), mdx(&quot;p&quot;, null, &quot;Namun pada kernel ini tidak akan di gunakan fungsi tersebut. Melaikan menggunakan hasil dari fungsi tersebut, karena kernel ini di run pada TPU &amp; TPU tidak dapat membaca file diluar dari &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;GCS&quot;), &quot; (lokal direktori).&quot;), mdx(&quot;p&quot;, null, &quot;Note : Up Sample data pada Notebook ini didapatkan dengan command berikut&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;!python RPU.py &apos;../input/data-bdc/Data BDC - Satria Data 2020/Data Latih/File Gambar Data Latih/&apos; \\\n                SIZE:512 TEST_SIZE:0.15 UP_SAMPLES:0.5-1-2 UP_SAMPLE_CLASS:0\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;data-text&quot;
  }, &quot;Data Text&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan preprocessing pada data text.&quot;), mdx(&quot;p&quot;, null, &quot;Load fungsi pada file &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Preprocess.py&quot;), &quot; terlebih dahulu&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from Preprocess import *\n&quot;)), mdx(&quot;p&quot;, null, &quot;Pada notebook ini pengolahan data text dilakukan menggunakan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;judul&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;narasi&quot;), &quot;, sehingga perlu dilakukan penyatuan kolom &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;judul&quot;), &quot; dan kolom &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;narasi&quot;), &quot; dipisahkan dengan spasi.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;train[&apos;text&apos;] = (train[&apos;judul&apos;] + &apos; &apos; + train[&apos;narasi&apos;]).apply(lambda x : x.lower())\ntest[&apos;text&apos;] = (test[&apos;judul&apos;] + &apos; &apos; + test[&apos;narasi&apos;]).apply(lambda x : x.lower())\ntrain.head()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;ID&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;label&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;tanggal&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;judul&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;narasi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;nama file gambar&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;text&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;71&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-08-17 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Pemakaian Masker Menyebabkan Penyakit Legionna...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;A caller to a radio talk show recently shared ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;71.jpg&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;pemakaian masker menyebabkan penyakit legionna...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;461&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-17 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Instruksi Gubernur Jateng tentang penilangan ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Yth.Seluruh Anggota Grup Sesuai Instruksi Gube...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;461.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;instruksi gubernur jateng tentang penilangan ...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;495&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-13 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Foto Jim Rohn: Jokowi adalah presiden terbaik ...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Jokowi adalah presiden terbaik dlm sejarah ban...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;495.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;foto jim rohn: jokowi adalah presiden terbaik ...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;550&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-07-08 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;ini bukan politik, tapi kenyataan Pak Jokowi b...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Maaf Mas2 dan Mbak2, ini bukan politik, tapi k...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;550.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;ini bukan politik, tapi kenyataan pak jokowi b...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;681&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;2020-06-24 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Foto Kadrun kalo lihat foto ini panas dingin&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;Kadrun kalo lihat foto ini panas dingin . .&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;681.jpg&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;foto kadrun kalo lihat foto ini panas dingin k...&quot;)))), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengecek-duplicated-values&quot;
  }, &quot;Mengecek Duplicated Values&quot;), mdx(&quot;p&quot;, null, &quot;Mengecek keberadaan data yang berduplikasi.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;train[train.duplicated(subset=[&apos;text&apos;], keep=False)]\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;ID&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;label&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;tanggal&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;judul&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;narasi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;nama file gambar&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;text&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;130974&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2015-11-28 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Jokowi Lebih Memilih Helikopter Buatan Luar Ne...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;INSTING MAKELAR\\n \\n AKU Awalnya kaget, membac...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;130974.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;jokowi lebih memilih helikopter buatan luar ne...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;140123&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2020-06-02 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Foto Sekarang malesiya sapu habis penduduk asi...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Perhatian perhatian Sekarang malesiya makin da...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;140123.jpg&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;foto sekarang malesiya sapu habis penduduk asi...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;188319&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2015-11-28 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Jokowi Lebih Memilih Helikopter Buatan Luar Ne...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;INSTING MAKELAR\\n \\n AKU Awalnya kaget, membac...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;188319.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;jokowi lebih memilih helikopter buatan luar ne...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;312152&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2020-06-02 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Foto Sekarang malesiya sapu habis penduduk asi...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Perhatian perhatian Sekarang malesiya makin da...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;312152.jpg&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;foto sekarang malesiya sapu habis penduduk asi...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;898927&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2018-03-12 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Soal Bocornya NIK dan Nomor KK Sekarang dilemp...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Siapa yang disalahkan ?\\n Saling lempar tanggu...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;898927.jpg&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;soal bocornya nik dan nomor kk sekarang dilemp...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;923503&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;2018-03-12 00:00:00&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;Soal Bocornya NIK dan Nomor KK Sekarang dilemp...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Siapa yang disalahkan ?\\n Saling lempar tanggu...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;923503.png&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: null
  }, &quot;soal bocornya nik dan nomor kk sekarang dilemp...&quot;)))), mdx(&quot;p&quot;, null, &quot;Menghapus data yang berduplikasi&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Drop duplicates row\ntrain = train.drop_duplicates(subset =\&quot;text\&quot;).reset_index()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def clean_up(arr):\n    r\&quot;\&quot;\&quot;\n    Cleanup \\n and lowering text\n    \&quot;\&quot;\&quot;\n    for i in range(len(arr)):\n        arr[i] = arr[i].lower()\n        arr[i] = re.sub(&apos;\\n&apos;, &apos; &apos;, arr[i])\n        arr[i] = &apos; &apos;.join(arr[i].split())\n    return arr\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Init text\ntrain_text = clean_up(train.text.values)\ntest_text = clean_up(test.text.values)\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengekstrack-feature-dari-text&quot;
  }, &quot;Mengekstrack Feature dari Text&quot;), mdx(&quot;p&quot;, null, &quot;Mengekstrack feature seperti &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;URL&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Hashtag&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Tag&quot;), &quot;, dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Emoji&quot;), &quot; dari text untuk melihat informasi dan frekuensi kemunculannya dalam setiap kelas pada data&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;%%time\nFE = FeatureExtraction()\nFE_test = FeatureExtraction()\nFE.fit(train_text, train.label.values)\nFE_test.fit(test_text)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;CPU times: user 6.09 s, sys: 18 ms, total: 6.11 s\nWall time: 6.11 s\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;FE.get_table(&apos;urls&apos;, return_prop = True)\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;urls&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;frekuensi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;max_prop&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;kompas.com&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.333333&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.666667&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;3&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.666667&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;viva.co.id&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;seword.com&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.500000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.500000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.500000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;opishposh.com&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.500000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.500000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.500000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;td&quot;,
    &quot;href&quot;: &quot;https://t.co/jvjxc0jhmp&quot;
  }, &quot;https://t.co/jvjxc0jhmp&quot;)), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;td&quot;,
    &quot;href&quot;: &quot;http://poskotanews.com/%E2%80%A6/pa-212-batalkan-acara&quot;
  }, &quot;http://poskotanews.com/\u2026/pa-212-batalkan-acara&quot;), &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;td&quot;,
    &quot;href&quot;: &quot;http://www.piyunganonline.co&quot;
  }, &quot;www.piyunganonline.co&quot;)), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;td&quot;,
    &quot;href&quot;: &quot;https://goo.gl/2xz5yn&quot;
  }, &quot;https://goo.gl/2xz5yn&quot;)), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, &quot;corona-virus-map.com.exe.&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;left&quot;
  }, mdx(&quot;a&quot;, {
    parentName: &quot;td&quot;,
    &quot;href&quot;: &quot;https://sekolahnews.com/daftar-passing-grade-u&quot;
  }, &quot;https://sekolahnews.com/daftar-passing-grade-u&quot;), &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;85 rows \xD7 5 columns\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;FE.get_table(&apos;hashtags&apos;, return_prop = True)\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;hashtags&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;frekuensi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;max_prop&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#2019gantipresiden&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.133333&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.866667&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;15&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.866667&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#covid19&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;5&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#2019&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;4&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#coronavirus&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;3&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#stayhome&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;3&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#sekolahnews&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#wkwkland&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#abusendal&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#sayapancasila&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;#sayaindonesia&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;356 rows \xD7 5 columns\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;FE.get_table(&apos;tags&apos;, return_prop = True)\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;tags&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;frekuensi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;max_prop&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@jokowi&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.111111&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.888889&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;9&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.888889&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@aniesbaswedan&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;6&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@prabowo&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.166667&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.833333&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;6&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.833333&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@fadlizon&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.200000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.800000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;5&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.800000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@netizentofa&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@kemenhub151&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@ricky_hf&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@kai121&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@ankertwiter&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;@commuterline&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;147 rows \xD7 5 columns\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;FE.get_table(&apos;emojis&apos;, return_prop = True)\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;emojis&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;frekuensi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;max_prop&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE02&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.076923&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.923077&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;13&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.923077&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE2D&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.142857&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.857143&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;7&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.857143&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE4F&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.285714&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.714286&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;7&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.714286&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE22&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.166667&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.833333&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;6&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;0.833333&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE0D&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;5&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;...&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83C\uDDF2\uD83C\uDDE8&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u23EC&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE1B&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uD83D\uDE1F&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;2\u20E3&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1.000000&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;right&quot;
  }, &quot;1.000000&quot;)))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;71 rows \xD7 5 columns\n&quot;)), mdx(&quot;p&quot;, null, &quot;Karena jumlah data yang cukup kecil dan sepertinya setiap feature memiliki informasi yang cukup berpengaruh terhadap kelasnya, kami memutuskan untuk tidak menghapus satupun feature yang ada.&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;masking-feature-encode&quot;
  }, &quot;Masking Feature (Encode)&quot;), mdx(&quot;p&quot;, null, &quot;Masking feature pada text. Feauture yang sudah di &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;.fit&quot;), &quot; pada data sebelumnya, proses ini dilakukan karena pada feature ini terdapat peletakan tanda baca yang random / tidak beraturan, sedangkan pada proses berikutnya akan dilakukan penormalisasian tanda baca sehingga akan mengganggu proses tersebut. Maka dari itu perlu dilakukan masking agar proses normalisasi kalimat berjalan dengan lancar.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;# Contoh\nWebsite Google adalah http://google.com/\nTrending #MosiTidakPercaya\n@jokowi adalah presiden RI\nLucu \uD83D\uDE02\n\n# Encode\nWebsite Google adalah MASKURLS1MASK\nTrending MASKHASHTAGS1MASK\nMASKTAGS1MASK adalah presiden RI\nLucu MASKEMOJIS1MASK\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Build Mask Code\nFE.build_mask_code(0)\nFE_test.build_mask_code(0)\n# Apply to data\ntrain_text = FE.encode(train_text)    # Train\ntest_text = FE_test.encode(test_text) # Test\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;normalisasi-tanda-baca&quot;
  }, &quot;Normalisasi Tanda Baca&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan normalisasi tanda baca pada text. Karena banyak peletakan tanda baca yang salah pada text yang akan mengganggu &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;tokenizer&quot;), &quot; dalam melakukan segmentasi pada kalimat.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;# Contoh\nBudi membayar2.000 ban yang dibelinya senilai rp.2.000.000\n\n# Preprocessed\nBudi membayar 2.000 ban yang dibelinya senilai rp. 2.000.000\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Add more string punctuation\nstring.punctuation += &apos;\u2018\u2019\u2026\u201C\u201D\u2013&apos;\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def normalize(array):\n    \&quot;\&quot;\&quot;\n    Normalize text\n    \&quot;\&quot;\&quot;\n    punc, arr = string.punctuation, array.copy()\n    for i in range(len(arr)):\n        temp = list(arr[i])\n        for j in range(1, len(temp) - 1):\n            if (temp[j] in punc) and not\\\n            all([x in string.digits for x in [temp[j-1], temp[j+1]]]):\n                temp[j] = &apos; &apos; + temp[j] + &apos; &apos;\n            elif (temp[j] in string.ascii_lowercase) and (temp[j + 1] \\\n            in string.digits or temp[j + 1] in string.punctuation):\n                temp[j] += &apos; &apos;\n        arr[i] = &apos;&apos;.join(temp)\n        arr[i] = &apos; &apos;.join(arr[i].split())\n    return arr\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to text\ntrain_text = normalize(train_text) # Train\ntest_text = normalize(test_text)   # Test\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;decode--menghapus-tanda-baca&quot;
  }, &quot;Decode &amp; Menghapus Tanda Baca&quot;), mdx(&quot;p&quot;, null, &quot;Men-Decode (mengembalikan feature) serta menghapus tanda baca yang ada pada text.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;# Contoh\nWebsite Google adalah MASKURLS1MASK\n\n# Decode\nWebsite Google adalah http://google.com/\n\n# Remove Punctuation\nWebsite Google adalah httpgooglecom\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def remove_punc(arr, punc_):\n    \&quot;\&quot;\&quot;\n    Remove string punctuation\n    \&quot;\&quot;\&quot;\n    return asarray([x.translate(str.maketrans(&apos;&apos;, &apos;&apos;, punc_))\n                    for x in arr])\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to data\ntrain_text = FE.decode(train_text)    # Train\ntrain_text = remove_punc(train_text, string.punctuation)\ntest_text = FE_test.decode(test_text) # Test\ntest_text = remove_punc(test_text, string.punctuation)\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;de-emojized&quot;
  }, &quot;De-Emojized&quot;), mdx(&quot;p&quot;, null, &quot;Mengubah kode emoji yang ada pada text menjadi kata kata yang dapat dimengerti.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;\uD83D\uDE4F -&gt; folded hands\n\uD83D\uDE03 -&gt; grinning face with big eyes\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def deemojized(arr):\n    \&quot;\&quot;\&quot;\n    De Emojized text\n    \&quot;\&quot;\&quot;\n    for i in range(len(arr)):\n        arr[i] = emoji.demojize(arr[i])\n        arr[i] = re.sub(&apos;:&apos;, &apos; &apos;, arr[i])\n        arr[i] = re.sub(&apos;_&apos;, &apos; &apos;, arr[i])\n        arr[i] = &apos; &apos;.join(arr[i].split())\n    return arr\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to data\ntrain_text = deemojized(train_text) # Train\ntest_text = deemojized(test_text)   # Test\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengecek-kata-yang-misspell-typo&quot;
  }, &quot;Mengecek Kata yang Misspell (typo)&quot;), mdx(&quot;p&quot;, null, &quot;Mengecek kata-kata yang misspell atau typo serta kata - kata singkatan.&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Membangun Vocabulary&quot;, mdx(&quot;br&quot;, null), &quot;\nMembangun Vocabulary dari data untuk di cek secara &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;li&quot;
  }, &quot;Manual&quot;))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Count Vectorizer\ncount = CountVectorizer()\ncount.fit(train_text)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;CountVectorizer()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Vocabulary to DataFrame\nvocab = pd.DataFrame({&apos;Vocab&apos; : list(count.vocabulary_.keys()),\n                     &apos;Word Index&apos; : list(count.vocabulary_.values())})\nvocab = vocab.sort_values(by=[&apos;Word Index&apos;], ascending = False)\nvocab[:30].style.hide_index()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Vocab&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Word Index&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\uFF8F\uFFBB&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;20000&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u52A0\u6CB9 jiayou&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19999&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09B9\u09DF&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19998&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09B8\u09B2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19997&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09B8\u09AC&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19996&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09A8\u09AE&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19995&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09A8\u09AC&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19994&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u09A7\u09A8&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19993&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u099A\u09B2\u099B&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19992&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0995\u0996&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19991&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0993\u0986\u0987\u09B8&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19990&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0986\u09B0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19989&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0985\u09A8&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19988&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0648\u0627\u0646\u0627&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19987&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0644\u0644\u0647&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19986&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0644\u0633&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19985&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0644\u0627&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19984&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0631\u0627\u062C\u0639\u0648\u0646&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19983&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u0646\u0627&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19982&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u0644\u064A\u0647&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19981&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u0644\u0644\u0647&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19980&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u0644\u0644&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19979&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u0644\u0633&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19978&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0627\u062A&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19977&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\u0165\u03AF\u03B4\u03B1\u0138&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19976&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\xECn\xEC&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19975&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\xE1t\xE1u&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19974&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;\xE1d\xE1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19973&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;zurina&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19972&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;zumi&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;19971&quot;)))), mdx(&quot;p&quot;, null, &quot;Dapat dilihat dari tabel diatas bahwa data terdiri dari beberapa bahasa karena terdapat beberapa kata yang bukan berasal dari bahasa Indonesia seperti &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;\uFF9F\uFF8F\uFFBB&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;\u52A0\u6CB9jiayou&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;\u09B9\u09DF&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;\u09B8\u09B2&quot;), &quot;, dll.&quot;), mdx(&quot;ol&quot;, {
    &quot;start&quot;: 2
  }, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Mengeksport Vocabulary &quot;, mdx(&quot;br&quot;, null), &quot;\nMengeksport vocabulary telah dibangun kedalam file &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;.txt&quot;), &quot; untuk dapat dilakukan pengecekan secara manual terhadap kata-kata tersebut.&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;f = open(\&quot;vocab.txt\&quot;, \&quot;w\&quot;)\nf.write(\&quot; \\n\&quot;.join(sorted(vocab.Vocab.values)))\nf.close()\n&quot;)), mdx(&quot;p&quot;, null, &quot;Selanjutnya, mengimport file yang berisi kata - kata yang telah di cek secara manual lalu mengapikasikannya pada data text menggunakan kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;SpellChecker&quot;), &quot;, fitting didapat dilakukan pada file yang diinginkan atau dapat menggunakan file yang telah di benarkan oleh tim Catatan Cakrawala dengan mengisikan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;cc-hand-fixed&quot;), &quot; pada saat fitting class.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;spellchecker = SpellChecker()\nspellchecker.fit(&apos;cc-hand-fixed&apos;)\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Transform&quot;), &quot; untuk apply pada data.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to Data\ntrain_text = spellchecker.transform(train_text) # Train\ntest_text = spellchecker.transform(test_text)   # Test\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;memhapus-kata-yang-kurang-penting--stopwords&quot;
  }, &quot;Memhapus Kata yang Kurang Penting &amp; Stopwords&quot;), mdx(&quot;p&quot;, null, &quot;Menghapus kata - kata yang kurang penting seperti kata yang hanya terdiri dari 1 karakter dan Stopwords. Untuk Stopwords kami menggabungkan stopwords bahasa Indonesia dari &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Spacy&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Sastrawi&quot;), &quot; serta bahasa Inggris dari &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Spacy&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from spacy.lang.id.stop_words import STOP_WORDS as ID\nfrom spacy.lang.en.stop_words import STOP_WORDS as EN\nfrom Sastrawi.StopWordRemover.StopWordRemoverFactory import StopWordRemoverFactory\n\nstopwords = set(StopWordRemoverFactory().get_stop_words())\nstopwords.update(EN)\nstopwords.update(ID)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def RUnecesarry(array, stopwords):\n    \&quot;\&quot;\&quot;\n    Remove Unnecessary words\n    \&quot;\&quot;\&quot;\n    arr = array.copy()\n    for i in range(len(arr)):\n        temp = arr[i].split()\n        temp = [x for x in temp if not (len(x) == 1 and \\\n                (x in string.ascii_lowercase or x in string.digits))]\n        temp = [x for x in temp if x not in stopwords]\n        arr[i] = &apos; &apos;.join(temp).lower()\n    return arr\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to data\ntrain_text = RUnecesarry(train_text, stopwords) # Train\ntest_text = RUnecesarry(test_text, stopwords)   # Test\n&quot;)), mdx(&quot;p&quot;, null, &quot;Melihat hasil dari tahap preprocess data text&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;for i in [0, 803, 1002]:\n    print(f\&quot;Actual : \\n{train.text.values[i]}\\n\\nPreprocessed : \\n{train_text[i]}\&quot;)\n    print(&apos;&apos;.rjust(80, &apos;-&apos;))\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Actual :\npemakaian masker menyebabkan penyakit legionnaires a caller to a radio talk show recently shared that his wife was hospitalized n told she had covid n only a couple of days left to live . a doctor friend suggested she be tested for legionnaires disease because she wore the same mask every day all day long . turns out it was legionnaires disease from the moisture n bacteria in her mask . she was given antibiotics n within two days was better . what if these \u2018spikes\u2019 in covid are really something else due to \u2018mask induced infections\u2019 .??\uD83E\uDD14\uD83E\uDD14\uD83E\uDD14\n\nPreprocessed :\npemakaian masker menyebabkan penyakit legionnaires caller radio talk recently shared wife hospitalized told covid couple days left live doctor friend suggested tested legionnaires disease wore mask day day long turns legionnaires disease moisture bacteria mask given antibiotics days better spikes covid mask induced infections thinking face thinking face thinking face\n--------------------------------------------------------------------------------\nActual :\nkk dan nik anda bisa dipakai orang lain, waspadalah! bingung kan? speechless lah. . https://www.jpnn.com/kemenpan/news/kk-dan-nik-anda-bisa-dipakai-orang-lain-waspadalah?page=1\n\nPreprocessed :\nkk nik dipakai orang waspadalah bingung speechless httpswwwjpnncomkemenpannewskkdannikandabisadipakaioranglainwaspadalahpage1\n--------------------------------------------------------------------------------\nActual :\nini gunung dieng salatiga lihat baik2..ini bukan gn.fuji.di jepang\u2026bukan juga pegunungan alpen di eropa\u2026tapi ini gn.dieng salatiga\u2026indonesia..suhu -9\xB0c.\n\nPreprocessed :\ngunung dieng salatiga lihat gn fuji jepang pegunungan alpen eropa gn dieng salatiga indonesia suhu 9\xB0c\n--------------------------------------------------------------------------------\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;explorasi-data&quot;
  }, &quot;Explorasi Data&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan explorasi pada data untuk mendapatkan informasi - informasi lebih jauh dari data.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;train.info()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;\nRangeIndex: 4228 entries, 0 to 4227\nData columns (total 8 columns):\n #   Column            Non-Null Count  Dtype\n---  ------            --------------  -----\n 0   index             4228 non-null   int64\n 1   ID                4228 non-null   int64\n 2   label             4228 non-null   int64\n 3   tanggal           4228 non-null   object\n 4   judul             4228 non-null   object\n 5   narasi            4228 non-null   object\n 6   nama file gambar  4228 non-null   object\n 7   text              4228 non-null   object\ndtypes: int64(3), object(5)\nmemory usage: 264.4+ KB\n&quot;)), mdx(&quot;p&quot;, null, &quot;Merubah tipe pada kolom tanggal menjadi &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;datetime&quot;), &quot;. Kolom tanggal tidak dapat langsung dirubah tipe datanya menjadi &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;datetime&quot;), &quot; dikarenakan ada nya beberapa element yang mengandung kata &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Okt&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Agu&quot;), &quot; sehingga harus diubah menjadi &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Oct&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Aug&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def FixMonth(text):\n    \&quot;\&quot;\&quot;\n    Fungsi untuk merubah kata &apos;Okt&apos; menjadi &apos;Oct&apos; dan &apos;Agu&apos; menjadi &apos;Aug&apos;\n    \&quot;\&quot;\&quot;\n    if type(text) == str:\n        if &apos;Okt&apos; in text: return text[:3]+&apos;Oct&apos;+text[6:]\n        else: return text[:3]+&apos;Aug&apos;+text[6:]\n    else:\n        return text\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to data\ntrain[&apos;tanggal&apos;] = train[&apos;tanggal&apos;].apply(FixMonth)\ntrain[&apos;tanggal&apos;] = pd.to_datetime(train[&apos;tanggal&apos;])\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengecek-frekuensi-setiap-kelas&quot;
  }, &quot;Mengecek Frekuensi Setiap Kelas&quot;), mdx(&quot;p&quot;, null, &quot;Menegecek frekuensi tiap kelasnya pada data.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig_1 = go.Figure(go.Pie(labels=[&apos;Bukan Hoax&apos;, &apos;Hoax&apos;],\n                       values=train.groupby(&apos;label&apos;).size().values,\n                       textinfo=&apos;percent+label+value&apos;,\n                       textfont_color=&apos;#ffffff&apos;,\n                       marker_colors=[&apos;#0db7c5&apos;,&apos;#d03850&apos;])\n               )\nfig_1.update_layout(\n    title={\n        &apos;text&apos;: \&quot;Frekuensi Perkelasnya\&quot;,\n        &apos;y&apos;:0.93,\n        &apos;x&apos;:0.5,\n        &apos;font_size&apos;:23},\n    width=550, height=550\n)\n\nfig_1.show()\n&quot;)), mdx(PieChart, {
    mdxType: &quot;PieChart&quot;
  }), mdx(&quot;p&quot;, null, &quot;Dapat dilihat bahwa kelas 1 (&quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Hoax&quot;), &quot;) jauh lebih banyak dari kelas 0 (&quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Bukan Hoax&quot;), &quot;) atau terdapat &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;imbalance class&quot;), &quot; pada data. Untuk penanganannya kami menggunakan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Stratify&quot;), &quot; saat melakukan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Cross Validation&quot;), &quot; sehingga proporsi pada subset &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;latih&quot;), &quot; dan pada subset &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;validasi&quot;), &quot; sama.&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;melihat-sebaran-kelas-per-waktunya&quot;
  }, &quot;Melihat Sebaran Kelas per Waktunya&quot;), mdx(&quot;p&quot;, null, &quot;Melihat sebaran kelas perwaktunya.&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Membuat kolom baru untuk menyimpan tahun &amp; bulan&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Mengelompokkan berdasarkan tahun, bulan, dan labelnya&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Membuat Kolom baru untuk menyimpan nilai tahun dan bulan\ntrain[&apos;year&apos;] = [i.year for i in train.tanggal]\ntrain[&apos;month&apos;] = [i.month for i in train.tanggal]\n# Grouping\ndata_waktu = (train.groupby([&apos;year&apos;, &apos;month&apos;, &apos;label&apos;]).size().reset_index()\n              .pivot_table(columns=&apos;label&apos;, index=[&apos;year&apos;,&apos;month&apos;], values=0))\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig_2 = go.Figure(data=[\n    go.Bar(name=&apos;Bukan Hoax&apos;,\n           x=[str(i) for i in data_waktu.index],\n           y=data_waktu[0].values,\n           marker_color=&apos;#0db7c5&apos;),\n    go.Bar(name=&apos;Hoax&apos;,\n           x=[str(i) for i in data_waktu.index],\n           y=data_waktu[1].values,\n           marker_color=&apos;#d03850&apos;)\n])\n\nfig_2.update_layout(barmode=&apos;stack&apos;,\n                  xaxis=dict(dtick=1,\n                             showgrid=False,\n                             title=&apos;(Tahun, Bulan)&apos;),\n                  legend=dict(x=0.006,y=0.97,\n                              bgcolor=&apos;rgba(255,255,255,0)&apos;,\n                              bordercolor=&apos;rgba(0,0,0,0)&apos;,\n                              font_color=&apos;#090919&apos;,\n                              font_size=14),\n                  title=dict(text=&apos;Sebaran Hoax per Waktu&apos;,\n                             x=0.5,\n                             y=0.9,\n                             font_size=23),\n                  width=1000,height=550\n                 )\n\nfig_2.show()\n&quot;)), mdx(BarChart, {
    mdxType: &quot;BarChart&quot;
  }), mdx(&quot;p&quot;, null, &quot;Ditinjau dari grafik diatas bahwa:&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;53% dari keseluruhan data berasal dari tahun 2019 - 2020&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;95% data pada tahun 2019 - 2020 adalah Hoax&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengecek-kata---kata-yang-muncul-perkelasnya&quot;
  }, &quot;Mengecek Kata - Kata yang Muncul Perkelasnya&quot;), mdx(&quot;p&quot;, null, &quot;Mengecek frekuensi kata - kata yang muncul berdasarkan kelasnya.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def find_words(texts, label, builder = CountVectorizer(min_df=3, max_df=0.9,\n                                                       ngram_range=(1,2))):\n    \&quot;\&quot;\&quot;\n    Memeriksa kalimat berdasarkan kelasnya untuk membuat vocab\n    \&quot;\&quot;\&quot;\n    builder.fit(texts)\n    n_class, res = len(set(label)), {}\n    for i in tqdm(range(len(texts))):\n        for vocab in texts[i].split():\n            if vocab in builder.vocabulary_:\n                if vocab not in res:\n                    res[vocab] = [0] * n_class + [0]\n                res[vocab][label[i]] += 1\n                res[vocab][-1] += 1\n    df = pd.DataFrame({&apos;kata&apos; : list(res.keys())})\n    for i in range(n_class):\n        df[f&apos;Kelas_{i}&apos;] = [res[x][i] for x in res]\n    df[&apos;Frekuensi&apos;] = [res[x][-1] for x in res]\n    return df.sort_values(by = [&apos;Frekuensi&apos;], ascending = False).reset_index(drop=True)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Vocab DF per class\nwords = find_words(train_text, train.label.values)\nwords[&apos;Max_prop&apos;] = words[[&apos;Kelas_0&apos;, &apos;Kelas_1&apos;]].max(axis = 1) / words[&apos;Frekuensi&apos;]\nwords.head(10)\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;kata&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Kelas_0&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Kelas_1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Frekuensi&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Max_prop&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;indonesia&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;160&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;617&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;777&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.794080&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;jokowi&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;93&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;522&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;615&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.848780&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;foto&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;79&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;446&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;525&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.849524&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;orang&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;66&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;458&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;524&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.874046&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;video&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;62&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;378&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;440&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.859091&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;corona&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;15&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;402&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;417&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.964029&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;anak&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;62&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;342&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;404&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.846535&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;virus&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;21&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;378&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;399&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.947368&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;covid&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;24&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;342&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;366&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.934426&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;china&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;33&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;324&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;357&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.907563&quot;)))), mdx(&quot;p&quot;, null, &quot;Berikut adalah Barplot untuk kata - kata pada kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;1&quot;), &quot; yang mempunyai frekuensi kumunculan lebih dari kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;_1 = words[(words[&apos;Kelas_1&apos;] &gt; words[&apos;Kelas_0&apos;])]\n\nplt.figure(figsize = (12,7))\nsns.barplot(x = &apos;kata&apos;, y = &apos;Frekuensi&apos;, data = _1[:25])\nplt.title(&apos;Frekuensi Kata yang Sering Muncul Pada Label Hoax&apos;, fontsize = 14)\nplt.xticks(rotation = 90)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/96cb2de7a1c7de3184a2aa71d9760734/c54b3/output_96_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;67.72151898734178%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADAklEQVQ4y51R32tTZxj+ekpVGPsnduHV7hSUMRjbxXa9ChPBi+qaNW1Cf220DLQaexS05GrYdKY1Zkv6I+akUddf8ZwkjRQrQrWlNLVqbJesWZv0hCRqbL5zvmd8aSLtusHYAw/v+37vy8Pzvh+ZnZ09nMlkTqmqWpvNZmsTicRJWZYbw+FwQygUMvKoKEojzyORyHc88pozFoudyuVytaqqnshkMifj8fhR8swttRTi62AAdE0DYzz7b+Czuq6XyPNsNusi0R6bqfAqzvvvmK7pXJftgMdKvZuVXslDmUUukM/nb5Jor9OcuS+j/MiYrrH/AcoFcrmcgzyzD5lTv/6C7Hyg+GZzpbILV4ZeInt/hn87B2NMKzt0kOUbQ+b00CAS7o7iS7kHr/Mb0LTi/luVuVd8p94j+Mrhbdx0u5CUuosLUgum77ZgSj6HyIITz9Xn+D2X2ueoIsz099T4r5ZXHjanBl1Y91qKi6PfIzjaBI9Uh97xb9EZ7IBBvo6BhRk83Ujij1y+JPYP2HFYeOMgK/0jppS7ItjOQn4T891pYP0BM7sQ6WJGxcYapoaYYeIOa5MfsKsPl9ndRZWtrL1lmT+32dtkkW0nCxpNv4YaS5RuaOIOk15LYXG0nQb9Jir5DdQ+1US7ps9To9JHWxUvbVMmaHNgmjZOPqFX5ASVAmk6I6VobDBNU8617a2ROaz2/TZAVvqH27nDpNeCxdF2BP0m+PwG2Kea0DV9HkbFhmb5NprlcbQEImiV52ENr+NeSMWje1tY9Wwh7VqD6nmC1Z/HhsmMte/4ku269an9h0vhm0ZRunVGHHCcFq3DdWKbr/Vyna/nUv1tu1jvcYv1I37R4Al2X/TNdzul5e5xZ1R81LckRnvnLNEb96/NWQe/JoSQagBkPzdK8SdE+Yywu0cIOfD3+TKqyFdHjtVMWi7WAI8FFF1C9OGP1YBN2IBDGMeYoADC4S8+/eCjT45/CKDqy07xwGffGA+9SKMaKqqxCQEUwtWznQc///joob8AhQl8YbJ5REIAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/96cb2de7a1c7de3184a2aa71d9760734/f058b/output_96_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/96cb2de7a1c7de3184a2aa71d9760734/c26ae/output_96_0.png 158w&quot;, &quot;/static/96cb2de7a1c7de3184a2aa71d9760734/6bdcf/output_96_0.png 315w&quot;, &quot;/static/96cb2de7a1c7de3184a2aa71d9760734/f058b/output_96_0.png 630w&quot;, &quot;/static/96cb2de7a1c7de3184a2aa71d9760734/c54b3/output_96_0.png 727w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Plotting WordCloud&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from wordcloud import WordCloud, ImageColorGenerator\n\n__1 = {}\nfor i in range(len(_1)):\n    __1[_1.kata.values[i]] = _1.Max_prop.values[i]\n\nwordcloud = WordCloud(width = 4000, height = 3000, min_font_size = 5,\n                      background_color = &apos;white&apos;, colormap = &apos;inferno&apos;).fit_words(__1)\nplt.figure(figsize = (10, 8))\nplt.imshow(wordcloud)\nplt.axis(\&quot;off\&quot;)\nplt.tight_layout(pad = 0)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/1876f08eb72ea6309e3d379ab9a70269/c6d67/output_98_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;75.31645569620254%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEBklEQVQ4ywXBWXPaVgAGUP3KzvSxT50+tU91J9OmaZPMtI6TNPGkE+I4NN4AF1wwiy1ksECAJQESshBCZhGLwBAM9jheWO7N13OYsTOIZPbSNu/LmrOLrjW/PLe494J15M5YN6OuZSumFViOW6mNtNWuNq1Bp2NxrwMWHxAtet+3ru0Di1woFeLwXQwSbqYi1qzEThLvH/ighDMweQW7yxEEV4JQIgIGZQ3p7RjcS9vgIzIONjOI/hXDzuN9NKQC7vpFOJaKrplBrybzTMvon04GY/hfJRdqKEn3l320oWh0qEp0fSlIJ/UW/XJ7Tn1PQzQZytP1h356ZRn0aJOn3IZI83mNfvzgm+dEFVa9xTK3Q0cvhGX4VyIU6MPzyAtb0/FJL8L1vQfk5hK85wTRtSSGFz24ljy4qhngvRnsv2FxOerAOGZJM5tE3yxzTKOg6U+/coFfP6Z9WUJuL42954cIv4ggsy2ixJl48vU61KMCrp1TcG4e0VeH2HoUxMFWFo1KB3xAIulgARKnc4wWl/WQi0PkHUurJwqmTgvRdwl8XN7HqFGFGY7jaNUL9vkOHFHGjV1F9E0UYoDFqNeCIRSgJvJES5moimccc+ZL6BNNxWLSoROjjEYwgWZWg1EsoxpPYdFRcatmcNe1YEtlOJqJi04dXV2BrdkYVQyM9RzplUo4N7ocU/XxenVXgPinn5pbUVS2w7DZPGrBAk7dPGwuA8ufRiNn4IQ1YEh1aBkL6YiGZEBCNqog7skSMVZEp9TimGq0oFdCEjq5Cm3yRYwrLVyWZEwMBZ9yKcwdGROlhPS/ObRkDU3ZQDlfR11vQOJO0TdbGKsGua/XMb264Zi4X9I3X0QR+YenDdVGNiyjcBjH1dBGLS/hyPsfDFmF520cbVVBgRUwbA/BBwXkORlkPIAaFUncnUS70uWY1w99+srSFlZ/8dJULI/IloAH36whvV+A67Ef3tdxlFUD6y8DePnjJsriGWIbKTz7wY3fv3Xh5EDEyk9bRC/qGDYcjnn/5KPufuaB580xXVv2wuti8fbpLkJuHkO7j7U/gtjdOMDaSgC/fbeOsljHzl8xrP7sBb8noZTUsPrrDgEc0M8Djgl8CGsx7yGywdRcSYnE5wqS3b+jxMxqJBlIk7XHXnJ8kCbC4QlpaBZhfcdkYDaI91mAhFwcaao2CX5IzO5nbXyZX7PMePS5MR2fAbcCMM0BMw2YmpiNFUzHeZCrFObXJ5hfK7gbi/hynQVGeaDHYt5NYuZkQc953HbCIGNFYOh8ukGmPWmxcNKLuSPMFy3hvlcS7mq6MOuUhUm9ItxfnQqTdklwtDNhVK0Kn526cKZJgnVaFAbtqjDt8KnzWqnQa9Ze/g+nmNnkvonmxQAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/1876f08eb72ea6309e3d379ab9a70269/f058b/output_98_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/1876f08eb72ea6309e3d379ab9a70269/c26ae/output_98_0.png 158w&quot;, &quot;/static/1876f08eb72ea6309e3d379ab9a70269/6bdcf/output_98_0.png 315w&quot;, &quot;/static/1876f08eb72ea6309e3d379ab9a70269/f058b/output_98_0.png 630w&quot;, &quot;/static/1876f08eb72ea6309e3d379ab9a70269/c6d67/output_98_0.png 734w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Berikut adalah Barplot untuk kata - kata pada kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0&quot;), &quot; yang mempunyai frekuensi kumunculan lebih dari kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;1&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;_0 = words[(words[&apos;Kelas_0&apos;] &gt; words[&apos;Kelas_1&apos;])]\n\nplt.figure(figsize = (12,7))\nsns.barplot(x = &apos;kata&apos;, y = &apos;Frekuensi&apos;, data = _0[:25])\nplt.title(&apos;Frekuensi Kata yang Sering Muncul Pada Label Bukan Hoax&apos;, fontsize = 14)\nplt.xticks(rotation = 90)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/c54b3/output_100_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;70.25316455696203%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACdklEQVQ4y52SXUiTURiA36mVURcFXUR0o21aBJXRReBNJamBlYmlZRlUhE7KdhEaZjb7kZCw1CBXOMHNrakYlBBiyITCvzKiwJ/57ZvfsXC56dr8ZFvfeevsD4IM5gsP5z3n5TycnxfE6Rn4NjZx0D2/ULcoLt5xuVw1PM/XW63WCBzHNUxNTTXwPP+YzS0WSyPLOY6rt9vttaIo3nW73fc9Hs89QDfCpNb4wD87hywopRhtsD1hQHzYDLanrRU+8p3Vliilv6IFEf1hAIkE40+01f5ZBxP6KA2cka40ABt1YNPoKz2DgwHhSq8dDgCA1VZNW5XjhQ5F66egUJKYNfIuUQkZQktX5Q99Mzr7tBFhWBStFLB7GCwaw22nSYczXdU+p/AhJJFQikD/+snQI/8TQONb4J4ZbjlMehQMZd6RjhJp9F2DhIjLQildFkBjL/DPjWqnSY8zpgr82FWKvS+V2D/wCM1j7dhPBnD65xzOiYvoXFpCj8///yu76lpgskmvshtaPba2Mn64s5S86Swiuo5CUtt9gSh7bpIrvVpyo++1UGU2E7V5mGhGbKRn1EE+jy4QYcRFnAPzgmuICK6hCQIVR3LgcsbRTddzT2wvP30g8eq51MSCk/uSzl88tC33UpoiXXk8cWd+RlJCdmZyUl6efHP2Gfn6w4WKlCyVPDNNpSjYf02uTFEqinefSlbtzZKztgEct7NBBgCrvF9qAmvtr4rYEA8AcQCwjtVCxIeIRW+g7TayerhjgkJvcBJgoUkWzPtAWXNMllGeE5NeWRyzYeuWtfLU1Lg9OfmxJab3sq8U2QFgR8KuNeqz6piA54/wN/NnYSTwOgUGAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/f058b/output_100_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/c26ae/output_100_0.png 158w&quot;, &quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/6bdcf/output_100_0.png 315w&quot;, &quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/f058b/output_100_0.png 630w&quot;, &quot;/static/ecc25ab3ac5bb4601c3792db414a3d0d/c54b3/output_100_0.png 727w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Plotting WordCloud&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;__0 = {}\nfor i in range(len(_0)):\n    __0[_0.kata.values[i]] = _0.Max_prop.values[i]\n\nwordcloud = WordCloud(width = 4000, height = 3000, min_font_size = 5,\n                      background_color = &apos;white&apos;, colormap = &apos;Blues&apos;).fit_words(__0)\n\nplt.figure(figsize = (10, 8))\nplt.imshow(wordcloud)\nplt.axis(\&quot;off\&quot;)\nplt.tight_layout(pad = 0)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/9433af17f0a44aa445d6f83f2f3d798c/c6d67/output_102_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;75.31645569620254%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADqklEQVQ4yyVSa28bVRDd/44EfCpfAAkqBGpFaCFtKTRpE6dJk21q5217HcfXa3vf792775d9bw5a82GkeRzNnJkzQlG17/auNMWk5cPSz4mb1uRYssnelUbOJjZZ+gUZmQn5LAdk5uZksAiJQUsSlS2h5ZpERUu8rJm6cWWsN/xXIcwb8sP+FP2Zhx/fT/FCXEHSKA7vDPzSm+FVX8XnqYsX4hI7Zwt8vTvE+1sD7BHIqs3WqjVHs+HY8MdPArGScQe+XoSbp4cz3hvb/MPQ4r8dz/nu+Yr/cbrgpxOH735R+Ou+yv+91Pi7a53Lbs6JnfKpmXCTVmuLVjCi8kB40GPJCHJYtOJJuYYaFBhqMW5VCsXPMbeTDrjN+1kDL21gRBVGWozrVQRJjzHWKLtdRdDDsidcyb7kxBVkL+cGrWHQCmpYQt/6NdysQVi0sJIaC6+AEpbw8xY2LXE59zFSI5hhwbq4bDY9Yerm0shMcWukfOYXIF6BZVhCMhNotISddqxqLP0Cl3qMRVhC6YbGNfSkhpk1mLo5K1uGR6AnDOaB9HFsw4kr3ic+VL/Ah6EFYiXYOV3gRqHojWzcmwlmToaBHOBOpdi7s7DyMogPXmdMnLpw46on/Hwwk56dyPjpwwM/Gln4fn+Kp4cEB0MLT95K0MMC7+9MXMw8nE0cfPtqhJfiCs9PZOx8kvHVyzu87ivsm90h7nXaE568laS/vii4WYSdkvjnSkPXeEB8vDxXtmzeXul4PVDx5kLD89PlltVYj9Hhfz9b4uPEYft3Jk4mTk+4XgRSmLdgHFzxsq2ydljACnI8OBmmdgo1KjE0EhAvh2RnkIMCWlyBVmuotIKTNcxMm87vCUW7kcK8QVyseVFv0Kw5Fn6BExKgbhkUv4AW/t/wRovhJDU6EQcKxfkyQpA3uDUSpoYFgqzuCVMrlWQngx4UnBYt2s0jbvQEexMX56sIx/MAf95YWAYFvixC6EGOjyTA8TzE/r2Hv0cOzleUnS9C1O2mJ7hxOYq7h3bi9eW9zi7GCruYu+yQhGygUHZEAvZJjtjcL9nR1GMTI2Zvhg7rLyM21BN2KofseOa3/WWEes0PhKRsl90Nk2qDIK1hdfcLC0hqCJcW0LwUupducyat0G1j0ho2reElDfKaQVIjLOwEecNEgZbrZ37WXAR5exbkrZjWTIyLVhzLjmj5qTiUHfGzpIuyEYnNmm9rab0RvawVs3oj5jUT82p9mpTtddmw7/4Dlc0yhAnD38YAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/9433af17f0a44aa445d6f83f2f3d798c/f058b/output_102_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/9433af17f0a44aa445d6f83f2f3d798c/c26ae/output_102_0.png 158w&quot;, &quot;/static/9433af17f0a44aa445d6f83f2f3d798c/6bdcf/output_102_0.png 315w&quot;, &quot;/static/9433af17f0a44aa445d6f83f2f3d798c/f058b/output_102_0.png 630w&quot;, &quot;/static/9433af17f0a44aa445d6f83f2f3d798c/c6d67/output_102_0.png 734w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;pemodelan&quot;
  }, &quot;Pemodelan&quot;), mdx(&quot;p&quot;, null, &quot;Membuat model untuk memprediksi kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0&quot;), &quot; (&quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;tidak hoax&quot;), &quot;) dan kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;1&quot;), &quot; (&quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;hoax&quot;), &quot;) pada data test.&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;accelerator-detection&quot;
  }, &quot;Accelerator Detection&quot;), mdx(&quot;p&quot;, null, &quot;Menggunakan GPU atau TPU dari Kaggle sebagai Accelerator.&quot;), mdx(&quot;p&quot;, null, &quot;Note : Pastikan untuk menyalakan GPU / TPU sebagai Accelator, untuk effisiensi waktu pelatihan model.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;try:\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n    print(&apos;Running on TPU &apos;, tpu.master())\nexcept ValueError:\n    tpu = None\n\nif tpu:\n    tf.config.experimental_connect_to_cluster(tpu)\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\n    BATCH_SIZE = 16 * strategy.num_replicas_in_sync\nelse:\n    strategy = tf.distribute.get_strategy()\n    BATCH_SIZE = 32 * strategy.num_replicas_in_sync\n\nAUTO = tf.data.experimental.AUTOTUNE\nprint(\&quot;REPLICAS: \&quot;, strategy.num_replicas_in_sync)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Running on TPU  grpc://10.0.0.2:8470\nREPLICAS:  8\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;pemodelan-data-gambar-efficientnet&quot;
  }, &quot;Pemodelan Data Gambar (EfficientNet)&quot;), mdx(&quot;p&quot;, null, &quot;Model yang digunakan untuk data gambar yaitu pretrained Deep Learning model yang cukup popular yaitu &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;EfficientNet&quot;), &quot;. &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;EfficientNet&quot;), &quot; digunakan karena kemampuannya yang cukup mengesankan dalam mengklasifikasi data gambar pada &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ImageNet&quot;), &quot;.&quot;), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/8e6e4c13294e03c69bc808b9d427122c/17d12/params.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;79.74683544303798%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACRElEQVQ4y4WU627bMAxG8/5vlQHZnxZph66zc7fTzk5cX+OLbMvyGagmQ4o1KwFCMiwdfiQlTcZxpKoqmqahUYp2GGhPJ1RRoHyfneOw3m5ZLJYcjxF936FUQ9uq89iglKKua8uYyCTPcy6mfY9kPqdcr6FpKLOcosjJsoSqPqH1wDCAETew2wWsVmt836coCiYC6foeWVU+PRGt19RdxwCM5yDHY8636Q++z5749fzKqYAsHQkDxd6Prbq+763SyVsUUVQVyOj7fyGCM2Ykz0aKHHwvwHW3JEmKGTXGaJSqWW9WVplY27ZMRGpvDOnjI3VZnmEG1UCayiLQukfrjmHQtobDYJDaX5sx5h3oeR6qrjG+b0GiKsvgeGhtbbuuJQgC5vM5m40oTN71j6N1AV3mFrjxPKowhOjAqYYkHlGNsd3bbrfs93tbcJmnIvkKdplfRgs8vMXo5I3YDVntUlzHIUlibtlnoA/Arb+nCgOSRUzTdVRlabslFoYhq9WKl5cXynN9L+puAl+D3xRRwu6nx2sQ2M3iUqthGOxx0Fp/2HjdkH+AjvPMMTqR5QN1fSIMD7YZ8vNWurdKYIF9L91syTNRoW0TxL9K8SZwHAfSpMZx9njext5XSfVytq6BX7kFSn3iOMF1l9zd3dkzJ00R2P+6+plJve1drqrS0qWjruuyWCzous6+HhJQ7qoEkDLIt7xOsl7Opfy7HicSUciSpkDsi6M1y+WS2Wxmg4jyh4cH7u/v7Y2ZTqc2Ewkoe68D/QGMI9CDW07AUAAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;params&quot;,
    &quot;title&quot;: &quot;params&quot;,
    &quot;src&quot;: &quot;/static/8e6e4c13294e03c69bc808b9d427122c/f058b/params.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/8e6e4c13294e03c69bc808b9d427122c/c26ae/params.png 158w&quot;, &quot;/static/8e6e4c13294e03c69bc808b9d427122c/6bdcf/params.png 315w&quot;, &quot;/static/8e6e4c13294e03c69bc808b9d427122c/f058b/params.png 630w&quot;, &quot;/static/8e6e4c13294e03c69bc808b9d427122c/40601/params.png 945w&quot;, &quot;/static/8e6e4c13294e03c69bc808b9d427122c/78612/params.png 1260w&quot;, &quot;/static/8e6e4c13294e03c69bc808b9d427122c/17d12/params.png 1666w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Model yang akan digunakan pada notebook ini untuk data gambar adalah &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;EfficientNetB7&quot;), &quot; dengan weight &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;noise-student&quot;), &quot;.&quot;), mdx(&quot;p&quot;, null, &quot;Published Paper : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://arxiv.org/abs/1905.11946&quot;
  }, &quot;EfficientNet&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;load-image-data---tf-dataset&quot;
  }, &quot;Load Image Data - TF Dataset&quot;), mdx(&quot;p&quot;, null, &quot;Load data gambar ke bentuk Tensor lalu alokasikan ke TF Dataset untuk effisiensi memori. Data gambar yang digunakan adalah data hasil upsampling dengan menggunakan augmentasi pada kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0&quot;), &quot; sebesar &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;200%&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Train Dataset\ntrain_prep = pd.read_csv(&apos;../input/data-bdc/Preprocess and Up Sample/Up-Sample-0-by-200%/Keterangan.csv&apos;)\n# Valid Data\nvalid_prep = pd.read_csv(&apos;../input/data-bdc/Validitas/Keterangan.csv&apos;)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Spesifikasikan direktori file gambar dengan pada GCS&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Spesifikasi PATH data train pada GCS\nAUG_PATH = GCS_PATH + &apos;/Preprocess and Up Sample/&apos;\n\n# Data Up Sample 200%\nTRAIN_X_, TRAIN_y_ = shuffle([AUG_PATH + x for x in train_prep.DIR.values],\n                             train_prep.label.values, random_state = SEED)\n\n# Spesifikasi PATH data Valid pada GCS\nVAL_X = [GCS_PATH + &apos;/&apos; + x for x in valid_prep.DIR.values]\nVAL_y = valid_prep.label.values\n\n# Spesifikasi PATH data test pada GCS\nTEST_PATH = GCS_PATH + &apos;/Data BDC - Satria Data 2020/Data Uji/File Gambar Data Uji/&apos;\nTEST_X = [TEST_PATH + x for x in test[&apos;nama file gambar&apos;].values]\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Decoding image&quot;), &quot; : mengubah data gambar menjadi tensor.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def decode_image(filename, label=None, image_size=(512, 512)):\n    \&quot;\&quot;\&quot;\n    Decode Image from String Path Tensor\n    \&quot;\&quot;\&quot;\n    bits = tf.io.read_file(filename)\n    image = tf.image.decode_jpeg(bits, channels=3)\n    image = tf.cast(image, tf.float32) / 255.0\n\n    if label is None: # if test\n        shapes = tf.shape(image)\n        h, w = shapes[-3], shapes[-2]\n        dim = tf.minimum(h, w)\n        image = tf.image.resize_with_crop_or_pad(image, dim, dim)\n        image = tf.image.resize(image, image_size)\n        return image\n    else:\n        image = tf.image.resize(image, image_size)\n        return image, label\n&quot;)), mdx(&quot;p&quot;, null, &quot;Inisialisasi &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;TF Dataset&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# TF Train Dataset\ntrain_dataset = (\n    tf.data.Dataset\n    .from_tensor_slices((TRAIN_X_, TRAIN_y_))\n    .map(decode_image, num_parallel_calls=AUTO)\n    .cache()\n    .repeat()\n    .shuffle(1024)\n    .batch(BATCH_SIZE)\n    .prefetch(AUTO)\n)\n\n# TF Valid Dataset\nvalid_dataset = (\n    tf.data.Dataset\n    .from_tensor_slices((VAL_X, VAL_y))\n    .map(decode_image, num_parallel_calls=AUTO)\n    .batch(BATCH_SIZE)\n    .cache()\n    .prefetch(AUTO)\n)\n\n# TF Test Dataset\ntest_dataset = (\n    tf.data.Dataset\n    .from_tensor_slices((TEST_X))\n    .map(decode_image, num_parallel_calls=AUTO)\n    .batch(BATCH_SIZE)\n)\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;membuat-model&quot;
  }, &quot;Membuat Model&quot;), mdx(&quot;p&quot;, null, &quot;Membuat model yang akan digunakan. Berikut adalah arsitektur model yang akan digunakan.&quot;), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/2a3851e6da1c28a039a2f955d591a62f/6af66/model_1.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;98.10126582278481%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJElEQVQ4y42UC5OqMAyF+f9/TscRdRQf+EBABRWLItjufJnJXnCve29nYpLanuakh3rOOXe73VwURe5wOLg0Td3pdBKvORaGoZvP5269XkuMLZdLMfYzrLXOU8DNZuN2u50AH49Hyff7vdtut+IBGwwG4lerlQAFQSBWFEUXsK5rV1WV+Ofz2YnxVPx4PFxZlu5+v0usRt40zR9Afhj8YYyRTXg18slkIlVfr1d3Pp9dnudil8tFDlcwhlT4er1clmVClx7hkyQR2nEcC8Veryf5YrEQ2tPp1Pm+L8AK+E2ZoH06J5NrzAH0jMvhAA6jr8zB4keFmnwagPw22vs9pEElUMboFXNqXAgS0eq0Wm5fW0QrZrOZVO2RsBHJMMECPLR0Eznr+I+5fr8vABTCYciJNRzoteXwLgk1Klc5sZb+0ltVBDGetd57P9AUCxUM0SMbNiFgLg7AT8PT69bGAgI9qEIHKsPh0I1GI2kL8Xg8Fqm15dKRTfumoAZFpcUloUPAiVU2bcBOhe+ALARUPzs8VTJPTkswXf9PQHqGVOgVlVIlFPk6qE5fm/YL8ysgQGyCFn0EhN4hDXoLfT4/1v0XIBS5GCSihqgB0McCg/5fAW1r8H9d17aqqo4FQSC+LEtrjLFFUXyvfx8/KuR2oUj/uAxiPjXkAmViXhqYfKLMc2GsteIZaZqaPM9NlmUmSRIThqHxfd9EUWTiOBbfNE1nn9oXqdb9GF7lj6MAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;model&quot;,
    &quot;title&quot;: &quot;model&quot;,
    &quot;src&quot;: &quot;/static/2a3851e6da1c28a039a2f955d591a62f/f058b/model_1.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/2a3851e6da1c28a039a2f955d591a62f/c26ae/model_1.png 158w&quot;, &quot;/static/2a3851e6da1c28a039a2f955d591a62f/6bdcf/model_1.png 315w&quot;, &quot;/static/2a3851e6da1c28a039a2f955d591a62f/f058b/model_1.png 630w&quot;, &quot;/static/2a3851e6da1c28a039a2f955d591a62f/6af66/model_1.png 640w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Load EfficientNet&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Tensorflow - Keras Layers\nimport tensorflow.keras.backend as K\nimport tensorflow.keras.layers as L\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.callbacks import ModelCheckpoint\n\n# EfficientNet\nimport efficientnet.tfkeras as efn\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def Make_EfficientNet_model():\n    \&quot;\&quot;\&quot;\n    https://www.kaggle.com/xhlulu/flowers-tpu-concise-efficientnet-b7\n    \&quot;\&quot;\&quot;\n    model = tf.keras.Sequential([\n        efn.EfficientNetB7(            # EfficientnetB7\n            input_shape=(512, 512, 3),\n            weights=&apos;noisy-student&apos;,\n            include_top=False\n        ),\n        L.GlobalAveragePooling2D(),\n        L.Dense(512, activation= &apos;relu&apos;),\n        L.Dropout(0.2),\n        L.Dense(1, activation=&apos;sigmoid&apos;)\n    ])\n    model.compile(optimizer=&apos;adam&apos;, loss = &apos;binary_crossentropy&apos;, metrics=[&apos;accuracy&apos;])\n    return model\n&quot;)), mdx(&quot;p&quot;, null, &quot;Build &amp; Scope model ke &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;TPU&quot;), &quot; &amp; Compile model.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;with strategy.scope():\n    model = Make_EfficientNet_model()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Downloading data from https://github.com/qubvel/efficientnet/releases/download/v0.0.1/efficientnet-b7_noisy-student_notop.h5\n258072576/258068648 [==============================] - 4s 0us/step\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;training-model&quot;
  }, &quot;Training Model&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan pelatihan terhadap model dari data train. Pelatihan dilakukan dengan ketentuan:&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;EPOCHS = 10\nSTEPS_PER_EPOCHS = len(TRAIN_X_) // BATCH_SIZE:128 (Jika menggunakan TPU)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Pelatihan dilakukan dengan memperhatikan nilai dari &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;val_accuracy&quot;), &quot;, &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;epoch&quot;), &quot; yang memiliki nilai &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;val_accuracy&quot;), &quot; terbaik akan disave &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;weights&quot;), &quot; - nya dan akan di load pada saat melakukan evaluasi dan prediksi nantinya.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Config\nEPOCHS = 10\nSTEPS_PER_EPOCH = len(TRAIN_X_) // BATCH_SIZE\ncheckpoint = ModelCheckpoint(&apos;EfficientNetB7_best_model.h5&apos;, monitor=&apos;val_accuracy&apos;,\n                             save_best_only=True, save_weights_only=True, mode=&apos;max&apos;)\n\n# Fitting Model\nprint(f&apos;[INFO] Fitting Model&apos;)\nhistory = model.fit(train_dataset, epochs = EPOCHS,\n                    steps_per_epoch = STEPS_PER_EPOCH,\n                    validation_data = valid_dataset,\n                    callbacks = [checkpoint])\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;[INFO] Fitting Model\nEpoch 1/10\n38/38 [==============================] - 164s 4s/step - loss: 0.4728 - accuracy: 0.7858 - val_loss: 1.0803 - val_accuracy: 0.7417\nEpoch 2/10\n38/38 [==============================] - 40s 1s/step - loss: 0.3696 - accuracy: 0.8329 - val_loss: 0.8951 - val_accuracy: 0.8142\nEpoch 3/10\n38/38 [==============================] - 35s 914ms/step - loss: 0.3544 - accuracy: 0.8454 - val_loss: 0.9107 - val_accuracy: 0.8063\nEpoch 4/10\n38/38 [==============================] - 40s 1s/step - loss: 0.3058 - accuracy: 0.8647 - val_loss: 0.6083 - val_accuracy: 0.8236\nEpoch 5/10\n38/38 [==============================] - 35s 915ms/step - loss: 0.3186 - accuracy: 0.8625 - val_loss: 0.5071 - val_accuracy: 0.8047\nEpoch 6/10\n38/38 [==============================] - 35s 916ms/step - loss: 0.2928 - accuracy: 0.8736 - val_loss: 0.5885 - val_accuracy: 0.8189\nEpoch 7/10\n38/38 [==============================] - 35s 915ms/step - loss: 0.2837 - accuracy: 0.8734 - val_loss: 1.2540 - val_accuracy: 0.6409\nEpoch 8/10\n38/38 [==============================] - 35s 915ms/step - loss: 0.2478 - accuracy: 0.8925 - val_loss: 0.7599 - val_accuracy: 0.8142\nEpoch 9/10\n38/38 [==============================] - 35s 915ms/step - loss: 0.2325 - accuracy: 0.9025 - val_loss: 0.6619 - val_accuracy: 0.7496\nEpoch 10/10\n38/38 [==============================] - 35s 914ms/step - loss: 0.2350 - accuracy: 0.8966 - val_loss: 0.6473 - val_accuracy: 0.7811\n&quot;)), mdx(&quot;p&quot;, null, &quot;Meninjau &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;train history&quot;), &quot; pada model&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig, (ax1, ax2) = plt.subplots(2, 1, figsize = (12, 10))\nax1.plot(range(1, EPOCHS + 1), history.history[&apos;loss&apos;], label = &apos;loss&apos;)\nax1.plot(range(1, EPOCHS + 1), history.history[&apos;val_loss&apos;], label = &apos;val_loss&apos;)\nax1.set_title(&apos;Loss at Training&apos;, fontsize = 14)\nax1.legend()\nax2.plot(range(1, EPOCHS + 1), history.history[&apos;accuracy&apos;], label = &apos;accuracy&apos;)\nax2.plot(range(1, EPOCHS + 1), history.history[&apos;val_accuracy&apos;], label = &apos;val_accuracy&apos;)\nax2.set_title(&apos;Accuracy at Training&apos;, fontsize = 14)\nax2.legend()\nfig.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/86b46e6f767204d7be23816991d06fbb/6bbf7/output_123_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;82.91139240506328%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAADFUlEQVQ4y4VUzVIkRRBuL170HTwoYISvYAQgL7AH2NC7B8MX4hnkxGE3NJbDDD3AsoNeZNAwQBgChmG6e7r6t7qyMivTqG5wYDW0Ir7IrKysqqzMLyt4/erVx3GcvFBZ9jJN002VplseaZpuZVm2eXd39/VwOPw2DMPver3e97e3t9/kabyZKtX6KKW2klRt3k6jl3EUvQjeDU+WwDSGnRPHIo65g58/gJnlcTi04oqZOEJxrvMjQsnUXGZRBMHxyc+fIZhUoBBBQ0LWiUPn9z4FM7f3CVRO0DgxxWKdmURYAEAF/X5v2SJm/naG2jHUzKZghsrH1YG5kw67Na/b+pmP349EeRAOBsuItjtQ2le3q2xrYVOKT8XftiYXJtvpzMJWi5hC/CUCpSCYPHh7dLQEYOdAba5QpA2fRISEgARKEig6iU1nfwJmJh+6jxPRpsG74+MVAOsaS1IZbFEaFA0oQCyAToxFMZbauUESaPG8WO2TkVywu7v7SVVVP6KFw1rrgdZ6YIwJK92EscoPVFmHhYZeXjd9Vdb7WdXsp0UVzvNqMJ1nhzNVhpEqw/u0OEpV9iYQkf9FEAQfPMgPvaT/8t3Z2fk0iqK3V1dXvydxfOqIRoQ4staOEOnXsiz/SJJkrLLsz2kUj2eJuii0Oc3rZqTK5nRe6NG80Kfzsvmt0vo4ODw4WLFGg7Ug2oA0yGJIRPucNla0deJLoZHFOmnh8+fh5PkgIgx2dn74wiLN/SFVWSDokowuiZqSxBQkpqSOnxU9kPmhwkwCVVdlEWyLYq0KfjkZLjUGMlNlIlb7LhEhaP07vjlhNMKOPPE7veWpFm4yEc9V27BA1fHw9U9vPkejlTh4JPY/O+QRjhad0uQLG9ROHAkiZsF+v7+MiKpNgg9HFo3xHNxJq1l8Z2Dzvo8/MA/29vZWAKDg936Yf4X3ISuujBbzJz+StbYMtre3P5pMJl8mSbI2Ho+/urm5WY+iaDWO49XLy8uNyWSy7vXZbLZ6cXGxcT+drkWz+9XpdLp2fn6+4e1+/fr6euPs7Gz9L6X62K2rH47sAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/86b46e6f767204d7be23816991d06fbb/f058b/output_123_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/86b46e6f767204d7be23816991d06fbb/c26ae/output_123_0.png 158w&quot;, &quot;/static/86b46e6f767204d7be23816991d06fbb/6bdcf/output_123_0.png 315w&quot;, &quot;/static/86b46e6f767204d7be23816991d06fbb/f058b/output_123_0.png 630w&quot;, &quot;/static/86b46e6f767204d7be23816991d06fbb/6bbf7/output_123_0.png 716w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;load-weights-model&quot;
  }, &quot;Load weights model&quot;), mdx(&quot;p&quot;, null, &quot;Load &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;weights&quot;), &quot; terbaik yang telah disimpan.&quot;), mdx(&quot;h4&quot;, {
    &quot;id&quot;: &quot;note-&quot;
  }, &quot;Note :&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Untuk mendapatkan hasil yang sama dengan yang di submit pada website &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;BDC - Satria Data&quot;), &quot; bisa menggunakan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;weights&quot;), &quot; yang telah kami simpan &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/pencarikebahagiaan/modelku&quot;
  }, &quot;disini&quot;), &quot;.&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;Untuk melihat proses training menggunakan data dengan kriteria Up-Sampling lainnya untuk perbandingan silahkan kunjugi notebook pada responsitory kami &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://github.com/Hyuto/BDC-Satria-Data/tree/master/Notebooks&quot;
  }, &quot;di sini&quot;))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# model.load_weights(&apos;EfficientNetB7_best_model.h5&apos;)\nmodel.load_weights(&apos;../input/modelku/Image Model/200%_best_model.h5&apos;) # Jika menggunakan Model kami\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;memprediksi-dan-mengevaluasi-data&quot;
  }, &quot;Memprediksi dan Mengevaluasi Data&quot;), mdx(&quot;p&quot;, null, &quot;Memprediksi data train dan data valid lalu dilakukan pengevaluasian untuk melihat kebaikan model.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Valid\nval_pred = model.predict(np.concatenate([x for x, y in valid_dataset], axis=0))\nval_pred_classes = np.array(val_pred.flatten() &gt;= .5, dtype = &apos;int&apos;)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Mengevaluasi model dengan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Accuracy Score&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;F1 Score&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;print(f&apos;Accuracy Valid Data : {accuracy_score(VAL_y, val_pred_classes)}&apos;)\nprint(f&apos;F1 Score Valid Data : {f1_score(VAL_y, val_pred_classes)}&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Accuracy Valid Data : 0.8299212598425196\nF1 Score Valid Data : 0.9040852575488455\n&quot;)), mdx(&quot;p&quot;, null, &quot;Confussion Matrix&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;plt.figure(figsize = (7, 7))\nsns.heatmap(confusion_matrix(VAL_y, val_pred_classes, normalize = &apos;true&apos;),\n            annot=True, cmap=plt.cm.Blues)\nplt.title(&apos;Normalized Confussion Matrix Valid Data&apos;)\nplt.xlabel(&apos;Predicted&apos;)\nplt.ylabel(&apos;Actual&apos;)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;426px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/69dc3cbfb884ef33415b42e135fcf954/531e1/output_131_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;104.43037974683544%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAAEl0lEQVQ4y22TfWwTdRjHnw22u951EF5lokFDFDSOra1usqF/KDGBJQNcu46oQcwGspZhJyu76eyCJINoYkwwgS3tWJCIJvIq/ocEjCHEiBHJeluBIYy1ZWPFtb1r7+0xv197ywj+8clzd7n75Ps8z+/g5ngGrkaiRTEZn/x03xe2D1vbq5s8vjU7d3dW7fJ3VTV722pKVzdWFTy3rqa4rP6VopW11SbchoPP8FtOWJmVW+awZdtLmJeaASJxCYZj6VWRuPRgKJqaFMeSCZPhWGpycHQqYf/oRKKwrjdhdYUSnDOY4JyhSc4ZnOCcIeQ3H/MxDt8etsrfyla2Twvtw7E0RuLSNMMxCW/EJRSjaXT4TmHhhj4saTiCvKvfxKBC98AnzNoDe5m3vuxg3uwBGBpLEqktEpeM4VjaiMQlnTAcS9MqRlO6w3dSL6zr00sa+nXOGaLwrn6FCDlXSOCd/QGuPrjH+v45gH8e6iDem5pOSKTiWBLNezGaQofvJBbW9aG1oZ+mJJVzhlSS1PJ2UHii+cfPFr4TDNxEBEBEuPiH+CpJaAp/F0eRSG/cf1RIBE9tPYaL3j2KlvqckNnYJyz/+OfuZ33n/Mt2HAe4PanSGeZlOEP8WMKSXDIK7+qnwqK6XsGx70J3eeC8v6zjFAA5NvkZmgsxIvH0/wh7aas8keWkVDir9pCw9psrgZr95zs/uIUAl6/fnt5yHrIcHKLXEobHUuhoO42FG4NY4h5Anmw6h8q7BxBqDwuN314LrP/6QpdMZggA7MhExnZrXMY8Bq33JRwZl5GkdbT+gAXrDqJ102HkNh4yUflNhxHe+ErwnBa7t373d/vmQ79QoSWjoy2dNTCtUAxSU1kDJQVxStawsvEAwgvbkXO0ImvbaaJaHK0IT78n7L10t7v9TNi/6/gVgERSBkkx7LKKmMcgVVIMzKiIqYyOle4ehBVNyNk8yJa3UJjyFtVi8yCUNgrBa+OBz89e7SInBlIZDTIa2oiAMFNIanJa2Iyc3UtEFLbCo1rsXoQljcJPNx8Gei+KnWiew6Ss2E2BpBhGKqPR9h8VkoReKrXYqFgl17DYLVwelbrP/BX1f/+bmBOO3B2rMoVTkmKMxiZIxYxGhNq0kLS45PV2XLC6DYtX7cgJFzUIQw+07kvihP9XcRxIuyCraJvRpjGj/ccSzmyZChc2CHEZAxf+HAnQliXFIJAZ6rKKuqQYmomsopbM6Fqlu0eDFU0aZ/NqbIWHwpS3ZKlwgatjSsfA9TsP90hEKKtIhA5zyzNmmU+oPZKQrfBQSEoqnO/qMhD33X0gd94ZTwHIChJelFUMS4oRllUcTGd1MZ01whkNw+msMVjp3j8IK5rDnM0bZspbRKa8JcxWeK5zdm8U5jm3IaJ3YirblMwapGWSEAskxWCzOrL/pjLsbn/HvNujMfbWnXuW4JGj1udf28LDsk2ctTpQPHvpmjlFyzdw7MvtDG/3sDC3fhYizlZ1nJWfIYKk0sXQM0keEk6dPUf+ogIAWAwApeSPKlpaA/NbJbBU7wWmbBvw9p0Ac+vp+7qe++4/XYIdvJr+obYAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/69dc3cbfb884ef33415b42e135fcf954/531e1/output_131_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/69dc3cbfb884ef33415b42e135fcf954/c26ae/output_131_0.png 158w&quot;, &quot;/static/69dc3cbfb884ef33415b42e135fcf954/6bdcf/output_131_0.png 315w&quot;, &quot;/static/69dc3cbfb884ef33415b42e135fcf954/531e1/output_131_0.png 426w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 426px) 100vw, 426px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;memprediksi-data-test&quot;
  }, &quot;Memprediksi Data Test&quot;), mdx(&quot;p&quot;, null, &quot;Menggunakan model untuk memprediksi &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;test dataset&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;EfficientNet_pred = model.predict(test_dataset)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Clear session &amp; free up memory.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;K.clear_session()\ntf.tpu.experimental.initialize_tpu_system(tpu)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;&lt;tensorflow.python.tpu.topology.Topology at 0x7ff9cb254190&gt;\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;pemodelan-data-teks-bert&quot;
  }, &quot;Pemodelan Data Teks (BERT)&quot;), mdx(&quot;p&quot;, null, &quot;BERT(Bidirectional Encoder Representations from Transformers) adalah pretrained model karya Jacob Devlin, Ming-Wei Chang, Kenton Lee dan Kristina Toutanova. Model ini berupa transformator dua arah yang telah dilatih sebelumnya.&quot;), mdx(&quot;p&quot;, null, &quot;Published Paper : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://arxiv.org/abs/1810.04805&quot;
  }, &quot;BERT&quot;)), mdx(&quot;p&quot;, null, &quot;Bert yang digunakan pada notebook ini adalah &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;bert-base-indonesian&quot;), &quot; buatan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Cahya Wirawan&quot;), &quot; yang berupa pre-trained BERT-base model pada 522MB data wikipedia indonesia dengan vocabulary sebesar 32.000. Keterangan lebih lanjut bisa dibaca &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://huggingface.co/cahya/bert-base-indonesian-522M&quot;
  }, &quot;di sini&quot;)), mdx(&quot;p&quot;, null, &quot;Load Transformers terlebih dahulu&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from transformers import *\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;load-bert-tokenizer&quot;
  }, &quot;Load Bert Tokenizer&quot;), mdx(&quot;p&quot;, null, &quot;Load Bert Tokenizer dari library &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;transformers&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;model_name=&apos;cahya/bert-base-indonesian-522M&apos;\ntokenizer = BertTokenizer.from_pretrained(model_name)\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;encode-teks&quot;
  }, &quot;Encode Teks&quot;), mdx(&quot;p&quot;, null, &quot;Data teks akan di encode menjadi 3 tipe untuk input kedalam model.&quot;), mdx(&quot;ul&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;input ids adalah ID / nomor yang merepresentasikan kata&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;attention mask adalah keterangan dari ID yang harus diperhatikan ditandakan oleh nomor 1.&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ul&quot;
  }, &quot;token type id adalah ID yang berhubungan dengan multiple sequance.&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;index = random.randint(0, len(train_text))\nencode = tokenizer.encode_plus(train_text[index], return_attention_mask = True,\n                               return_token_type_ids=True)\nprint(&apos;Actual : &apos;)\nprint(train_text[index])\nprint(&apos;&apos;.rjust(80, &apos;-&apos;))\nprint(&apos;Token IDS : &apos;)\nprint(encode[\&quot;input_ids\&quot;])\nprint(&apos;&apos;.rjust(80, &apos;-&apos;))\nprint(&apos;Attention Mask : &apos;)\nprint(encode[&apos;attention_mask&apos;])\nprint(&apos;&apos;.rjust(80, &apos;-&apos;))\nprint(&apos;Token Type IDS : &apos;)\nprint(encode[&apos;token_type_ids&apos;])\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Actual :\njokowi ahok bagikan amplop berisi uang beras warga cilincing jokowi ikutan sembako amplop ahok cilincing\n--------------------------------------------------------------------------------\nToken IDS :\n[3, 15071, 29708, 28939, 2688, 9155, 3709, 3714, 2111, 3167, 23190, 1010, 5398, 15071, 3821, 1487, 4461, 9745, 2688, 9155, 29708, 23190, 1010, 5398, 1]\n--------------------------------------------------------------------------------\nAttention Mask :\n[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n--------------------------------------------------------------------------------\nToken Type IDS :\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;mengecek-sequence-terpanjang&quot;
  }, &quot;Mengecek Sequence Terpanjang&quot;), mdx(&quot;p&quot;, null, &quot;Karena panjang dari data teks tidak sama. Maka perlu di lakukan padding untuk menyamakan panjang dari sequance.&quot;), mdx(&quot;p&quot;, null, &quot;Contoh:&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;jokowi ahok bagikan =&gt; Encode IDS =&gt; [3, 15071, 29708] =&gt; Padding to 5 =&gt; [3, 15071, 29708, 0, 0]\n&quot;)), mdx(&quot;p&quot;, null, &quot;Untuk melakukan padding perlu dicari sequence terpanjang pada data sebagai acuannya.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;plt.figure(figsize=(7,7))\nsns.distplot([len(tokenizer.encode(x)) for x in train_text], label = &apos;train&apos;)\nplt.title(&apos;Distplot of Text Lenght&apos;, fontsize=14)\nplt.legend()\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;444px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/d4694f2bf4b44d4fbbb1e8ec937fba61/9b7bd/output_144_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;97.46835443037975%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAC10lEQVQ4y52Uy08TQRzHfwvVKI9a41Gi5eFBEj2oidF40KN/g3cTTiYae/AgFwwXAmkMAR+xyEsUDBiVmxpaaItAeRWkLe1uH9a2UNjuzmx363bHTCmkYETKL9nMznd/+cz3N7+ZBb1eDzQWFxerVv3+uiAbqPGv+mpjsVi12Wy+0tDQcNtkMt1samq6bjKZbjU2Nt6gWktLy1We540ez0ptiPXXRCLhWrfbfSYHI4RAMpl0ZhSFiFhCCKclRZYlWZaldD4K3yWJfpJzGpbSUjDB43AkkuE41gMMw5wAAANCaI4QQmIpWeOlDCkmNG1rFAQhBAaDgaEuBVGcoaIruKG6IzxN0bJZ7aCRzQM50Ol0OgDQpQTRRUWbN6FaPYncimpW28eVtjNq+UkOyDBMJQDoRRHlgGOehDq6EC1MPkDJBUAag28HYBto9SbUYVeEZAscFAVkGKYCACoR2gJ+mo+qvQ6OKL+zhwOWlpYeAYCjCKFZKo64IqplnCVCOnPgsv8qmZ5DnHc4MhtRuyZYEkiIueTsIUo20HNIgbSp76fD6vMxP3H613eARTscGRrIOaTq4HRYfWULkC8/4ocruaSkpAwAyjFGroyqkXdTIfW1naPgXY3ZD7oXeAwAjssSdm3iDOl1cGqfM0joPsZS6eKB201R0pIrIcikx8Gp/XngcjS1qzH/Au9tykkAOKWkpZl4SiY9dpY61LrtrDY0HdYyW/fvf/c6u8uhuDwGqpKeiwkK6bZzpH8yRN58DxHLBEuWosKB/zpIFEMADEP3sEzgNx1T/rj27OuK2G3z4S6rD3fZfNhi9eJvSz8xF+fRrw0BJ1MIr6cQ3hQxErGE84+IJFlZW1tboQbLAaDCOm6vetLZV28enjA+/ThpvNfcWf+w1XLe/MFpvNs+Wn3tzoPLjzqGzg1aF4xt/Z/r7j9uvmSdWqie9wbPtra/uNDW8fJigOVO/wHNY/So0fNq5QAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/d4694f2bf4b44d4fbbb1e8ec937fba61/9b7bd/output_144_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/d4694f2bf4b44d4fbbb1e8ec937fba61/c26ae/output_144_0.png 158w&quot;, &quot;/static/d4694f2bf4b44d4fbbb1e8ec937fba61/6bdcf/output_144_0.png 315w&quot;, &quot;/static/d4694f2bf4b44d4fbbb1e8ec937fba61/9b7bd/output_144_0.png 444w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 444px) 100vw, 444px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Dari grafik diatas didapatkan kesimpulan bahwa panjang sequence data tersebar pada rentang 0 - 220 yang memusat pada rentang 0 - 100. Maka dari itu akan digunakan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;250&quot;), &quot; sebagai acuan maximum dari panjang sequencenya&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;max_len = 250\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def regular_encode(texts, tokenizer = tokenizer, maxlen=max_len):\n    \&quot;\&quot;\&quot;\n    Encoding data teks\n    \&quot;\&quot;\&quot;\n    enc_di = tokenizer.batch_encode_plus(\n        texts,\n        return_attention_masks=True,\n        return_token_type_ids=True,\n        pad_to_max_length=True,\n        max_length=maxlen\n    )\n\n    return {x : np.asarray(enc_di[x]) for x in enc_di}\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;membuat-model-1&quot;
  }, &quot;Membuat Model&quot;), mdx(&quot;p&quot;, null, &quot;Membuat model yang digunakan untuk memprediksi data teks, berikut adalah arsitekturnya&quot;), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/0a9abd1578520a97bf552ec8263923f6/0d40b/model_2.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;43.67088607594937%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6ElEQVQoz4XR64qFIBQF4N7/CStJMaMsL3nXimqgzcAcOGfO91P2Yqm7EkJIKSmlCKG6rjnn8iGEmKaprmuM8TAMSimYHMcRIdR1XdM0VXx4751z67paa40xcCKltNbqx7qu3vsYYwjB/6ruP5xz0Mk5n+cZY8wYa9uWEDKO43me96uXcCkl51xKSSl577XWOecQAhT+Fz6OwxijHsYYKeXyIIQwxrqu27btY/i6LuhMKZVSYoxKKehMKeWcv1wbaK2VUrACSiljbN/3+503YXg5/Dbs4rqu72EYCiHAg9u27ft+WZb7gx/8+QRq/deDOQAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;model2&quot;,
    &quot;title&quot;: &quot;model2&quot;,
    &quot;src&quot;: &quot;/static/0a9abd1578520a97bf552ec8263923f6/f058b/model_2.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/0a9abd1578520a97bf552ec8263923f6/c26ae/model_2.png 158w&quot;, &quot;/static/0a9abd1578520a97bf552ec8263923f6/6bdcf/model_2.png 315w&quot;, &quot;/static/0a9abd1578520a97bf552ec8263923f6/f058b/model_2.png 630w&quot;, &quot;/static/0a9abd1578520a97bf552ec8263923f6/40601/model_2.png 945w&quot;, &quot;/static/0a9abd1578520a97bf552ec8263923f6/0d40b/model_2.png 1175w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def build_model(transformer, loss=&apos;binary_crossentropy&apos;, max_len=max_len):\n    input_ids = tf.keras.Input(shape=(max_len,), dtype=tf.int32, name=\&quot;input_ids\&quot;)\n    attention_mask = tf.keras.Input(shape=(max_len,), dtype=tf.int32, name=&apos;attention_mask&apos;)\n    token_type_ids = tf.keras.Input(shape=(max_len,), dtype=tf.int32, name=&apos;token_type_ids&apos;)\n\n    sequence_output, pooled_output = transformer([input_ids, attention_mask, token_type_ids])\n    cls_token = sequence_output[:, 0, :]\n    x = L.Dropout(0.3)(cls_token)\n    out = L.Dense(1, activation=&apos;sigmoid&apos;)(x)\n\n    model = tf.keras.Model(inputs=[input_ids, attention_mask, token_type_ids], outputs=out)\n    model.compile(Adam(lr=3e-5), loss=loss, metrics=[&apos;accuracy&apos;])\n\n    return model\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;cross-validation&quot;
  }, &quot;Cross Validation&quot;), mdx(&quot;p&quot;, null, &quot;Metode yang digunakan untuk CV adalah &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;StratifiedKflod&quot;), &quot;. Metode ini digunakan untuk mengatasi kelas pada data yang imbalance. &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;StratifiedKfold&quot;), &quot; ini tidak jauh berbeda dengan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Kfold&quot;), &quot; hanya pada saat pembagian menjadi data train dan data valid, proporsi masing masing kelas tetap sama pada kedua data tersebut.&quot;), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/8b70b/StratifiedKfold.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;39.24050632911392%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVQoz0XOS0tUYQCA4flP/YmW0bpVbbMWSoJdsDZdRbBVkBUuMiGQICpMUdQa5+aQHmec41ycZjxzrt+5fucyo76BBW3fxcuT82RCWZfk9RgjiOAM+v0NDravcq5/phHAfBP06Jy2G7HYDND9GM2P+dAKaQuJI1PeNwMObUlOyIQ5NWapf0rPk3AOhU6RV9/uMdRWqRoaT77OEBtlflgwXvDQnIiaEzNREtROBL0w41beptIT5II45Xop5E1nyMBP4Czj+0nC5E7AwAO1u8rrpcvQecmWBVObexiWxYGTMJE3qfdtfocZY1s6u137/3D+eMTAj+E0Y0OTPKrYWG5IxZJMFmwMf0iju87y8iVoz7Dnwf1dh5ou6Ycpd4omu/1/whvlkLfN+K/wNGNNkzzY0XGET8HOGN/WsN2Ikq4zvVnAMTq0zCMWPl1BKo/pxHBzJ6Xcy8j5MuFaIeDjaoWBCOFsyNpJxN2SjemGFK2E2z9NTDcgb2aMFwN6YkTTOOb5+jv67RUGnsHslym69QVy8XDE9IFkY6uKiNKLYd5MmPtl43kBe+6QZxUL3w+pOikvqtaF/Mgf8XQ/48gCzztkcWWMWHlIrtVqoTYaHDYaqKpKmqbYjkNdUZBhiHBd6so+ruPgCHHRPSHwAx+1pmAbAyIpUWotNM3mD3/7N5AuVhFlAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;SKfold&quot;,
    &quot;title&quot;: &quot;SKfold&quot;,
    &quot;src&quot;: &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/f058b/StratifiedKfold.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/4fe824f6dc276bb0d79b4250ef77d902/c26ae/StratifiedKfold.png 158w&quot;, &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/6bdcf/StratifiedKfold.png 315w&quot;, &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/f058b/StratifiedKfold.png 630w&quot;, &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/40601/StratifiedKfold.png 945w&quot;, &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/78612/StratifiedKfold.png 1260w&quot;, &quot;/static/4fe824f6dc276bb0d79b4250ef77d902/8b70b/StratifiedKfold.png 1266w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;n_split&quot;), &quot; yang digunakan sebesar 10. Dataset Folding kami bisa di daoat dengan menggunakan:&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;cv = StratifiedKFold(n_splits=10)\nfor fold, (train_ind, val_ind) in enumerate(cv.split(train_text, train.label.values)):\n    x_train, y_train = train_text[train_ind], train.label.values[train_ind]\n    x_val, y_val = train_text[val_ind], train.label.values[val_ind]\n&quot;)), mdx(&quot;p&quot;, null, &quot;load &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;folding.csv&quot;), &quot; dari responsitory kami.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Load Folding Dataset from responsitory\nfolding = pd.read_csv(&apos;https://raw.githubusercontent.com/Hyuto/BDC-Satria-Data/master/Folding.csv&apos;)\nfolding.head()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;ID&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 1&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 2&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 3&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 4&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 5&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 6&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 7&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 8&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 9&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Fold 10&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;71&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;461&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;495&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;550&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;681&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)))), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;train--evaluate-model&quot;
  }, &quot;Train &amp; Evaluate Model&quot;), mdx(&quot;p&quot;, null, &quot;Melakukan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;training&quot;), &quot; pada train data. Train dilakukan pada &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fold 3&quot;), &quot; &amp; &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fold 6&quot;), &quot; karena kedua fold tersebut memberikan nilai akurasi yang cukup baik dari model pada &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fold&quot;), &quot; lainnya. Training memiliki konfihurasi sebagai berikut:&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;epochs = 15\nsteps_per_epoch = len(x_train)//BATCH_SIZE:128 (jika menggunakann TPU)\n&quot;)), mdx(&quot;p&quot;, null, &quot;Training dilakukan dengan memperhatikan nilai &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;val_accuracy&quot;), &quot; pada setiap epochnya. Epoch dengan score &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;val_accuracy&quot;), &quot; tertinggi akan di save &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;weight&quot;), &quot; - nya untuk diload saat melakukan evaluasi dan pemrediksian terhadap data test.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Init\nscores_valid, scores_test, CMS = [], [], []\nHISTORY = []\n\n# Test Dataset\ntest_dataset = (tf.data.Dataset\n    .from_tensor_slices((regular_encode(test_text)))\n    .batch(BATCH_SIZE)\n)\n\nfor i in range(1, 11):\n    if i in [3, 6]: # Ambil Fold 3 dan 6\n        K.clear_session()\n        tf.tpu.experimental.initialize_tpu_system(tpu)\n\n        fold = f&apos;Fold {i}&apos;\n        print(f&apos;[INFO] {fold}&apos;)\n\n        # Split Dataset per Fold\n        x_train = train_text[folding[fold].values == 1]\n        y_train = train.label.values[folding[fold].values == 1]\n        x_val = train_text[folding[fold].values == 0]\n        y_val = train.label.values[folding[fold].values == 0]\n\n        # Encoding &amp; to TF Dataset\n        train_dataset = (tf.data.Dataset\n            .from_tensor_slices((regular_encode(x_train), y_train))\n            .batch(BATCH_SIZE)\n            .cache()\n            .repeat()\n            .shuffle(1024)\n            .prefetch(AUTO)\n        )\n        valid_dataset = (tf.data.Dataset\n            .from_tensor_slices((regular_encode(x_val), y_val))\n            .batch(BATCH_SIZE)\n            .cache()\n            .prefetch(AUTO)\n        )\n\n        # Training\n        with strategy.scope(): # Build &amp; Scoope Model\n            BERT = TFBertModel.from_pretrained(model_name)\n            model = build_model(BERT)\n\n        checkpoint = ModelCheckpoint(f&apos;Fold_{i}_best_model.h5&apos;, monitor=&apos;val_accuracy&apos;,\n                                     save_best_only=True, save_weights_only=True,\n                                     mode=&apos;max&apos;)\n\n        history = model.fit(train_dataset, epochs = 15,\n                            steps_per_epoch = len(x_train)//BATCH_SIZE,\n                            validation_data = valid_dataset,\n                            callbacks = [checkpoint])\n\n        # Load Weights\n        # model.load_weights(f&apos;Fold_{i}_best_model.h5&apos;) # Trained Best Weights\n        model.load_weights(f&apos;../input/modelku/{fold}_best_model.h5&apos;) # Catatan Cakrawala Weights\n\n        # Predict\n        pred_val  = model.predict(valid_dataset)  # Valid\n        pred_test = model.predict(test_dataset)   # Test\n\n        scores_valid.append(pred_val.flatten())\n        scores_test.append(pred_test.flatten())\n        CMS.append(confusion_matrix(y_val, np.array(pred_val.flatten() &gt;= .5, dtype=&apos;int&apos;),\n                                    normalize = &apos;true&apos;))\n        HISTORY.append(history.history)\n\nprint(f&apos;[INFO] Done&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;[INFO] Fold 3\nEpoch 1/15\n29/29 [==============================] - 51s 2s/step - loss: 0.6275 - accuracy: 0.7686 - val_loss: 0.4344 - val_accuracy: 0.8298\nEpoch 2/15\n29/29 [==============================] - 8s 277ms/step - loss: 0.4023 - accuracy: 0.8413 - val_loss: 0.4263 - val_accuracy: 0.8487\nEpoch 3/15\n29/29 [==============================] - 6s 199ms/step - loss: 0.3162 - accuracy: 0.8770 - val_loss: 0.4730 - val_accuracy: 0.8440\nEpoch 4/15\n29/29 [==============================] - 6s 200ms/step - loss: 0.2479 - accuracy: 0.9083 - val_loss: 0.5341 - val_accuracy: 0.7967\nEpoch 5/15\n29/29 [==============================] - 6s 202ms/step - loss: 0.1471 - accuracy: 0.9448 - val_loss: 0.5429 - val_accuracy: 0.8322\nEpoch 6/15\n29/29 [==============================] - 6s 201ms/step - loss: 0.0654 - accuracy: 0.9777 - val_loss: 0.7967 - val_accuracy: 0.8227\nEpoch 7/15\n29/29 [==============================] - 6s 203ms/step - loss: 0.0401 - accuracy: 0.9857 - val_loss: 0.8853 - val_accuracy: 0.8132\nEpoch 8/15\n29/29 [==============================] - 6s 201ms/step - loss: 0.0480 - accuracy: 0.9855 - val_loss: 0.8994 - val_accuracy: 0.8369\nEpoch 9/15\n29/29 [==============================] - 6s 200ms/step - loss: 0.0191 - accuracy: 0.9942 - val_loss: 0.9181 - val_accuracy: 0.8463\nEpoch 10/15\n29/29 [==============================] - 6s 204ms/step - loss: 0.0096 - accuracy: 0.9978 - val_loss: 1.0425 - val_accuracy: 0.8369\nEpoch 11/15\n29/29 [==============================] - 6s 198ms/step - loss: 0.0125 - accuracy: 0.9958 - val_loss: 1.0749 - val_accuracy: 0.8180\nEpoch 12/15\n29/29 [==============================] - 6s 200ms/step - loss: 0.0113 - accuracy: 0.9968 - val_loss: 1.2689 - val_accuracy: 0.8369\nEpoch 13/15\n29/29 [==============================] - 6s 201ms/step - loss: 0.0201 - accuracy: 0.9938 - val_loss: 1.1791 - val_accuracy: 0.8392\nEpoch 14/15\n29/29 [==============================] - 6s 198ms/step - loss: 0.0131 - accuracy: 0.9956 - val_loss: 1.2603 - val_accuracy: 0.8392\nEpoch 15/15\n29/29 [==============================] - 6s 202ms/step - loss: 0.0153 - accuracy: 0.9951 - val_loss: 1.2632 - val_accuracy: 0.8203\n[INFO] Fold 6\nEpoch 1/15\n29/29 [==============================] - 26s 912ms/step - loss: 0.5667 - accuracy: 0.7853 - val_loss: 0.4016 - val_accuracy: 0.8463\nEpoch 2/15\n29/29 [==============================] - 6s 205ms/step - loss: 0.3648 - accuracy: 0.8605 - val_loss: 0.4023 - val_accuracy: 0.8369\nEpoch 3/15\n29/29 [==============================] - 27s 935ms/step - loss: 0.3321 - accuracy: 0.8733 - val_loss: 0.3992 - val_accuracy: 0.8463\nEpoch 4/15\n29/29 [==============================] - 6s 203ms/step - loss: 0.2438 - accuracy: 0.9075 - val_loss: 0.4846 - val_accuracy: 0.8203\nEpoch 5/15\n29/29 [==============================] - 6s 203ms/step - loss: 0.1393 - accuracy: 0.9533 - val_loss: 0.5838 - val_accuracy: 0.8227\nEpoch 6/15\n29/29 [==============================] - 6s 204ms/step - loss: 0.1016 - accuracy: 0.9617 - val_loss: 0.6281 - val_accuracy: 0.8109\nEpoch 7/15\n29/29 [==============================] - 6s 200ms/step - loss: 0.0481 - accuracy: 0.9834 - val_loss: 0.7427 - val_accuracy: 0.8180\nEpoch 8/15\n29/29 [==============================] - 6s 201ms/step - loss: 0.0360 - accuracy: 0.9875 - val_loss: 0.7745 - val_accuracy: 0.8227\nEpoch 9/15\n29/29 [==============================] - 6s 202ms/step - loss: 0.0177 - accuracy: 0.9957 - val_loss: 0.8515 - val_accuracy: 0.8014\nEpoch 10/15\n29/29 [==============================] - 6s 203ms/step - loss: 0.0098 - accuracy: 0.9959 - val_loss: 0.9747 - val_accuracy: 0.8156\nEpoch 11/15\n29/29 [==============================] - 6s 205ms/step - loss: 0.0054 - accuracy: 0.9981 - val_loss: 1.0571 - val_accuracy: 0.8274\nEpoch 12/15\n29/29 [==============================] - 6s 202ms/step - loss: 0.0064 - accuracy: 0.9986 - val_loss: 1.1008 - val_accuracy: 0.8440\nEpoch 13/15\n29/29 [==============================] - 6s 205ms/step - loss: 0.0073 - accuracy: 0.9975 - val_loss: 1.0765 - val_accuracy: 0.8274\nEpoch 14/15\n29/29 [==============================] - 6s 205ms/step - loss: 0.0099 - accuracy: 0.9970 - val_loss: 1.0959 - val_accuracy: 0.8392\nEpoch 15/15\n29/29 [==============================] - 6s 204ms/step - loss: 0.0075 - accuracy: 0.9976 - val_loss: 1.0887 - val_accuracy: 0.8251\n[INFO] Done\n&quot;)), mdx(&quot;p&quot;, null, &quot;Meninjau &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;train history&quot;), &quot; pada model setiap &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fold&quot;), &quot; - nya&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig, (ax1, ax2) = plt.subplots(2, 1, figsize = (12, 10))\nfor i, fold in enumerate([3, 6]):\n    ax1.plot(range(1, 16), HISTORY[i][&apos;loss&apos;], label = f&apos;Fold {fold} loss&apos;)\n    ax1.plot(range(1, 16), HISTORY[i][&apos;val_loss&apos;], label = f&apos;Fold {fold} val_loss&apos;)\n    ax2.plot(range(1, 16), HISTORY[i][&apos;accuracy&apos;], label = f&apos;Fold {fold} accuracy&apos;)\n    ax2.plot(range(1, 16), HISTORY[i][&apos;val_accuracy&apos;], label = f&apos;Fold {fold} val_accuracy&apos;)\nax1.set_title(&apos;Loss at Training&apos;, fontsize = 14)\nax2.set_title(&apos;Accuracy at Training&apos;, fontsize = 14)\nax1.legend()\nax2.legend()\nfig.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/599ae3a41fde39efa22e75626a02c479/6bbf7/output_156_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;82.91139240506328%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAADL0lEQVQ4y4VUS2/bRhBm0UMP/REFepDzHwLUqG30nIMdpPceiv43H3xq4UbWI1biOKdCQlxHlixRosTlksul+NzHzBRklcpJA3iAD7skd4Yz832zzuur62+XfvhsvV4/j6LoWEp5IoRoIKU8Xnnei+vrt7/0+71fLy7avy2X3s9JXh7Hm/Qk5t5JHK5qHMto/Zxz9szp9Tp7AfOqyWRCy+WSrLUEADsgEtLOACxBVZBNBZloTTYJycQBWcFIFblyuhftVpYIwTknzrkFa6H2I8TtaoGsAlQpQCoABAOIA4BsU/8LUGvAOgskMsbETrvd3jMW4o8JIBHWoHotNwgJRxuHaNMNQpYiGtN8e4jt+Tpg4lwPrlppnsk4S4jAAOmSaCPIRj5ZGRJUihCQEHeF1/vPsAvYuRy0dJlHsT+n9WJshD+3ZZrYpllEnwLR4pdhtgGF0+12n2ht4GO9hTGUmpJEsaG0KiitSspVSYVWBPCQnv+bMQad09PT77Is+70sy9dlUfS1Uv2yKAZlVfVXEb9cRLwfZbLjCf7K34QdPwn6bugN3MjvT9lyMAlW/SnzLmfcexNvkj8cInoUjuN8tcXXj549Ozv7PuD8zWKxeD+dTodCiJExZgjWjpQ2w1UY3k49dzb3vbub+WR27y/GfhIN5xEbuSIYzkI2mkfB0BXBe5lurpzLV709KZiqRT2dTkkI0fQj0xWxVFJS5VSBocoaesystcZpv2y3VFlGWivSShkwxsoysyxNLOJ/DNek1WzCIyzHzvn5+Z6xVtK/XhAUWZPVJ5r7TMlfsJ0OX/a6LatUnIs1eYs7KERQR2gmAsE2g4PWIqocyRRIukA0ClFVCDJCLBKENAasCjJGS+f8z86TqsykH67IVhVQnqANVwjCRxAMQXKEOECQIUJaO8v6mSBmiGVGzbsiR0xjMkWWOH+9e9eSWbZJldkNs1HNLVMLGbQmQGhqskoTaNPsYVsnPGiD0jpz1r73jb9mT5eue+jO5z8y398fT+4PQ873Z7P7A9fzDnjA9z/c3h4FUbQ/c92Dv29ujkQY/jAaDn8KGNu/G48P78YfjhhjT/8B42rNSby+gN4AAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/599ae3a41fde39efa22e75626a02c479/f058b/output_156_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/599ae3a41fde39efa22e75626a02c479/c26ae/output_156_0.png 158w&quot;, &quot;/static/599ae3a41fde39efa22e75626a02c479/6bdcf/output_156_0.png 315w&quot;, &quot;/static/599ae3a41fde39efa22e75626a02c479/f058b/output_156_0.png 630w&quot;, &quot;/static/599ae3a41fde39efa22e75626a02c479/6bbf7/output_156_0.png 716w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Confussion Matrix prediksian model terhadap data valid per - &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;foldnya&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Plotting Confussion Matrix\nfig, ax = plt.subplots(1, 2, figsize = (14, 6))\ni = 0\nfor j in range(10):\n    if j in [2, 5]:\n        sns.heatmap(CMS[i], annot=True, cmap = plt.cm.Blues, ax = ax[i])\n        ax[i].set_title(f&apos;Normalized Confussion Matrix Valid Data Fold {j + 1}&apos;)\n        ax[i].set_xlabel(&apos;Predicted&apos;)\n        ax[i].set_ylabel(&apos;Actual&apos;)\n        i += 1\nfig.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/347db183fa9c90059caa30a5a3489834/97655/output_158_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;47.46835443037975%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACrUlEQVQoz02PW0jTARjFv8xpYpb2Uk8RiYROzUwzMLDU1KCHAt8y0tJkpjN1EdpD0UPhhYK5oXPpnGmGmF3AEkzTdG5zKkoTUue8LAunWabM7X878V8vPRw+OPw43znUOrW6v3nMsa2zONA+uYLCTisSnxiQrDQiuda0EnxZXZ6Qlu1bPzRLjRZHw7NRB/Tj31AzYEea2oyUWhPS6yyIvPNWT+GlUqp+MxyiMy86tQYb2saX2FsdU1xizWcmVWnA2afDc0eK35UlXMyWdNpcpDXa1VrjAppMdk91/xyXqjRw50XVjrAnH/ZpAjMbIkjZPx2sGVlYqxueh868wBd0WoUk1SiXXj+G1DqL7Uz1oOJcZo6fxrhIaoNdrTbYUT9iZx/3zQkXGsaFDM2YkKEZ55NrTdrY8ldSululOvTJ9tPZO+OEyfGbl+sMCM3X89G3XyCyqG3+SrOlTP++2xcAfZxbU/XOrGFwYYPVj9gRW9ouRBeLXCuf8qhHW9o9E05fpr8eYHms7TACAPCKqk7Q4av8nmgZdkfk2R50jSmGTB/8xECGh8rNihhYi3UZgTEFgq/0JijsupAkq9P2/NiW0vJ3Z7CLEVbXN10iyChqulgKu+EJOV0CSbRstm1gphTweBtue3jVposBwwtus9XBBsXL2X3xxayPNJ+5VNak2QLCaeOPSwz0bLr+vVbUdIFCc7A3Tg5JlGy1b2Lp3sai0dvQxQiN227ey5mtDgTFyRFwohAUnoesipZWAFHk5hCww0K56WKfA9CVVHa00NHspsDYwlZJlKxy0raaDmCXGLjDImvLzb0E0GiYtOuD4oqa/Y8X6OhYblPu/bZsAAfJO8XNea8oIvKhmEoKPKUgSWQ+TdjWRY9YjqNfWzv/cxT1GuQfU0QkLaRrFc1e/y8zkMkwXho3pQAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/347db183fa9c90059caa30a5a3489834/f058b/output_158_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/347db183fa9c90059caa30a5a3489834/c26ae/output_158_0.png 158w&quot;, &quot;/static/347db183fa9c90059caa30a5a3489834/6bdcf/output_158_0.png 315w&quot;, &quot;/static/347db183fa9c90059caa30a5a3489834/f058b/output_158_0.png 630w&quot;, &quot;/static/347db183fa9c90059caa30a5a3489834/97655/output_158_0.png 819w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;ensemble&quot;
  }, &quot;Ensemble&quot;), mdx(&quot;blockquote&quot;, null, mdx(&quot;p&quot;, {
    parentName: &quot;blockquote&quot;
  }, &quot;Ensemble is methods use multiple learning algorithms to obtain better predictive performance than could be obtained from any of the constituent learning algorithms alone.&quot;)), mdx(&quot;p&quot;, null, &quot;Untuk mendapatkan hasil yang lebih baik kami melakukan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ensembling&quot;), &quot; pada hasil prediksi model kami. Hasil model yang di &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ensembling&quot;), &quot; adalah hasil peramalan data test pada model &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;EfficientNetB7&quot;), &quot; dan model &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Bert&quot;), &quot; pada fold &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;3&quot;), &quot; dan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;6&quot;), &quot;. Metode ensemble yang digunakan adalah dengan mengambil rata - rata probabilitas dari hasil prediksian ketiga model tersebut.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;ensemble = (EfficientNet_pred.flatten() + scores_test[0] + scores_test[1]) / 3\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;mencari-threshold&quot;
  }, &quot;Mencari Threshold&quot;), mdx(&quot;blockquote&quot;, null, mdx(&quot;p&quot;, {
    parentName: &quot;blockquote&quot;
  }, &quot;The decision for converting a predicted probability or scoring into a class label is governed by a parameter referred to as the \u201Cthreshold\u201D The default value for the threshold is 0.5 for normalized predicted probabilities or scores in the range between 0 or 1.&quot;)), mdx(&quot;p&quot;, null, &quot;Kami mendapatkan beberapa indikasi bahwa untuk mendapatkan hasil yang lebih baik perlu dilakukan penggeseran terhadap tresholdnya:&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Kelas pada label yang tidak berimbang&quot;, mdx(&quot;br&quot;, null), &quot;\nKelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;0&quot;), &quot; pada label memiliki frekuensi yang sangat kecil, berbeda jauh jika dibandingkan dengan pada kelas &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;1&quot;), &quot;. Kami menduga hal ini berpengaruh terhadap berat masing - masing kelas pada saat dilakukan pemodelan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;tidak sama&quot;), &quot;.&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Nilai loss dan akurasi yang berbanding lurus pada saat training&quot;, mdx(&quot;br&quot;, null), &quot;\nPada saat training kami mendapatkan ketika &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;val_loss&quot;), &quot; (validation loss) menaik &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;val_accuracy&quot;), &quot; juga tetap menaik untuk beberapa saat. Hal ini cukup aneh karena seharusnya ketika nilai loss menaik maka nilai akurasi menurun. Hal ini membawa kami pada kesimpulan bahwa &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;threshold&quot;), &quot;-nya perlu untuk dirubah.&quot;)), mdx(&quot;p&quot;, null, &quot;Mengecek distribusi peluang &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ensemble&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;plt.figure(figsize = (8,6))\nsns.distplot(ensemble)\nplt.title(&apos;Distribusi Sebaran Peluang Prediksi&apos;, fontsize = 14)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;484px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/2023d3371a898bd7709f417b7372fcb3/ff42b/output_163_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;77.84810126582278%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACK0lEQVQ4y62Tz2sTQRTHB8zGHxCldtNsfhjaWtFLoR7qIbWoFy968m8wED3kFOJJCISYXBJ/QCKW6EEUPUVB9KheLB4UJeDBtJZNZm1KdrM7u9ndZHcyu7JNo+KPQ0kGHt8vM48P7w3vgUgkAorFIlUqldzlcpnK5/PuYDA47fP5jjnq9/tnHR8KhcKOMgwzFwgEZrxe74lwOHzkxctXrscP7lFvnz9yF27foUClUvHIsvyu2+3WNU2r6bq+JssyK0lSfRjtdhsOvSAInKOiKDYQQqyT31HVGuqodUWR34BoNBrCGPP2CEc3+7agmrZF+hzIZrO0aZrQebAsC1uWRXYTtm0TrYdxS+nZpI/XQTwe95um+X0HSHZTmWVZ26oZmOwAN0Amk/GOFRiLxQLjAPIdYwBMp9MjV6j2MIGiPgAmk0nfqECla5IqhwbAXC5HjxWYSCSYUYFIN8mnhmRbDjCVSv31h8NER3/3f8J+AjWDfGTFX0DDMLh/DTb5zzAP7wkZDLakGfgzlJyWv4FC4SaNMW6NsnqsoNlVTnZWD4JrySQtIfRBUtQtHin1TUGGHI+go1W2BSGPoIA6sNmWt4PdEuGXBg83miJc32zDr5wAn6yu1d/Xmi1BlFYBfXhiT2nl/r7jC6eYi1eu719OPXN7ZhemAkuXPIC6QXnmFun50+cnLr/uu5j5pUkQOjkJ6LsuMHP2IDh0lAGLt6jpC1cPLJ85N7Xy8OneH2fdSSvhaB+UAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/2023d3371a898bd7709f417b7372fcb3/ff42b/output_163_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/2023d3371a898bd7709f417b7372fcb3/c26ae/output_163_0.png 158w&quot;, &quot;/static/2023d3371a898bd7709f417b7372fcb3/6bdcf/output_163_0.png 315w&quot;, &quot;/static/2023d3371a898bd7709f417b7372fcb3/ff42b/output_163_0.png 484w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 484px) 100vw, 484px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;Dapat dilihat dari plot diatas bahwa sebaran peluang mulai memusat pada selang &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0.65&quot;), &quot; - &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;1&quot;), &quot;.&quot;), mdx(&quot;p&quot;, null, &quot;Maka dari itu kami putuskan untuk mengambil &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;0.65&quot;), &quot; sebagai &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;threshold&quot;), &quot;-nya.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;membuat-submission&quot;
  }, &quot;Membuat Submission&quot;), mdx(&quot;p&quot;, null, &quot;Membuat Submission File.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;test[&apos;prediksi&apos;] = np.array(ensemble &gt; .65, dtype = &apos;int&apos;)\nsubmission_temp = pd.read_csv(&apos;../input/data-bdc/Submission Template.csv&apos;)[[&apos;ID&apos;]]\nhasil = submission_temp.merge(test[[&apos;ID&apos;, &apos;prediksi&apos;]], on = &apos;ID&apos;)\nhasil.head()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;ID&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;prediksi&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;56&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1129&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;8468&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;9527&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;11152&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;)))), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;hasil.to_csv(&apos;Catatan Cakrawala BDC - Ensemble.csv&apos;, index = False)\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;kesimpulan--saran&quot;
  }, &quot;Kesimpulan &amp; Saran&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;kesimpulan&quot;
  }, &quot;Kesimpulan&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Data memiliki frekuensi kelas yang &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;tidak berimbang&quot;), &quot; sehingga perlu di perhatikan saat pembuatan model&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Dengan menggukan model yang kami buat didapatkan hasil yang cukup baik dengan f1 score 94 % namun memerlukan komputasi yang cukup berat dan biaya yang mahal untuk ukuran data yang tidak terlalu besar.&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;saran&quot;
  }, &quot;Saran&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Jika memungkinkan diperlukan &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;penambahan data&quot;), &quot; pada label bukan hoax agar frekuensi setiap kelas pada data tidak berbanding cukup jauh&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Menggunakan model &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;li&quot;
  }, &quot;multimodal&quot;), &quot; karena hasil pada ensembel model gambar dan model teks menunjukkan hasil yang lebih baik.&quot;)), mdx(&quot;p&quot;, null, &quot;\xA9 Catatan Cakrawala 2020&quot;));
}
;
MDXContent.isMDXComponent = true;</content:encoded></item><item><title><![CDATA[MNIST Digit Classifier Using Keras, Tensorflow, and TPU]]></title><description><![CDATA[This notebook is basically my notebook run on  kaggle  so if you want to try
and run the code with same environment as mine go to linkâ€¦]]></description><link>https://Hyuto.github.io/cnn-keras-cv-0-996-tpu/</link><guid isPermaLink="false">https://Hyuto.github.io/cnn-keras-cv-0-996-tpu/</guid><pubDate>Tue, 25 Aug 2020 15:56:36 GMT</pubDate><content:encoded>var _excluded = [&quot;components&quot;];

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i &lt; arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i &lt; sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i &lt; sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; target[key] = source[key]; } return target; }

/* @jsxRuntime classic */

/* @jsx mdx */
var _frontmatter = {
  &quot;title&quot;: &quot;MNIST Digit Classifier Using Keras, Tensorflow, and TPU&quot;,
  &quot;date&quot;: &quot;2020-08-25T22:56:36&quot;,
  &quot;description&quot;: &quot;Building MNIST Digit Classifier Model Using Keras, Tensorflow, and TPU&quot;,
  &quot;tags&quot;: &quot;classification, tensorflow, tpu, image, python&quot;
};
var layoutProps = {
  _frontmatter: _frontmatter
};
var MDXLayout = &quot;wrapper&quot;;
return function MDXContent(_ref) {
  var components = _ref.components,
      props = _objectWithoutProperties(_ref, _excluded);

  return mdx(MDXLayout, _extends({}, layoutProps, props, {
    components: components,
    mdxType: &quot;MDXLayout&quot;
  }), mdx(&quot;p&quot;, null, &quot;This notebook is basically my notebook run on &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/&quot;
  }, &quot;kaggle&quot;), &quot; so if you want to try\nand run the code with same environment as mine go to link bellow.&quot;), mdx(&quot;p&quot;, null, &quot;Kaggle Notebook : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/wahyusetianto/cnn-keras-cv-0-996-tpu&quot;
  }, &quot;CNN Keras CV - 0.996 [TPU]&quot;)), mdx(&quot;p&quot;, null, &quot;P.S. Don&apos;t forget to &quot;, mdx(&quot;em&quot;, {
    parentName: &quot;p&quot;
  }, &quot;upvote&quot;), &quot; if you like it \uD83D\uDE0A.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;overview&quot;
  }, &quot;Overview&quot;), mdx(&quot;p&quot;, null, &quot;This kernel is on purpose to build model for MNIST digits dataset. In this kernel we&apos;re gonna do some preprocessing then make augmentation datagen so our model didn&apos;t train on the same image data, then at each of our model(here we use 15 folds so there will be 15 models) to make prediction for test dataset and by the end we&apos;re gonna do ensembles for the prediction.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;web-app&quot;
  }, &quot;Web App&quot;), mdx(&quot;p&quot;, null, &quot;You can visit my web app for the live prediction by the best model trained on this kernel run on Tensorflow.js &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://hyuto.github.io/showcase/digit-recognizer/&quot;
  }, &quot;Digit Recognizer&quot;), &quot;.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;train-on-tpu&quot;
  }, &quot;Train on TPU!!&quot;), mdx(&quot;p&quot;, null, &quot;why? Because it&apos;s &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;faster&quot;), &quot;. While people usually train on GPU for image related things, in this notebook we try to do things on TPU and see how it affect the Accuracy.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;import random\nimport numpy as np\nimport pandas as pd\nfrom timeit import default_timer\nfrom sklearn.model_selection import KFold\n\n# Plot\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Tensorflow and Keras\nimport tensorflow as tf\nfrom tensorflow import keras\nimport tensorflow.keras.backend as K\nfrom tensorflow.keras.utils import to_categorical\nfrom tensorflow.keras.models import Sequential, load_model\nfrom tensorflow.keras.layers import Dense, Dropout, Flatten, Conv2D\nfrom tensorflow.keras.layers import MaxPool2D, BatchNormalization\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.callbacks import LearningRateScheduler, ModelCheckpoint\n\nprint(f&apos;Using Tensorflow Version : {tf.__version__}&apos;)\nprint(f&apos;Using Keras Version      : {keras.__version__}&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Using Tensorflow Version : 2.2.0\nUsing Keras Version      : 2.3.0-tf\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;load-the-data&quot;
  }, &quot;Load the Data&quot;), mdx(&quot;p&quot;, null, &quot;Load the MNIST data&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;train = pd.read_csv(&apos;../input/digit-recognizer/train.csv&apos;)\ntest = pd.read_csv(&apos;../input/digit-recognizer/test.csv&apos;)\ntrain.head()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;5 rows \xD7 785 columns\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;preprocess&quot;
  }, &quot;Preprocess&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;specifying-x-and-y&quot;
  }, &quot;Specifying X and y&quot;), mdx(&quot;p&quot;, null, &quot;for y we need to encode to one hot vector. In keras we have function &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;to_categorical&quot;), &quot; for this.&quot;), mdx(&quot;p&quot;, null, &quot;Example :&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;y = [1, 0, 4]\nto_categorical(y)\n\n# Output:\n[\n [0,1,0,0,0], # 1\n [1,0,0,0,0], # 0\n [0,0,0,0,1], # 4\n]\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Specifying X and y\nX = train.drop([&apos;label&apos;], axis = 1)\ny = to_categorical(train[&apos;label&apos;].values) # To Categorical y\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;normalizing-images&quot;
  }, &quot;Normalizing Images&quot;), mdx(&quot;p&quot;, null, &quot;Data normalization is an important step to ensures that each input parameter (pixel, in this case) has a similar data distribution. This makes convergence faster while training the network.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Normalize\nX = X / 255.0\nX_test = test / 255.0\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;reshape&quot;
  }, &quot;Reshape&quot;), mdx(&quot;p&quot;, null, &quot;Train and test images (28px x 28px) has been stock into pandas. Dataframe as 1D vectors of 784 values. We reshape all data to 28x28x1 3D matrices.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Reshape Array\nX = X.values.reshape(-1, 28, 28, 1)\nX_test = X_test.values.reshape(-1, 28, 28, 1)\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;lets-take-a-look-at-our-data&quot;
  }, &quot;Let&apos;s take a look at our data&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig, axes = plt.subplots(ncols=10, nrows=5, figsize = (13, 7))\ninit = 0\nfor i in range(5):\n    j = 0\n    for k in range(2):\n        ind = random.choices(train.label[train.label == init].index, k = 5)\n        init += 1\n        while j &lt; len(ind):\n            axes[i, k*5 + j].imshow(X[ind[j]][:,:,0], cmap=plt.cm.binary)\n            axes[i, k*5 + j].axis(&apos;off&apos;)\n            j += 1\n        j = 0\nfig.tight_layout()\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/0995ecc1e7de346086519e39d71607ea/cc488/output_12_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;52.53164556962025%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADBElEQVQozxWS3VPiVgDF869Xtzq7XTu7+1B37IMz4kpgpUZnG7aZKhgRhQQDCIR8EGgwueTrkhByEyaB28n775w558wh2u32axiGZLPZHGRZVqEoqj+fz8nRaCQlSfK93W4rcRwXJ5OJGEVRxfO81+VyWXIcp79er/+CEA4AAH8jhB4URekTz8/PQJblnzzPW/1+/+7k5MS0bfsnx3EQQvhvo9HwN5tNVZZlZ7Va3em6DrbbLaPrupll2Z2iKAuEUFNRlKHruoAQBKEEADjgeb4MAPggSRIZx/GBqqoVjPH7l5eXq81mcyAIwnfLsj64rktijA91XSdN0/wtDMOSqqqfkiT5M9cSxWIxGo/HD6enp8iyrNbV1VVo2/YDTdOp4zhNkiS3q9WKvbi42Hie15pOp+s4jhvD4TDMeZ7nc32/0+noPM+viSRJClEU7bmue75arQ4AAGfb7XYPQlhcLBbvDMMoxXH8i67rFxjjg5xHCO0HQXCWN/F9v4Ax/mhZ1h+maZ4RNE3jKIo6giDgbrf7enx8jCVJ6pTLZRwEQY9hGAwh5HNusVi8DodD7HmeMBqNsGmag9lshgEAqiiKHsdxmJhOp+e73W7fNM1v+Tbdbrdg2/a+ruulLMt+dV23nKbp3mQyKZqmeZg32e1278IwLKRpehgEwTfP845Go9GxZVnnBM/zvizLNZIkA9/3H2mahgihWqFQQMvlkm21WglC6I5l2bWmaQ2WZZeaptXH4zFUVfUxf8FgMOh0Op1JvV5fEpqmXWuadsRx3A2E8HOv16PSND2iKIre7XafFEWpRlH0UVXVH0mSfJZl+TqKot8dx6Ewxl8Mw7gxDOPrfD4vvL29XROz2UzDGOem0/V6Td/f36tJklD1ev0tDMMf1WrVsCyLEkXxvyiK6DwJhPCmUqmoDMPQiqJos9ks/yPPsuwkT2j6vl+VJAkEQXBbq9WMNE2rDMO4nucxl5eXMMsymuM4GyF022q1TNd1/6Eoynh6eroVRRE4jvPY6/UGsiwb/wOjpOMVzbCcsQAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/0995ecc1e7de346086519e39d71607ea/f058b/output_12_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/0995ecc1e7de346086519e39d71607ea/c26ae/output_12_0.png 158w&quot;, &quot;/static/0995ecc1e7de346086519e39d71607ea/6bdcf/output_12_0.png 315w&quot;, &quot;/static/0995ecc1e7de346086519e39d71607ea/f058b/output_12_0.png 630w&quot;, &quot;/static/0995ecc1e7de346086519e39d71607ea/cc488/output_12_0.png 928w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;as you can see there some nice &amp; bad hand written digits number at our dataset.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;data-augmentation&quot;
  }, &quot;Data Augmentation&quot;), mdx(&quot;p&quot;, null, &quot;we currently have about 42000 image data, let&apos;s multiply that value by doing some soft augmentation.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;datagen = ImageDataGenerator(rotation_range=10,\n                             zoom_range = 0.10,\n                             width_shift_range=0.1,\n                             height_shift_range=0.1)\n&quot;)), mdx(&quot;p&quot;, null, &quot;let&apos;s take a look on our Augmentation datagen&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def AUG_test(X, y):\n    fig, axes = plt.subplots(1, 5, figsize = (10,5))\n    axes[0].imshow(X[:,:,0], cmap=plt.cm.binary)\n    axes[0].set_title(&apos;Actual&apos;)\n    axes[0].axis(&apos;off&apos;)\n    for i in range(1, 5):\n        aug, _ = datagen.flow(X.reshape(1,28,28,1), y.reshape(1,10)).next()\n        axes[i].imshow(aug.reshape(28,28),cmap=plt.cm.binary)\n        axes[i].set_title(&apos;Augmented&apos;)\n        axes[i].axis(&apos;off&apos;)\n    fig.tight_layout()\n    return plt.show()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;AUG_test(X[0], y[0])\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/710183c6067410e8862ad6a60e749cd2/3d4b6/output_18_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;22.78481012658228%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABPklEQVQY0zWPwUsCURDG908KokuXDh27RYfskuXfE54CxYuXlA6BmBIqhRt4adNyfT1SWFAQBDVCAtd1ffOLF3aZ+Wa+b+abcbTWifF4fAYcAntKqYTruqnFYnEK7M7n86Nms5kKgiAZhuEBsO95XlIpddHv94+BneFweNJqtS611ucOQLvdRin1DTRtHccx3W7XwkcR+bHA933W67UG3m1dr9f/Nfc2hGEo1WoVJwgC0uk0xpgJ0LBkNpuNPc+z8AH40lpLoVBgu+ylXC5TLBZjIDLG3AGSy+WiTqeDk8lkmM1mVrwAnhuNBnZge+kTsMzn80wm1o/P6XTq12q1P15EbKoMBgNKpdJfzxmNRr513mw2j0Cm1+t1V6vV6/aa6+Vy6VYqlQ7wYYy5BW4sFpFXEbFvXEVR9CYiL9bwF7WcWuUXOXHlAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/710183c6067410e8862ad6a60e749cd2/f058b/output_18_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/710183c6067410e8862ad6a60e749cd2/c26ae/output_18_0.png 158w&quot;, &quot;/static/710183c6067410e8862ad6a60e749cd2/6bdcf/output_18_0.png 315w&quot;, &quot;/static/710183c6067410e8862ad6a60e749cd2/f058b/output_18_0.png 630w&quot;, &quot;/static/710183c6067410e8862ad6a60e749cd2/3d4b6/output_18_0.png 712w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;build-cnn-model&quot;
  }, &quot;Build CNN Model&quot;), mdx(&quot;p&quot;, null, &quot;The CNN&apos;s in this kernel follow LeNet5&apos;s design on &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/cdeotte&quot;
  }, &quot;Chris Deotte&quot;), &quot; kernel &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/cdeotte/25-million-images-0-99757-mnist&quot;
  }, &quot;here&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def build_model():\n    model = Sequential()\n    model.add(Conv2D(32, kernel_size = 3, activation=&apos;relu&apos;,\n                     input_shape = (28, 28, 1)))\n    model.add(BatchNormalization())\n    model.add(Conv2D(32, kernel_size = 3, activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Conv2D(32, kernel_size = 5, strides=2, padding=&apos;same&apos;,\n                     activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Dropout(0.4))\n\n    model.add(Conv2D(64, kernel_size = 3, activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Conv2D(64, kernel_size = 3, activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Conv2D(64, kernel_size = 5, strides=2, padding=&apos;same&apos;,\n                     activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Dropout(0.4))\n\n    model.add(Conv2D(128, kernel_size = 4, activation=&apos;relu&apos;))\n    model.add(BatchNormalization())\n    model.add(Flatten())\n    model.add(Dropout(0.4))\n    model.add(Dense(10, activation=&apos;softmax&apos;))\n\n    model.compile(optimizer=\&quot;adam\&quot;, loss=\&quot;categorical_crossentropy\&quot;,\n                  metrics=[\&quot;accuracy\&quot;])\n\n    return model\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;detect-and-instantiate-tpu-distribution-strategy&quot;
  }, &quot;Detect and Instantiate TPU Distribution Strategy&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# detect and init the TPU\ntpu = tf.distribute.cluster_resolver.TPUClusterResolver()\ntf.config.experimental_connect_to_cluster(tpu)\ntf.tpu.experimental.initialize_tpu_system(tpu)\n\n# instantiate a distribution strategy\ntpu_strategy = tf.distribute.experimental.TPUStrategy(tpu)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Config\nEPOCHS = 45\nBATCH_SIZE = 16 * tpu_strategy.num_replicas_in_sync\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;training&quot;
  }, &quot;Training&quot;), mdx(&quot;p&quot;, null, &quot;Here we use Kfold CV to split our data by 15 and build model at each fold. At the callbacks we use &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;math math-inline&quot;
  }, &quot;f(x) = 0.001 \\times 0.95^x&quot;), &quot; for our LR Scheduler and do Checkpoint at &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;best &quot;, mdx(&quot;em&quot;, {
    parentName: &quot;strong&quot;
  }, &quot;val_acc&quot;)), &quot; score.&quot;), mdx(&quot;p&quot;, null, &quot;Note that Tensorflow distribution strategy haven&apos;t supported &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;ImageDataGenerator&quot;), &quot; by this &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://github.com/tensorflow/tensorflow/issues/34346&quot;
  }, &quot;issue&quot;), &quot; so instead use that at &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fit_generator&quot;), &quot; we just have to extract Augmentation data by looping through and done training by &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;fit&quot;), &quot;.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Init\nscores, History = [], []\npred = np.zeros(shape = (len(test), 10))\n\n# CV\ncv = KFold(n_splits=15, shuffle = True, random_state = 42)\nfor fold, (train_index, val_index) in enumerate(cv.split(X)):\n    start = default_timer()\n    # Clear Session\n    K.clear_session()\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n\n    # Splitting\n    X_train , y_train = X[train_index], y[train_index]\n    X_val, y_val = X[val_index], y[val_index]\n\n    # Augmentation\n    Train_x, Train_y = None, None\n    batch = 0\n    for x_batch, y_batch in datagen.flow(X_train, y_train,\n                                         batch_size=BATCH_SIZE):\n        if batch == 0:\n            Train_x, Train_y = x_batch, y_batch\n        elif batch &gt;= X.shape[0] // BATCH_SIZE:\n            break\n        else:\n            Train_x = np.concatenate((Train_x, x_batch))\n            Train_y = np.concatenate((Train_y, y_batch))\n        batch += 1\n\n    # Model\n    with tpu_strategy.scope():\n        model = build_model()\n\n    # Callbacks\n    annealer = LearningRateScheduler(lambda x: 1e-3 * 0.95 ** x) # LR\n    sv = ModelCheckpoint(f&apos;Model Fold {fold}.h5&apos;, monitor=&apos;val_accuracy&apos;,\n                         save_best_only=True, mode=&apos;max&apos;)\n\n    # Training\n    history = model.fit(Train_x, Train_y, batch_size = BATCH_SIZE,\n                        epochs = EPOCHS, verbose = 0, callbacks=[annealer, sv],\n                        steps_per_epoch = X_train.shape[0]//BATCH_SIZE,\n                        validation_data = (X_val, y_val))\n    History.append(history.history)\n\n    # Load best model\n    model = load_model(f&apos;Model Fold {fold}.h5&apos;)\n\n    # Evaluate\n    score = model.evaluate(X_val, y_val, verbose = 0)[1]\n    scores.append(score)\n\n    # Making Prediction\n    pred += model.predict(X_test)\n\n    time = round(default_timer() - start, 4)\n    print(f&apos;[INFO] Fold {fold + 1} val_accuracy : {round(score, 4)} - Time : {time} s&apos;)\n\nprint()\nprint(f&apos;[INFO] Mean CV scores : {round(sum(scores)/len(scores), 4)}&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;[INFO] Fold 1 val_accuracy : 0.9961 - Time : 168.7797 s\n[INFO] Fold 2 val_accuracy : 0.9957 - Time : 173.7161 s\n[INFO] Fold 3 val_accuracy : 0.9986 - Time : 178.845 s\n[INFO] Fold 4 val_accuracy : 0.9957 - Time : 174.5829 s\n[INFO] Fold 5 val_accuracy : 0.9946 - Time : 173.8493 s\n[INFO] Fold 6 val_accuracy : 0.9979 - Time : 175.585 s\n[INFO] Fold 7 val_accuracy : 0.9964 - Time : 176.5861 s\n[INFO] Fold 8 val_accuracy : 0.9968 - Time : 177.6894 s\n[INFO] Fold 9 val_accuracy : 0.995 - Time : 179.8059 s\n[INFO] Fold 10 val_accuracy : 0.9943 - Time : 176.4369 s\n[INFO] Fold 11 val_accuracy : 0.9939 - Time : 182.6052 s\n[INFO] Fold 12 val_accuracy : 0.9961 - Time : 177.0005 s\n[INFO] Fold 13 val_accuracy : 0.995 - Time : 180.026 s\n[INFO] Fold 14 val_accuracy : 0.9954 - Time : 179.1445 s\n[INFO] Fold 15 val_accuracy : 0.9975 - Time : 175.2097 s\n\n[INFO] Mean CV scores : 0.9959\n&quot;)), mdx(&quot;p&quot;, null, &quot;And so we&apos;ve got really great CV score there. Let&apos;s check the Training History.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;history&quot;
  }, &quot;History&quot;), mdx(&quot;p&quot;, null, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Validation Loss&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/7422a0fae641ba551fdb715a86950450/302a4/val_loss.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;66.45569620253164%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6klEQVQ4y6WT6XLbMAyE+/7Pl2mnmTpObEuWdVKUeJP6OmTiK/1ZaDArQOAKJBc/tm0jW0qJGOMThhCoqoqmaajruriUkrym1MSIDwHnPVeeH1cyrTXeW7TVxPhF+oXZM3n2EofPXCZR68K5rgkh3gnzR2sdwa/088DV4hZv796GglvaCO6ed9rStS0hhscOI84HZnGhOb5gQsQ6y+rXUpjdmETIxxEiRodCTAS1Kuq6Kt3fCLeUMNYyjzXt20/25z3VNDAukk4PaK24TAOHYUKsK51U9Iumyy4Fp9PpmTCmiDWWufmg3/3i+L6jb2uOh4pDfeHSCY6XE+00Fx+1RAjJOE5oZVm1IT5uOZ9h7nDpBGL3G3Vq8E2F37/Svu2o397xQ4MbWmxfE9oTrs1YMR//YLUipvSw5W3D5i3Pgu5jz9icmcaJrukZ63e61xfmpkUeT4yHM2JYmMeJZRRoKQnelKaeZGONwbgVoUbMuuD1gl0EVgqMNqyjQA0dS98hhwEjJ8wqUKIlOkP4TqiNIeVnSyxWYkKOIyZa/OaxUWOdLj91waDtijES7RTO2387zMIO/lO41ltccEU6zjuMM0Xsyip89CUXiuBTWet9uN/y4+j54G9TkW6YbhPyHb2/1z+N3jX4X8s8fwHNYfM7HIlj8gAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;val-loss&quot;,
    &quot;title&quot;: &quot;val-loss&quot;,
    &quot;src&quot;: &quot;/static/7422a0fae641ba551fdb715a86950450/f058b/val_loss.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/7422a0fae641ba551fdb715a86950450/c26ae/val_loss.png 158w&quot;, &quot;/static/7422a0fae641ba551fdb715a86950450/6bdcf/val_loss.png 315w&quot;, &quot;/static/7422a0fae641ba551fdb715a86950450/f058b/val_loss.png 630w&quot;, &quot;/static/7422a0fae641ba551fdb715a86950450/40601/val_loss.png 945w&quot;, &quot;/static/7422a0fae641ba551fdb715a86950450/302a4/val_loss.png 1080w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Validation Accuracy&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/db083aad0563651af90980c4e8ae20ae/302a4/val_accuracy.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;66.45569620253164%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVQ4y6WTfW/bIBCH+/2/1/6vlqzNqrROHWNTNzZ2/AIY8DPZmb1kq6pNOwkh7uDh7vhxN44jk4UQ8N6vYzKlFEmSkOc5QghkJpFSrnuC/3Vm4dwtsL7v1+DgB6yzs18Pmt52OO/Qg6E1DdYNc8z6YU3EOXcL1EYTxoANlqavZ6AJlt5pjLOoqqY4lVRlRVXX1FWJqgvObYWzw1rVCrTGoE1LISV921PKE+9RTHmUiOeEUki65IU2OdIcj9THhDKNOb1G6LPCh6nk8QpoLUWakWy3iO1X5GaD2n0jftzwdP+FU/ZEkew57B+QMqJMXxCHHad4h+kafAhXGY4jRhvqvCJ9vCc/PCOi7+yTPbGMyfN3RPKCUA2yUhSlQrWat6Ihywt64wh/lGwH+ipHRA9kqiBTJXlV4kbQNnCuW856YKrMmECYE4H6rGm7Du9/exRjLZV6pcgjpm5YH+CihLk3zgbGn326uC6z7luyNL19lElDxhicNzRdO9+8+D8bk02tepPyVjYTXWs9X9oYz7+YtoY0yz7QodZzH7Ud5uAi1s/mOZGuJRWCYQFef71pY/gL0Efgm6+3LP7XJs4PIm3zZreLK4cAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;val-accuracy&quot;,
    &quot;title&quot;: &quot;val-accuracy&quot;,
    &quot;src&quot;: &quot;/static/db083aad0563651af90980c4e8ae20ae/f058b/val_accuracy.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/db083aad0563651af90980c4e8ae20ae/c26ae/val_accuracy.png 158w&quot;, &quot;/static/db083aad0563651af90980c4e8ae20ae/6bdcf/val_accuracy.png 315w&quot;, &quot;/static/db083aad0563651af90980c4e8ae20ae/f058b/val_accuracy.png 630w&quot;, &quot;/static/db083aad0563651af90980c4e8ae20ae/40601/val_accuracy.png 945w&quot;, &quot;/static/db083aad0563651af90980c4e8ae20ae/302a4/val_accuracy.png 1080w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;ensembleing-predictions&quot;
  }, &quot;Ensembleing Predictions&quot;), mdx(&quot;p&quot;, null, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;np.argmax&quot;), &quot; through the prediction to get the number of class&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;pred = np.array([np.argmax(x) for x in pred])\n\n# Countplot Prediction\nplt.figure(figsize = (7,7))\nsns.countplot(pred)\nplt.title(&apos;Countplot of Predictions&apos;)\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;451px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/331531bb65cc6908f464a6e2e9da132e/38070/output_30_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;94.9367088607595%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAD10lEQVQ4y62Ta0yTZxiG3wnq4lTAP8KSRV1iMv4s2yKJLNkhTA5CoQUMjE4UdbGwEEB0HLYsYGlhC4eICqKlFCi0wEI4CAj0a3WTmhFhBzqzgG1tRmCljQu0/Vpo+3338nVucT8Wd+BJnvfnlevO/bzEYrEQAOSHOUOI6eH8i78A4Uvc/mzZq9FQLxUUFLyek5NzuLCw8LX8/Pw3RCLRIZFIFNXf379veXl578LCQoTRaAw3m80RBoNhDwcL4oB2u73Vs+HF6sNv3GumGS+9vu6ladrndDgYh8PBuly0n6Zpv8vlYpxOJ+um3T6Px+N1u93crnvW12G32yfJ0ODANkLIdufqr0oAsMqFfnt3Lv7lMNzj9bhvE9uaO5gzNC8uK2xuwNqW7V3q/JCdtc+zi4vz7Nr9Gdb1eJWlnRssyzKs3+9n4QVrMT1iFe3t7OqqjfX5nL5l2gOjza4lGY2TwedtIMekqnZBwzhW2k76jK1ZeLcrFS03Psb3MbEYvzwMdeO9gIrX4cHijVno+yh8UiHGV3cqob+b5+fduovkIY2ORGWXc5G38S92dvJqx2ANAIWIV78Pmbwcc0d5GKkbgOrSNAavNUIjV2Cp+TvoVZOQfFEPSnMBWk2mnz+hh2CY0hHRiDUoukxJ0qTqtuTaMc7QyxnGqTN/ByYkYaR+AH1Ns7hSlIuuigqsyB9gSjUBcU0ttFQpbms/8Kf8AXynoGErISRYIFZ2JP9pmIU41V+BvVdncb2sCL3SalhlhqeAJdBRQn/K+BT4HDAy4cTzPwEktaqrnfcMYEtJIXokUlhlP/49cFf4voj0obVAZN7Tkf8r8EB04g5CyA7BRWVnct2t/2+oBrZEnZORNMkmGR4+XcGdTVCquOuZpfwjYEzx1a0IlNK9OaXkjq4EHbk0RdIkKsWmRE5v1ARzd8iv7FA+KWXD2JrFxKoyGJm8jJlLSGJG6gaY3iszTEtJAdMjkTBWmYGZ6p5gxDW1DEWVMDpK6A0AhyiKZHfOBb1ddZOkV/cEWrYpcmCSCwM/pbWtHIajSRitH0Rf07e4XlqIXqkUttYH0KsnUfV5HXTaUtzRCcGfvAfBTe3X5Pw0tpydB+F9KmtIrB54bGk5Pm9ozjC9155ubr52wTgdm2Dur+kxKxv05svFH5k6KipNj5rum7WKYdNnYql5bLTYNDaaYUwaoqy8L0e7yZN5bv+hmJ0HjwjDGk69ueuc4NXQ/SmvhIlyBTtPHXg57ExyTsixxLOh/LeiQ7Li4kPyE86EFZ3I2x0TGx+alxezOzMjMuxgZvaeyOOnX/gNDjTpSlOVscEAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/331531bb65cc6908f464a6e2e9da132e/38070/output_30_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/331531bb65cc6908f464a6e2e9da132e/c26ae/output_30_0.png 158w&quot;, &quot;/static/331531bb65cc6908f464a6e2e9da132e/6bdcf/output_30_0.png 315w&quot;, &quot;/static/331531bb65cc6908f464a6e2e9da132e/38070/output_30_0.png 451w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 451px) 100vw, 451px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;lets-check-some-of-our-prediction&quot;
  }, &quot;Let&apos;s check some of our prediction&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;fig, axes = plt.subplots(ncols=10, nrows=5, figsize = (13, 7))\ninit = 0\nfor i in range(5):\n    j = 0\n    for k in range(2):\n        ind = random.choices(test.index, k = 5)\n        init += 1\n        while j &lt; len(ind):\n            axes[i, k*5 + j].imshow(X_test[ind[j]][:,:,0], cmap=plt.cm.binary)\n            axes[i, k*5 + j].set_title(f&apos;Prediction : {pred[ind][j]}&apos;, fontsize = 11)\n            axes[i, k*5 + j].axis(&apos;off&apos;)\n            j += 1\n        j = 0\nfig.tight_layout()\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/93510023de4a8aa0b9df3c023f51c209/6295b/output_32_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;53.16455696202532%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADS0lEQVQozxXQa2/bVACA4fwy2KiGJsbaISaE6MQqxIBxGWnG2CQkVIkx2iplg03a1jGE1rJVCNJQGtpG6mLnNDSJ6zRu6pwcH9ttbMeXOL4kduK0/mDUH/BKj94YwzAJlmUv5fP5b3mef4ckye9ardZ5lmV/UBTlAsMwdziOGy0Wi3ckSRqjKGpa1/VzEMIZy7LOAQC+z+fzF3men+I4bjy2u7vLHh4ePqcoymi320/X19d7R0dHSUEQwn6//3Oj0QiiKLqLEAp833+wvb09HA6HSdM0Q9/3kyRJ9jDGT3Vd1x3H+TMmSdJlURTP7+zsXBUE4Wy9Xv/Cdd1TLMtO1mq1EYRQ3DCM0yzLxm3bHuE4LgEhfJXn+QTG+BWapr90HOd1jPFnhmG8GctkMnvtdnthdXVV9X3/CYTQ0XV9liTJwPO8e8vLy76u63MEQXi2bf+UyWT6ruvOEAQxlGV5dmtry2k2m0+y2WyrXC7/EatWqx9gjMd4nv9c1/U3RFGMF4vF1xqNxldBEJypVCrXIYQjsixfxxifoSjqRq/XO8UwzNee550+EVuWdZam6WuCIIzFarVaNQzDhVarpRiGMV+tVi1N02YAAH3Hce6urKz0bNtOptPpbqfTucdxnBcEwXQulxuYpjmzublpMQzzGCEkQwiXTh7eNE3zsqIot13Xfc+yrGlN0y7QND3H8/zbGxsbSUmS3qJpOuk4zkVBEOb6/f4oRVE/mqY5CgCYhRC+KwjC7U6nMxEDAPyl6/o0wzAvOY6bKhQKBcMwEgCAncFgcHN/f7/s+/4NAEA5CIJbEELKdd1JhBCtKEqiVCr95zjO1OLi4st0Op2MEQTxSFXVW6IovlAUZbJSqaR6vd6VQqGwqmna1Xq9vhIEwccAgL/DMPwUY/yPqqofIoQyURRdIUkyJctyfGlp6QVJkt/EcrncrKIo1/L5/CNN0z4hSfLXg4ODSzzPL6iqOpFOp581m833CYJ45nneBEJosdvtjgMAfk+lUuMIod8ajcZHe3t78xjjeCyVSjW73e5yqVQaCILwvFwuR2EY3hdFMTo+Pp7PZrORZVkPGYaJTNP8RZKkyLbt+2traxHG+AFFUVG73T7p+vV6/d//Ac59rqkeFQn6AAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/93510023de4a8aa0b9df3c023f51c209/f058b/output_32_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/93510023de4a8aa0b9df3c023f51c209/c26ae/output_32_0.png 158w&quot;, &quot;/static/93510023de4a8aa0b9df3c023f51c209/6bdcf/output_32_0.png 315w&quot;, &quot;/static/93510023de4a8aa0b9df3c023f51c209/f058b/output_32_0.png 630w&quot;, &quot;/static/93510023de4a8aa0b9df3c023f51c209/6295b/output_32_0.png 919w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;looks like our models really doing good for predicting test data&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;conclusions&quot;
  }, &quot;Conclusions&quot;), mdx(&quot;p&quot;, null, &quot;Based on our CV scores it&apos;s lower than &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/cdeotte&quot;
  }, &quot;Chris Deotte&quot;), &quot; kernel &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/cdeotte/25-million-images-0-99757-mnist&quot;
  }, &quot;here&quot;), &quot; with 0.99757 on validation accuracy on the same model architecture. So here&apos;s the point:&quot;), mdx(&quot;blockquote&quot;, null, mdx(&quot;p&quot;, {
    parentName: &quot;blockquote&quot;
  }, &quot;GPU do better job in this task &quot;, &quot;[Expected]&quot;, &quot; while TPU give you lower accuracy but faster since we&apos;d train 15 CNNs model on 45 epochs in less than one hour.&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;references&quot;
  }, &quot;References&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;25 Million Images! &quot;, &quot;[0.99757]&quot;, &quot; MNIST &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/cdeotte/25-million-images-0-99757-mnist&quot;
  }, &quot;Link&quot;)), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Introduction to CNN Keras - 0.997 (top 6%) &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/yassineghouzam/introduction-to-cnn-keras-0-997-top-6&quot;
  }, &quot;Link&quot;))));
}
;
MDXContent.isMDXComponent = true;</content:encoded></item><item><title><![CDATA[Machine Translation English to Japanese with Seq2Seq & Tensorflow]]></title><description><![CDATA[Hello guys, lately i've been studying about machine translation and give it a try. Most of code in this notebook is based on tensorflowâ€¦]]></description><link>https://Hyuto.github.io/machine-translation-en-jp-seq2seq-tf/</link><guid isPermaLink="false">https://Hyuto.github.io/machine-translation-en-jp-seq2seq-tf/</guid><pubDate>Wed, 19 Aug 2020 01:51:25 GMT</pubDate><content:encoded>var _excluded = [&quot;components&quot;];

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i &lt; arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i &lt; sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i &lt; sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) &gt;= 0) continue; target[key] = source[key]; } return target; }

/* @jsxRuntime classic */

/* @jsx mdx */
var _frontmatter = {
  &quot;title&quot;: &quot;Machine Translation English to Japanese with Seq2Seq &amp; Tensorflow&quot;,
  &quot;date&quot;: &quot;2020-08-19T08:51:25&quot;,
  &quot;description&quot;: &quot;Machine Translation English to Japanese using Seq2Seq &amp; Tensorflow 2&quot;,
  &quot;tags&quot;: &quot;nlp, nmt, tensorflow, seq2seq, python&quot;
};
var layoutProps = {
  _frontmatter: _frontmatter
};
var MDXLayout = &quot;wrapper&quot;;
return function MDXContent(_ref) {
  var components = _ref.components,
      props = _objectWithoutProperties(_ref, _excluded);

  return mdx(MDXLayout, _extends({}, layoutProps, props, {
    components: components,
    mdxType: &quot;MDXLayout&quot;
  }), mdx(&quot;p&quot;, null, &quot;Hello guys, lately i&apos;ve been studying about machine translation and give it a try.&quot;), mdx(&quot;p&quot;, null, &quot;Most of code in this notebook is based on tensorflow tutorial on their website\n&quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.tensorflow.org/addons/tutorials/networks_seq2seq_nmt&quot;
  }, &quot;TensorFlow Addons Networks : Sequence-to-Sequence NMT with Attention Mechanism&quot;), &quot;.&quot;), mdx(&quot;p&quot;, null, &quot;This notebook is basically my notebook run on &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/&quot;
  }, &quot;kaggle&quot;), &quot; so if you want to try\nand run the code with same environment as mine go to link bellow.&quot;), mdx(&quot;p&quot;, null, &quot;Kaggle Notebook : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.kaggle.com/wahyusetianto/machine-translation-en-jp-seq2seq-tf&quot;
  }, &quot;Machine Translation EN-JP Seq2Seq Tensorflow&quot;)), mdx(&quot;p&quot;, null, &quot;P.S. Don&apos;t forget to &quot;, mdx(&quot;em&quot;, {
    parentName: &quot;p&quot;
  }, &quot;upvote&quot;), &quot; if you like it \uD83D\uDE0A.&quot;), mdx(&quot;h1&quot;, {
    &quot;id&quot;: &quot;english---japanese-machine-translation&quot;
  }, &quot;English - Japanese Machine Translation&quot;), mdx(&quot;p&quot;, null, &quot;So in this notebook we&apos;re going to build English to Japanese machine translation, Japanese text contains lots of unique words because they have 3 type of it:&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Kanji&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Katakana&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Hiragana&quot;)), mdx(&quot;p&quot;, null, &quot;that&apos;s the interesting part of it and so it&apos;ll be little complicated to process. So let&apos;s get started.&quot;), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;install-some-tools&quot;
  }, &quot;Install some tools&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Sacreblue for calculate BLEU score&quot;), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;Googletrans =&gt; Google Translate for testing some sentences later&quot;)), mdx(&quot;p&quot;, null, &quot;Note : You can use NLTK for calculating BLEU score &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.nltk.org/_modules/nltk/translate/bleu_score.html&quot;
  }, &quot;documentation&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;!pip -q install sacrebleu\n!pip -q install googletrans\n!pip -q install tensorflow-addons --upgrade\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;import random, re, string, itertools, timeit, sacrebleu\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tqdm.notebook import tqdm\nfrom IPython.display import display, clear_output\nfrom sklearn.model_selection import train_test_split\n\n# Tensorflow &amp; Keras\nimport tensorflow as tf\nimport tensorflow_addons as tfa\nimport tensorflow.keras.backend as K\nfrom tensorflow.keras.layers import Input, Dense, LSTM, LSTMCell\nfrom tensorflow.keras.layers import Embedding, Bidirectional\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.preprocessing.text import Tokenizer\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.losses import SparseCategoricalCrossentropy\nfrom tensorflow.keras.optimizers import Adam\n\n# Japanese Word Tokenizer\nfrom janome.tokenizer import Tokenizer as janome_tokenizer\n\nplt.style.use(&apos;seaborn-pastel&apos;)\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;dataset&quot;
  }, &quot;Dataset&quot;), mdx(&quot;p&quot;, null, &quot;Here we use 55463 en-jp corpus from &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;http://www.manythings.org/bilingual/&quot;
  }, &quot;ManyThings.org Bilingual Sentence Pairs&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Download Data &amp; Unzip Data\n!wget http://www.manythings.org/anki/jpn-eng.zip\n!unzip jpn-eng.zip\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;--2020-08-19 01:52:31--  http://www.manythings.org/anki/jpn-eng.zip\nResolving www.manythings.org (www.manythings.org)... 104.24.109.196, 104.24.108.196, 172.67.173.198, ...\nConnecting to www.manythings.org (www.manythings.org)|104.24.109.196|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2303148 (2.2M) [application/zip]\nSaving to: \u2018jpn-eng.zip\u2019\n\njpn-eng.zip         100%[===================&gt;]   2.20M  9.70MB/s    in 0.2s\n\n2020-08-19 01:52:32 (9.70 MB/s) - \u2018jpn-eng.zip\u2019 saved [2303148/2303148]\n\nArchive:  jpn-eng.zip\n  inflating: jpn.txt\n  inflating: _about.txt\n&quot;)), mdx(&quot;p&quot;, null, &quot;Load data to memory.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;data = []\n\nf1 = open(&apos;./jpn.txt&apos;, &apos;r&apos;)\ndata += [x.rstrip().lower().split(&apos;\\t&apos;)[:2] for x in tqdm(f1.readlines())]\nf1.close()\n\nprint(f&apos;Loaded {len(data)} Sentences&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Loaded 53594 Sentences\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;text-preprocessing&quot;
  }, &quot;Text Preprocessing&quot;), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;handling-misspell-words--clearing-punctuation&quot;
  }, &quot;Handling misspell words &amp; Clearing Punctuation&quot;), mdx(&quot;p&quot;, null, &quot;we&apos;re gonna change the misspell words in english sentences and clearing punctuation from text.&quot;), mdx(&quot;p&quot;, null, &quot;\&quot;aren&apos;t my english bad?\&quot; -&gt; \&quot;are not my english bad\&quot;&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;mispell_dict = {\n    \&quot;aren&apos;t\&quot; : \&quot;are not\&quot;,\n    \&quot;can&apos;t\&quot; : \&quot;cannot\&quot;,\n    \&quot;couldn&apos;t\&quot; : \&quot;could not\&quot;,\n    \&quot;didn&apos;t\&quot; : \&quot;did not\&quot;,\n    \&quot;doesn&apos;t\&quot; : \&quot;does not\&quot;,\n    \&quot;don&apos;t\&quot; : \&quot;do not\&quot;,\n    \&quot;hadn&apos;t\&quot; : \&quot;had not\&quot;,\n    \&quot;hasn&apos;t\&quot; : \&quot;has not\&quot;,\n    \&quot;haven&apos;t\&quot; : \&quot;have not\&quot;,\n    \&quot;he&apos;d\&quot; : \&quot;he would\&quot;,\n    \&quot;he&apos;ll\&quot; : \&quot;he will\&quot;,\n    \&quot;he&apos;s\&quot; : \&quot;he is\&quot;,\n    \&quot;i&apos;d\&quot; : \&quot;i would\&quot;,\n    \&quot;i&apos;d\&quot; : \&quot;i had\&quot;,\n    \&quot;i&apos;ll\&quot; : \&quot;i will\&quot;,\n    \&quot;i&apos;m\&quot; : \&quot;i am\&quot;,\n    \&quot;isn&apos;t\&quot; : \&quot;is not\&quot;,\n    \&quot;it&apos;s\&quot; : \&quot;it is\&quot;,\n    \&quot;it&apos;ll\&quot;:\&quot;it will\&quot;,\n    \&quot;i&apos;ve\&quot; : \&quot;i have\&quot;,\n    \&quot;let&apos;s\&quot; : \&quot;let us\&quot;,\n    \&quot;mightn&apos;t\&quot; : \&quot;might not\&quot;,\n    \&quot;mustn&apos;t\&quot; : \&quot;must not\&quot;,\n    \&quot;shan&apos;t\&quot; : \&quot;shall not\&quot;,\n    \&quot;she&apos;d\&quot; : \&quot;she would\&quot;,\n    \&quot;she&apos;ll\&quot; : \&quot;she will\&quot;,\n    \&quot;she&apos;s\&quot; : \&quot;she is\&quot;,\n    \&quot;shouldn&apos;t\&quot; : \&quot;should not\&quot;,\n    \&quot;that&apos;s\&quot; : \&quot;that is\&quot;,\n    \&quot;there&apos;s\&quot; : \&quot;there is\&quot;,\n    \&quot;they&apos;d\&quot; : \&quot;they would\&quot;,\n    \&quot;they&apos;ll\&quot; : \&quot;they will\&quot;,\n    \&quot;they&apos;re\&quot; : \&quot;they are\&quot;,\n    \&quot;they&apos;ve\&quot; : \&quot;they have\&quot;,\n    \&quot;we&apos;d\&quot; : \&quot;we would\&quot;,\n    \&quot;we&apos;re\&quot; : \&quot;we are\&quot;,\n    \&quot;weren&apos;t\&quot; : \&quot;were not\&quot;,\n    \&quot;we&apos;ve\&quot; : \&quot;we have\&quot;,\n    \&quot;what&apos;ll\&quot; : \&quot;what will\&quot;,\n    \&quot;what&apos;re\&quot; : \&quot;what are\&quot;,\n    \&quot;what&apos;s\&quot; : \&quot;what is\&quot;,\n    \&quot;what&apos;ve\&quot; : \&quot;what have\&quot;,\n    \&quot;where&apos;s\&quot; : \&quot;where is\&quot;,\n    \&quot;who&apos;d\&quot; : \&quot;who would\&quot;,\n    \&quot;who&apos;ll\&quot; : \&quot;who will\&quot;,\n    \&quot;who&apos;re\&quot; : \&quot;who are\&quot;,\n    \&quot;who&apos;s\&quot; : \&quot;who is\&quot;,\n    \&quot;who&apos;ve\&quot; : \&quot;who have\&quot;,\n    \&quot;won&apos;t\&quot; : \&quot;will not\&quot;,\n    \&quot;wouldn&apos;t\&quot; : \&quot;would not\&quot;,\n    \&quot;you&apos;d\&quot; : \&quot;you would\&quot;,\n    \&quot;you&apos;ll\&quot; : \&quot;you will\&quot;,\n    \&quot;you&apos;re\&quot; : \&quot;you are\&quot;,\n    \&quot;you&apos;ve\&quot; : \&quot;you have\&quot;,\n    \&quot;&apos;re\&quot;: \&quot; are\&quot;,\n    \&quot;wasn&apos;t\&quot;: \&quot;was not\&quot;,\n    \&quot;we&apos;ll\&quot;:\&quot; will\&quot;,\n    \&quot;didn&apos;t\&quot;: \&quot;did not\&quot;,\n    \&quot;tryin&apos;\&quot;:\&quot;trying\&quot;\n}\n\nmispell_re = re.compile(&apos;(%s)&apos; % &apos;|&apos;.join(mispell_dict.keys()))\n\ndef preprocess(text) -&gt; str:\n    def replace(match):\n        return mispell_dict[match.group(0)]\n\n    text = mispell_re.sub(replace, text)\n    return text\n&quot;)), mdx(&quot;p&quot;, null, &quot;Japanese words have their own punctuation like \u3010this\u3011&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Adding Japanese Punctuation\nstring.punctuation += &apos;\u3001\u3002\u3010\u3011\u300C\u300D\u300E\u300F\u2026\u30FB\u303D\uFF08\uFF09\u301C\uFF1F\uFF01\uFF61\uFF1A\uFF64\uFF1B\uFF65&apos;\n\nCP = lambda x : x.translate(str.maketrans(&apos;&apos;, &apos;&apos;, string.punctuation))\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;data = [x for x in data if len(x) == 2]\n\neng_data = [CP(preprocess(x[0])) for x in data]\njpn_data = [CP(x[1]) for x in data]\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;segmenting-japanese-sentences&quot;
  }, &quot;Segmenting Japanese Sentences&quot;), mdx(&quot;p&quot;, null, &quot;Unlike english sentence we can tokenize it by splitting words with space just like this,&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;&apos;This is english or i think so&apos;.split()\n\nOutput:\n[&apos;This&apos;, &apos;is&apos;, &apos;english&apos;, &apos;or&apos;, &apos;i&apos;, &apos;think&apos;, &apos;so&apos;]\n&quot;)), mdx(&quot;p&quot;, null, &quot;but in Japanese we can&apos;t do it that way. Here we gonna use Janome Tokenizer to segmenting Japanese sentence and adding space to it so Keras Tokenizer can handle it.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Initialize Janome Tokenizer\ntoken_jp = janome_tokenizer()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;sample_text = &apos;\u3053\u3053\u3067\u79C1\u306F\u82F1\u8A9E\u3067\u8A71\u3057\u3066\u3044\u308B&apos;\n&apos; &apos;.join([word for word in token_jp.tokenize(sample_text, wakati=True) \\\n          if word != &apos; &apos;])\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;&apos;\u3053\u3053 \u3067 \u79C1 \u306F \u82F1\u8A9E \u3067 \u8A71\u3057 \u3066 \u3044\u308B&apos;\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Apply to Japanese Sentences\njpn_data = [&apos; &apos;.join([word for word in token_jp.tokenize(x, wakati=True) \\\n                      if word != &apos; &apos;]) for x in tqdm(jpn_data)]\n&quot;)), mdx(&quot;p&quot;, null, &quot;For evaluating our model let&apos;s split our data.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;eng_train, eng_test, jpn_train, jpn_test = \\\ntrain_test_split(eng_data, jpn_data, test_size = 0.04, random_state = 42)\n\nprint(f\&quot;Splitting to {len(eng_train)} Train data and \\\n{len(eng_test)} Test data\&quot;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Splitting to 51450 Train data and 2144 Test data\n&quot;)), mdx(&quot;h3&quot;, {
    &quot;id&quot;: &quot;add-bos-and-eos&quot;
  }, &quot;Add BOS and EOS&quot;), mdx(&quot;p&quot;, null, &quot;We put BOS \&quot;Begin of Sequence\&quot; and EOS \u201CEnd of Sequence\&quot; to help our decoder recognize begin and end of a sequence.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;eng_train = [&apos;bos &apos;+ x + &apos; eos&apos; for x in eng_train + [&apos;unk unk unk&apos;]]\njpn_train = [&apos;bos &apos;+ x + &apos; eos&apos; for x in jpn_train + [&apos;unk unk unk&apos;]]\n\neng_val = [&apos;bos &apos;+ x + &apos; eos&apos; for x in eng_test]\njpn_val = [&apos;bos &apos;+ x + &apos; eos&apos; for x in jpn_test]\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;word-tokenizing&quot;
  }, &quot;Word Tokenizing&quot;), mdx(&quot;p&quot;, null, &quot;Here we use Tokenizer API from Keras to make vocabulary and tokenizing our data&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# English Tokenizer\nen_tokenizer = Tokenizer(filters=&apos;&apos;)\nen_tokenizer.fit_on_texts(eng_train)\n\n# Japannese Tokenizer\njp_tokenizer = Tokenizer(filters=&apos;&apos;)\njp_tokenizer.fit_on_texts(jpn_train)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;print(f&apos;English vocab size   :&apos;, len(en_tokenizer.word_index) - 3)\nprint(f&apos;Japanese vocab size  :&apos;, len(jp_tokenizer.word_index) - 3)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;English vocab size   : 9646\nJapanese vocab size  : 14403\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;word-cloud&quot;
  }, &quot;Word Cloud&quot;), mdx(&quot;p&quot;, null, &quot;What comes when doing NLP? It&apos;s Word Cloud. Let&apos;s do it for our vocab.&quot;), mdx(&quot;p&quot;, null, &quot;Font : &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;p&quot;,
    &quot;href&quot;: &quot;https://www.google.com/get/noto/&quot;
  }, &quot;Google Noto Fonts&quot;), &quot; -&gt; Noto Sans CJK JP&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;!wget https://noto-website-2.storage.googleapis.com/pkgs/NotoSansCJKjp-hinted.zip\n!wget https://raw.githubusercontent.com/Hyuto/NMT-TF-Seq2seq-EN-JP/master/Japan.jpg\n!wget https://raw.githubusercontent.com/Hyuto/NMT-TF-Seq2seq-EN-JP/master/English.png\n!mkdir font\n!unzip NotoSansCJKjp-hinted.zip -d ./font\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;--2020-08-19 01:53:52--  https://noto-website-2.storage.googleapis.com/pkgs/NotoSansCJKjp-hinted.zip\nResolving noto-website-2.storage.googleapis.com (noto-website-2.storage.googleapis.com)... 172.217.204.128, 2607:f8b0:400c:c15::80\nConnecting to noto-website-2.storage.googleapis.com (noto-website-2.storage.googleapis.com)|172.217.204.128|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 121096772 (115M) [application/zip]\nSaving to: \u2018NotoSansCJKjp-hinted.zip\u2019\n\nNotoSansCJKjp-hinte 100%[===================&gt;] 115.49M  53.3MB/s    in 2.2s\n\n2020-08-19 01:53:54 (53.3 MB/s) - \u2018NotoSansCJKjp-hinted.zip\u2019 saved [121096772/121096772]\n\n--2020-08-19 01:53:55--  https://raw.githubusercontent.com/Hyuto/NMT-TF-Seq2seq-EN-JP/master/Japan.jpg\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.200.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.200.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3976 (3.9K) [image/jpeg]\nSaving to: \u2018Japan.jpg\u2019\n\nJapan.jpg           100%[===================&gt;]   3.88K  --.-KB/s    in 0s\n\n2020-08-19 01:53:55 (46.7 MB/s) - \u2018Japan.jpg\u2019 saved [3976/3976]\n\n--2020-08-19 01:53:56--  https://raw.githubusercontent.com/Hyuto/NMT-TF-Seq2seq-EN-JP/master/English.png\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.200.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.200.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 303684 (297K) [image/png]\nSaving to: \u2018English.png\u2019\n\nEnglish.png         100%[===================&gt;] 296.57K  --.-KB/s    in 0.1s\n\n2020-08-19 01:53:56 (2.18 MB/s) - \u2018English.png\u2019 saved [303684/303684]\n\nArchive:  NotoSansCJKjp-hinted.zip\n  inflating: ./font/LICENSE_OFL.txt\n  inflating: ./font/NotoSansCJKjp-Black.otf\n  inflating: ./font/NotoSansCJKjp-Bold.otf\n  inflating: ./font/NotoSansCJKjp-DemiLight.otf\n  inflating: ./font/NotoSansCJKjp-Light.otf\n  inflating: ./font/NotoSansCJKjp-Medium.otf\n  inflating: ./font/NotoSansCJKjp-Regular.otf\n  inflating: ./font/NotoSansCJKjp-Thin.otf\n  inflating: ./font/NotoSansMonoCJKjp-Bold.otf\n  inflating: ./font/NotoSansMonoCJKjp-Regular.otf\n  inflating: ./font/README\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from wordcloud import WordCloud, ImageColorGenerator\nfrom PIL import Image\n\ndef get_words(arr):\n    keys = list(arr.keys())\n    count = list(arr.values())\n    return &apos; &apos;.join([x for _,x in sorted(zip(count, keys), reverse = True)][2:])\n\ndef transform(arr):\n    for i in range(len(arr)):\n        for j in range(len(arr[i])):\n            if not any(arr[i][j]):\n                arr[i][j] = np.array([225, 225, 225, 225])\n    return arr\n\nfont_path = &apos;./font/NotoSansCJKjp-Light.otf&apos;\n\n\nmask = &apos;./English.png&apos;\nmask = np.array(Image.open(mask))\nmask = transform(mask)\nimage_colors = ImageColorGenerator(mask)\nwords = get_words(en_tokenizer.word_counts).title()\nwc = WordCloud(background_color=\&quot;white\&quot;, max_words=2000, random_state=42,\n               width=mask.shape[1], height=mask.shape[0])\nwc = wc.generate(words)\nfig1, ax1 = plt.subplots(figsize=(20,15))\nax1.imshow(wc.recolor(color_func=image_colors), interpolation=&apos;bilinear&apos;)\nax1.axis(\&quot;off\&quot;)\n\nmask = &apos;./Japan.jpg&apos;\nmask = np.array(Image.open(mask))\nimage_colors = ImageColorGenerator(mask)\nwords = get_words(jp_tokenizer.word_counts).title()\nwc = WordCloud(collocations=False, background_color=\&quot;white\&quot;, mode=\&quot;RGBA\&quot;,\n               max_words=6000, font_path=font_path, contour_width=1,\n               scale=5, max_font_size = 50, relative_scaling=0.5,\n               random_state=42, width=mask.shape[1], height=mask.shape[0])\nwc = wc.generate(words)\nfig2, ax2 = plt.subplots(figsize=(20,15))\nax2.imshow(wc.recolor(color_func=image_colors), interpolation=&apos;bilinear&apos;)\nax2.axis(\&quot;off\&quot;)\n\nfig1.savefig(&apos;WC_English.png&apos;)\nfig2.savefig(&apos;WC_Japanese.png&apos;)\nplt.close(fig1)\nplt.close(fig2)\n\n!rm -rf ./font\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;English&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/925d8b9db09014ceb7735de6722223fc/07a9c/WC_English.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;75.31645569620254%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACg0lEQVQ4y3WUe1PaUBDF/f5fojPtdOpM31qtDxQReQfQJAQSEhIICAQIT5WQhF8HrA62sH/cvbsze2bvPbtnj7+2XC75z7akdtlL/d5msFj4zD2PMAzx/YCQJU+TGaNml8Dz8D0P7/GR+fQB31sQLBYEfvBav/J7q+MlMRpPqVlNalYL+75Lr9Ul8/WcXCSNKWu0iiWMeA5XNbAydyjnSSYd5xVsDbjZYdsZYDXuKWsWomYhRFLkLrPkErfoQonCp2MK+7+pZ0TUsySp71fULYcw3NFhtzek1uhyq1hkZZPEWZqb4wSxwziVwyiZ9weopzd0FAMzXyZ/LWK2x+vv2QroDkbUzBaKZiOW60iKxfX+KZfvftLNSpg3ecq/rhjIGj3FQDmK0Tdbb5+8Ceg4LpJUparbFAsVBNEgmy2TjwrYxQpWPE/16IpZUWYmV3goyPTkCsFuUmbcNx3seoe61SZ9kSN+lECNCXRiWTo5kV6pSldSsW417EKZe6mynoqtgEN3REfRGZhNnHYfJZpDu0jzpFvoHw+QTxKMW11aJZ22VqcqlKnlxN1j8+AOcSSVodFgvGI8r9BMFQlVHf3DD5InWe4EjXHbwRCr2GqdiqjhBxuksAH4NJkyUHT6moXbaNOIC6T3zximb+l8OyEVKRCLyYjXRUoFDUPSMXSbxS6WZ30XRzMZmk06RpPI5yhnX2IYgkI9mka+SHOXlJHzJWqqQdOyMavmesO2Ak6cAbZSxVAMZMXk/EYikdcQFYuWM+Dh6ZHpbMZoPGYynTCdTXHd4RZSnqO1X+2vt1gwn88JA58g8J8LlkvCIFjf1w0s3wrKG3F4FZblboX5V402md1k+Q9clGHGV8oF9gAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;wc-english&quot;,
    &quot;title&quot;: &quot;wc-english&quot;,
    &quot;src&quot;: &quot;/static/925d8b9db09014ceb7735de6722223fc/f058b/WC_English.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/925d8b9db09014ceb7735de6722223fc/c26ae/WC_English.png 158w&quot;, &quot;/static/925d8b9db09014ceb7735de6722223fc/6bdcf/WC_English.png 315w&quot;, &quot;/static/925d8b9db09014ceb7735de6722223fc/f058b/WC_English.png 630w&quot;, &quot;/static/925d8b9db09014ceb7735de6722223fc/40601/WC_English.png 945w&quot;, &quot;/static/925d8b9db09014ceb7735de6722223fc/78612/WC_English.png 1260w&quot;, &quot;/static/925d8b9db09014ceb7735de6722223fc/07a9c/WC_English.png 1440w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;Japanese&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/97526e703f2d47eceebc07ee03968a2e/07a9c/WC_Japanese.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;75.31645569620254%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAA70lEQVQ4y62UDQuCMBiE/f+/LaikKCvsO/qiaE6duu1iA0Pi3VzQCzIQ9+yOuxmBGK31Z22f7nvfRKFAEk4cEPlgXahL8bfqfoVKkRtd9p3AdoPMS4jzHeX2ZNcmy0m1/ZalRMM4sukKbDjDazBFNllCHK+QpQi33H6gRIVicwSLE2TxwoL5fA02mqO6Pcmg/MC6QZHuweIFeLIBn6UWzMYJ6sfrd4UmDHG5W5Cxa5QZYJEeoKqabIQT+FHZSAswMJ6ska92NhiqTsEpa6lsOPWTQRals6+9ln1do8ofrtBz9XTI1etQSWDfTyLCn+cNu5Sfjc744QQAAAAASUVORK5CYII=&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;wc-japanese&quot;,
    &quot;title&quot;: &quot;wc-japanese&quot;,
    &quot;src&quot;: &quot;/static/97526e703f2d47eceebc07ee03968a2e/f058b/WC_Japanese.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/97526e703f2d47eceebc07ee03968a2e/c26ae/WC_Japanese.png 158w&quot;, &quot;/static/97526e703f2d47eceebc07ee03968a2e/6bdcf/WC_Japanese.png 315w&quot;, &quot;/static/97526e703f2d47eceebc07ee03968a2e/f058b/WC_Japanese.png 630w&quot;, &quot;/static/97526e703f2d47eceebc07ee03968a2e/40601/WC_Japanese.png 945w&quot;, &quot;/static/97526e703f2d47eceebc07ee03968a2e/78612/WC_Japanese.png 1260w&quot;, &quot;/static/97526e703f2d47eceebc07ee03968a2e/07a9c/WC_Japanese.png 1440w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;now let&apos;s transform our train sentences to sequences.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def Sequences(texts, tokenizer):\n    res = []\n    for text in texts:\n        seq = []\n        for w in text.split():\n            try:\n                seq.append(tokenizer.word_index[w])\n            except:\n                seq.append(tokenizer.word_index[&apos;unk&apos;])\n        res.append(seq)\n    return res\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Transform Sentences to Sequences\ndata_en = en_tokenizer.texts_to_sequences(eng_train)\ndata_jp = jp_tokenizer.texts_to_sequences(jpn_train)\n\nval_en = Sequences(eng_val, en_tokenizer)\nval_jp = Sequences(jpn_val, jp_tokenizer)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;plt.figure(figsize = (8,8))\nsns.distplot([len(x) for x in data_en], label=&apos;English&apos;)\nsns.distplot([len(x) for x in data_jp], label=&apos;Japanese&apos;)\nplt.title(&apos;Distribution of Sentences Length&apos;)\nplt.legend()\nplt.show()\n&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;490px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/8ce63a24a5b8ffbe5487aa1074fa8a20/41d3c/output_32_0.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;98.10126582278481%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACwklEQVQ4y6WUW08TQRTH91UTL/XViES8pRD7RELDEwnhkY/gix/AJx8MGm+BGCWR1jbGxAh4ibEQiAoJIBcxxkBSwYhEpCz0Srud3XZ3u213ZnbnmG5boSGGFs/m7Ewyk9/+/2d2DudwODiv13PY5XKf8HoeH3e7+mwDg4PHOjs765ubmx1Op7Opo6OjoaWlpam1tdXe3t5+zul0Nra1tZ33+XxHHz3os3lcHtvAQL/N6/Ue4QCAEwThpWEYlFKKKKWSYRgSxiSt67qSz+dVjLFcnu8aZdMwJCWHU/EkQps8ryOE5iygLMujAADEBCAG1BR5E4OkpCEWjQJC6DsXCAQ4NZN5C8BAp0DylJkAzGTMyv3CBAYmAFBLECH+ssLhAjBPgKZyjBUWC+/ibG8wK4sbrIcxy5eu698sIEKiZVnOM4q0/YHFdfZ3rABGIhFOVTO+wjejCtCwvAOsNiqAsViMU0rAtSTQVaEMZFVD/2n5N2J0KWYVu8JWzcB0unAoACsJRr+GypwDKuR5vmQZwL+N6VxY+3+FqXTaUriU0OloKMpyJtl9grUDkwhZNVyVsnQkFGYyze0AoUZgMBjkFFW1LP9UEB2J8mxdUQ6uMJtROVVVhgoXblEU6LvtDeYXJQAwSz/3/tA9liVJHKUmwLwYouOJDfZJiANh1ddxD1BVlCFsmDAvBsmEsMEm4mGGaNq6stV0CMYYLQH9XGwzyOnZ3LBKMUwmeTYt8jApbMGKtg0AtfUyjPFysduIqTdbmggf4r+UycS6NpUIaFPxrcwPJaJJuqpliZ7BFGuYEo0YRCO0MjElKjUMls1lv3Acxx3qutF15vn0WMOT2ff1V3u7G+8Oui+89s/UXe7pbrxyv9f+bGHh1DXvHfvtpz32j2uf63pfuC7ect9rGl+eOt0//urs9Yc3L40tTpyZmZ89+Qdd/6OoUfpEpAAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/8ce63a24a5b8ffbe5487aa1074fa8a20/41d3c/output_32_0.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/8ce63a24a5b8ffbe5487aa1074fa8a20/c26ae/output_32_0.png 158w&quot;, &quot;/static/8ce63a24a5b8ffbe5487aa1074fa8a20/6bdcf/output_32_0.png 315w&quot;, &quot;/static/8ce63a24a5b8ffbe5487aa1074fa8a20/41d3c/output_32_0.png 490w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 490px) 100vw, 490px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;p&quot;, null, &quot;based on the distplot English sentences contains about 20 - 40 words while Japanese have more wider range.&quot;), mdx(&quot;p&quot;, null, &quot;Let&apos;s check their max length&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;max_en = max([len(x) for x in data_en] + [len(x) for x in val_en])\nmax_jp = max([len(x) for x in data_jp] + [len(x) for x in val_jp])\n\nprint(f&apos;Maximum length of English sequences is  {max_en}&apos;)\nprint(f&apos;Maximum length of Japanese sequences is {max_jp}&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;Maximum length of English sequences is  49\nMaximum length of Japanese sequences is 54\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Padding Sequences\ndata_en = pad_sequences(data_en, padding=&apos;post&apos;, maxlen = max_en)\ndata_jp = pad_sequences(data_jp, padding=&apos;post&apos;, maxlen = max_jp)\n\nval_en = pad_sequences(val_en, padding=&apos;post&apos;, maxlen = max_en)\nval_jp = pad_sequences(val_jp, padding=&apos;post&apos;, maxlen = max_jp)\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;build--train-model&quot;
  }, &quot;Build &amp; Train Model&quot;), mdx(&quot;p&quot;, null, &quot;Now it&apos;s the time brace yourself.&quot;), mdx(&quot;p&quot;, null, &quot;We&apos;ll build model based on Seq2seq approaches with Attention optimization.&quot;), mdx(&quot;blockquote&quot;, null, mdx(&quot;p&quot;, {
    parentName: &quot;blockquote&quot;
  }, &quot;Seq2Seq is a method of encoder-decoder based machine translation that maps an input of sequence to an output of sequence with a tag and attention value. The idea is to use 2 RNN that will work together with a special token and trying to predict the next state sequence from the previous sequence.&quot;)), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;630px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/5a190/seq2seq.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;50.632911392405056%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz22R2W7bMBBF/f/fE+SlD0WA5K1tHFuKbS22ZWqjJNJcRdLm0ipKUBvtATHALBd3wFmEe5xzWZZRRkMIPvi56P38fJJkjPGrdeZiQwiL8A/GGGvtbeViOCdgFDBPl+xcNtWW4PL/4nsmc85AWz6t3x6T7bf18gHWzwTHzrnF/dhNvEk73P1cv5awXm3X2SmP0vf0mM/OU59JUrRpj9uyO3S4rvqi7k8dagDMjdFEqAPE7YD3LWoGfGj6lohJ7P0k7s4wLn5lRZI28b5KdyDagTgDyaZcEYorRHZIRvkxxeOmqN7rYY+4s/bTWY2kKlejKE/Fsu9SAKIe7jg51lXsvdXmAvtByBEOSEjZDUgq9Xdto3qBXzWPweEF7F+yzXfU/tAs4ujNXrX3nlIy73jL54dZ61qIrAuYsKu1Uiou9OXqhdTz8b337gP7xSQ2xgAAKKWMETXK8xkLwTljlJJRCsqotVZrzRj7iFRKKYRQSv051W8r8je8hZRFFgAAAABJRU5ErkJggg==&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;Seq2Seq&quot;,
    &quot;title&quot;: &quot;Seq2Seq&quot;,
    &quot;src&quot;: &quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/f058b/seq2seq.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/c26ae/seq2seq.png 158w&quot;, &quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/6bdcf/seq2seq.png 315w&quot;, &quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/f058b/seq2seq.png 630w&quot;, &quot;/static/a5a04f4dc28fd14e1a9c5e883fda9bf5/5a190/seq2seq.png 800w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 630px) 100vw, 630px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Config\nepochs = 7\nBATCH_SIZE = 64\nBUFFER_SIZE = len(data_jp)\nsteps_per_epoch = BUFFER_SIZE//BATCH_SIZE\nval_steps_per_epoch = len(val_jp) // BATCH_SIZE\nembedding_dims = 256\nrnn_units = 1024\ndense_units = 1024\nDtype = tf.float32\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def max_len(tensor):\n    \&quot;\&quot;\&quot;\n    Get max len in Sequences\n    \&quot;\&quot;\&quot;\n    return max( len(t) for t in tensor)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Max Len\nTx = max_len(data_en)\nTy = max_len(data_jp)\n\n# Vocab\ninput_vocab_size = len(en_tokenizer.word_index) + 1   # English\noutput_vocab_size = len(jp_tokenizer.word_index) + 1  # Japanese\n\n# Changing to TF data\ndataset = (tf.data.Dataset.from_tensor_slices((data_en, data_jp))\n           .shuffle(BUFFER_SIZE)\n           .batch(BATCH_SIZE, drop_remainder=True)\n          )\n\nval_dataset = (tf.data.Dataset.from_tensor_slices((val_en, val_jp))\n               .batch(BATCH_SIZE)\n              )\n&quot;)), mdx(&quot;p&quot;, null, &quot;Let&apos;s define our based Seq2Seq Model&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# ENCODER\nclass EncoderNetwork(tf.keras.Model):\n    def __init__(self,input_vocab_size,embedding_dims, rnn_units ):\n        super().__init__()\n        self.encoder_embedding = Embedding(input_dim=input_vocab_size,\n                                           output_dim=embedding_dims)\n        self.encoder_rnnlayer = LSTM(rnn_units,return_sequences=True,\n                                     return_state=True )\n\n# DECODER\nclass DecoderNetwork(tf.keras.Model):\n    def __init__(self,output_vocab_size, embedding_dims, rnn_units):\n        super().__init__()\n        self.decoder_embedding = Embedding(input_dim=output_vocab_size,\n                                           output_dim=embedding_dims)\n        self.dense_layer = Dense(output_vocab_size)\n        self.decoder_rnncell = LSTMCell(rnn_units)\n        # Sampler\n        self.sampler = tfa.seq2seq.sampler.TrainingSampler()\n        # Create attention mechanism with memory = None\n        self.attention_mechanism = \\\n            self.build_attention_mechanism(dense_units,None,BATCH_SIZE*[Tx])\n        self.rnn_cell = self.build_rnn_cell(BATCH_SIZE)\n        self.decoder = tfa.seq2seq.BasicDecoder(self.rnn_cell,\n                                                sampler= self.sampler,\n                                                output_layer = self.dense_layer\n                                               )\n\n    def build_attention_mechanism(self, units, memory, MSL):\n        \&quot;\&quot;\&quot;\n        MSL : Memory Sequence Length\n        \&quot;\&quot;\&quot;\n        #return tfa.seq2seq.LuongAttention(units, memory = memory,\n        #                                  memory_sequence_length = MSL)\n        return tfa.seq2seq.BahdanauAttention(units, memory = memory,\n                                             memory_sequence_length = MSL)\n\n    # wrap decodernn cell\n    def build_rnn_cell(self, batch_size):\n        return tfa.seq2seq.AttentionWrapper(self.decoder_rnncell,\n                                            self.attention_mechanism,\n                                            attention_layer_size=dense_units)\n\n    def build_decoder_initial_state(self, batch_size, encoder_state, Dtype):\n        decoder_initial_state = self.rnn_cell.get_initial_state(batch_size = batch_size,\n                                                                dtype = Dtype)\n        decoder_initial_state = decoder_initial_state.clone(cell_state = encoder_state)\n        return decoder_initial_state\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Build Model\nencoderNetwork = EncoderNetwork(input_vocab_size, embedding_dims, rnn_units)\ndecoderNetwork = DecoderNetwork(output_vocab_size, embedding_dims, rnn_units)\n\n# Optimizer\noptimizer = tf.keras.optimizers.Adam()\n&quot;)), mdx(&quot;p&quot;, null, &quot;Make custom training loop&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;def loss_function(y_pred, y):\n    #shape of y [batch_size, ty]\n    #shape of y_pred [batch_size, Ty, output_vocab_size]\n    sparsecategoricalcrossentropy = SparseCategoricalCrossentropy(from_logits=True,\n                                                                  reduction=&apos;none&apos;)\n    loss = sparsecategoricalcrossentropy(y_true=y, y_pred=y_pred)\n    mask = tf.logical_not(tf.math.equal(y,0))   #output 0 for y=0 else output 1\n    mask = tf.cast(mask, dtype=loss.dtype)\n    loss = mask * loss\n    loss = tf.reduce_mean(loss)\n    return loss\n\n@tf.function\ndef train_step(input_batch, output_batch, encoder_initial_cell_state):\n    # initialize loss = 0\n    loss = 0\n    with tf.GradientTape() as tape:\n        encoder_emb_inp = encoderNetwork.encoder_embedding(input_batch)\n        a, a_tx, c_tx = encoderNetwork.encoder_rnnlayer(encoder_emb_inp,\n                                                        initial_state = encoder_initial_cell_state)\n\n        # [last step activations,last memory_state] of\n        # encoder passed as input to decoder Network\n\n        # Prepare correct Decoder input &amp; output sequence data\n        decoder_input = output_batch[:,:-1] # ignore eos\n        # compare logits with timestepped +1 version of decoder_input\n        decoder_output = output_batch[:,1:] #ignore bos\n\n        # Decoder Embeddings\n        decoder_emb_inp = decoderNetwork.decoder_embedding(decoder_input)\n\n        # Setting up decoder memory from encoder output\n        # and Zero State for AttentionWrapperState\n        decoderNetwork.attention_mechanism.setup_memory(a)\n        decoder_initial_state = decoderNetwork.build_decoder_initial_state(BATCH_SIZE,\n                                                                           encoder_state=[a_tx, c_tx],\n                                                                           Dtype=tf.float32)\n\n        # BasicDecoderOutput\n        outputs, _, _ = decoderNetwork.decoder(decoder_emb_inp,initial_state=decoder_initial_state,\n                                               sequence_length=BATCH_SIZE*[Ty-1])\n\n        logits = outputs.rnn_output\n\n        # Calculate loss\n        loss = loss_function(logits, decoder_output)\n\n    # Returns the list of all layer variables / weights.\n    variables = encoderNetwork.trainable_variables + decoderNetwork.trainable_variables\n    # differentiate loss wrt variables\n    gradients = tape.gradient(loss, variables)\n\n    # grads_and_vars \u2013 List of(gradient, variable) pairs.\n    grads_and_vars = zip(gradients,variables)\n    optimizer.apply_gradients(grads_and_vars)\n    return loss\n\n@tf.function\ndef evaluate(input_batch, output_batch, encoder_initial_cell_state):\n    loss = 0\n    encoder_emb_inp = encoderNetwork.encoder_embedding(input_batch)\n    a, a_tx, c_tx = encoderNetwork.encoder_rnnlayer(encoder_emb_inp,\n                                                    initial_state =encoder_initial_cell_state)\n    decoder_input = output_batch[:,:-1]\n    decoder_output = output_batch[:,1:]\n    decoder_emb_inp = decoderNetwork.decoder_embedding(decoder_input)\n    decoderNetwork.attention_mechanism.setup_memory(a)\n    decoder_initial_state = decoderNetwork.build_decoder_initial_state(BATCH_SIZE,\n                                                                       encoder_state=[a_tx, c_tx],\n                                                                       Dtype=tf.float32)\n    outputs, _, _ = decoderNetwork.decoder(decoder_emb_inp,initial_state=decoder_initial_state,\n                                           sequence_length=BATCH_SIZE*[Ty-1])\n    logits = outputs.rnn_output\n    loss = loss_function(logits, decoder_output)\n    return loss\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# RNN LSTM hidden and memory state initializer\ndef initialize_initial_state():\n    return [tf.zeros((BATCH_SIZE, rnn_units)), tf.zeros((BATCH_SIZE, rnn_units))]\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;calculating-bleu-score&quot;
  }, &quot;Calculating BLEU Score&quot;), mdx(&quot;blockquote&quot;, null, mdx(&quot;p&quot;, {
    parentName: &quot;blockquote&quot;
  }, &quot;BLEU (bilingual evaluation understudy) is an algorithm for evaluating the quality of text which has been machine-translated from one natural language to another. Quality is considered to be the correspondence between a machine&apos;s output and that of a human: \&quot;the closer a machine translation is to a professional human translation, the better it is\&quot;. - Wikipedia&quot;)), mdx(&quot;p&quot;, null, &quot;BLEU is a metric for evaluating a generated sentence to a reference sentence.\nA perfect match results in a score of 1.0, whereas a perfect mismatch results in a score of 0.0.&quot;), mdx(&quot;p&quot;, null, &quot;So now we&apos;re going to define our translation function &amp; calculate the BLEU score for test data at the end of every epoch while training. Note that test data is sentences that our tokenizer didn&apos;t train with, so there must be some words that our tokenizer didn&apos;t know.\nI&apos;m currently working to fix this issue. Based on keras Tokenizer API it have &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;oov_token&quot;), &quot; for handling this but i&apos;m not sure.&quot;), mdx(&quot;p&quot;, null, &quot;For now i&apos;m handling this by adding &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;unk&quot;), &quot; in train dataset so the tokenizer can read it, and then when coming to translation if there is word that our tokenizer don&apos;t know i&apos;ll set it by index of &quot;, mdx(&quot;inlineCode&quot;, {
    parentName: &quot;p&quot;
  }, &quot;unk&quot;), &quot; not very eficient but it works.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Translate\ndef Translate(input_raw):\n    input_raw = CP(preprocess(input_raw))\n    input_lines = [&apos;bos &apos;+ input_raw + &apos;&apos;]\n\n    input_sequences, unique = [], []\n    for line in input_lines:\n        temp = []\n        for w in line.split(&apos; &apos;):\n            try:\n                temp.append(en_tokenizer.word_index[w])\n            except: # Avoid Error\n                unique.append(w)\n                temp.append(en_tokenizer.word_index[&apos;unk&apos;])\n        input_sequences.append(temp)\n\n    input_sequences = pad_sequences(input_sequences, maxlen=Tx, padding=&apos;post&apos;)\n    inp = tf.convert_to_tensor(input_sequences)\n    inference_batch_size = input_sequences.shape[0]\n    encoder_initial_cell_state = [tf.zeros((inference_batch_size, rnn_units)),\n                                  tf.zeros((inference_batch_size, rnn_units))]\n    encoder_emb_inp = encoderNetwork.encoder_embedding(inp)\n    a, a_tx, c_tx = encoderNetwork.encoder_rnnlayer(encoder_emb_inp,\n                                                    initial_state = encoder_initial_cell_state)\n\n    start_tokens = tf.fill([inference_batch_size], jp_tokenizer.word_index[&apos;bos&apos;])\n\n    end_token = jp_tokenizer.word_index[&apos;eos&apos;]\n\n    greedy_sampler = tfa.seq2seq.GreedyEmbeddingSampler()\n\n    decoder_input = tf.expand_dims([jp_tokenizer.word_index[&apos;bos&apos;]] * inference_batch_size,1)\n    decoder_emb_inp = decoderNetwork.decoder_embedding(decoder_input)\n\n    decoder_instance = tfa.seq2seq.BasicDecoder(cell = decoderNetwork.rnn_cell,\n                                                sampler = greedy_sampler,\n                                                output_layer = decoderNetwork.dense_layer)\n    decoderNetwork.attention_mechanism.setup_memory(a)\n\n    decoder_initial_state = decoderNetwork.build_decoder_initial_state(\n        inference_batch_size, encoder_state=[a_tx, c_tx], Dtype=tf.float32)\n\n    maximum_iterations = tf.round(tf.reduce_max(Tx) * 2)\n\n    decoder_embedding_matrix = decoderNetwork.decoder_embedding.variables[0]\n    (first_finished, first_inputs,first_state) = decoder_instance.initialize(\n        decoder_embedding_matrix, start_tokens = start_tokens,\n        end_token = end_token, initial_state = decoder_initial_state)\n\n    inputs = first_inputs\n    state = first_state\n    predictions = np.empty((inference_batch_size,0), dtype = np.int32)\n    for j in range(maximum_iterations):\n        outputs, next_state, next_inputs, finished = decoder_instance.step(j, inputs,state)\n        inputs = next_inputs\n        state = next_state\n        outputs = np.expand_dims(outputs.sample_id,axis = -1)\n        predictions = np.append(predictions, outputs, axis = -1)\n\n    res = &apos;&apos;\n    for i in range(len(predictions)):\n        line = predictions[i,:]\n        seq = list(itertools.takewhile(lambda index: index !=2, line))\n        res += \&quot; \&quot;.join( [jp_tokenizer.index_word[w] for w in seq])\n    res = res.split()\n\n    # Return back Unique words\n    for i in range(len(res)):\n        if res[i] == &apos;unk&apos; and unique != []:\n            res[i] = unique.pop(0)\n\n    return &apos; &apos;.join(res)\n\n# Calculate BLEU\ndef BLEU(X, y):\n    # Prediction\n    pred = [Translate(w) for w in tqdm(X)]\n    # Calculate BLEU\n    score = sacrebleu.corpus_bleu(pred, [y]).score / 100\n    return score, pred\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Custom Train Progress\nclass Progress:\n    def __init__(self):\n        self.fig = plt.figure(figsize = (8,6))\n        self.ax = self.fig.add_subplot(1, 1, 1)\n        self.loss, self.val_loss, self.BLEU = [], [], []\n        self.epoch_loss = 0\n\n    def get_val_loss(self):\n        return [x[1] for x in self.val_loss]\n\n    # Plot\n    def dynamic_plot(self):\n        self.ax.cla()\n        self.ax.plot(range(len(self.loss)), self.loss, label=&apos;loss&apos;)\n        if len(self.val_loss) &gt;= 1:\n            x = [l[0] for l in self.val_loss]\n            y = [l[1] for l in self.val_loss]\n            self.ax.plot(x, y, color = &apos;r&apos;, label=&apos;val_loss&apos;)\n            self.ax.plot(x, self.BLEU, color = &apos;purple&apos;, label=&apos;BLEU&apos;)\n        self.ax.set_ylim(0,)\n        self.ax.legend(loc = 1)\n        display(self.fig)\n\n    # Train step progress\n    def train_progress(self, epoch, step, steps_per_epoch, start):\n        self.dynamic_plot()\n        print(f&apos;Working on Epoch {epoch}&apos;)\n        print(&apos;[&apos; + (&apos;=&apos; * int((step + 1) / steps_per_epoch * 60)).ljust(61, &apos; &apos;)\n              + f&apos;]  {step + 1}/{steps_per_epoch} - loss : {round(self.epoch_loss / step, 4)}&apos;)\n        print(f&apos;Time per Step {round(timeit.default_timer() - start, 2)} s&apos;)\n\n    def summary(self):\n        loss = np.array_split(np.array(self.loss), len(self.val_loss))\n        loss = [np.mean(x) for x in loss]\n        val_loss = [x[1] for x in self.val_loss]\n        df = pd.DataFrame({&apos;Epochs&apos; : range(1, len(val_loss) + 1), &apos;loss&apos; : loss,\n                           &apos;val loss&apos; : val_loss, &apos;BLEU&apos; : self.BLEU})\n\n        self.dynamic_plot()\n        clear_output(wait = True)\n        display(df)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Initialize Train Progress\nTP = Progress()\nbest_prediction = []\n\nfor i in range(1, epochs + 1):\n\n    encoder_initial_cell_state = initialize_initial_state()\n    total_loss = 0.0\n    # Train Loss\n    TP.epoch_loss = 0\n\n    # Train\n    for (batch , (input_batch, output_batch)) in enumerate(dataset.take(steps_per_epoch)):\n        start = timeit.default_timer()\n        batch_loss = train_step(input_batch, output_batch, encoder_initial_cell_state)\n        total_loss += batch_loss\n        TP.loss.append(batch_loss.numpy())\n        TP.epoch_loss += batch_loss.numpy()\n\n        if (batch+1) % 30 == 0:\n            TP.train_progress(i, batch, steps_per_epoch, start)\n            clear_output(wait = True)\n\n    # Validitate\n    encoderNetwork.trainable = False  # Freeze our model layer to make sure\n    decoderNetwork.trainable = False  # it didn&apos;t learn anything from val_data\n\n    # Valid loss\n    val_loss = 0\n    for (batch, (input_batch, output_batch)) in enumerate(val_dataset.take(val_steps_per_epoch)):\n        batch_loss = evaluate(input_batch, output_batch, encoder_initial_cell_state)\n        val_loss += batch_loss.numpy()\n    val_loss /= val_steps_per_epoch\n\n    TP.val_loss.append((i * steps_per_epoch - 1, val_loss))\n\n    # Bleu Score\n    bleu_score, pred = BLEU(eng_test, jpn_test)\n    TP.BLEU.append(bleu_score)\n\n    encoderNetwork.trainable = True  # Unfreeze layer for next epoch\n    decoderNetwork.trainable = True\n\n    # Save best model\n    if bleu_score == max(TP.BLEU) and val_loss == min(TP.get_val_loss()):\n        best_prediction = pred\n        encoderNetwork.save_weights(&apos;encoderNetwork&apos;)\n        decoderNetwork.save_weights(&apos;decoderNetwork&apos;)\n\nTP.summary()\n&quot;)), mdx(&quot;table&quot;, null, mdx(&quot;thead&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;thead&quot;
  }, mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;Epochs&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;loss&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;val loss&quot;), mdx(&quot;th&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;BLEU&quot;))), mdx(&quot;tbody&quot;, {
    parentName: &quot;table&quot;
  }, mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;1&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.755007&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.617767&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.033657&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;2&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.507803&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.467358&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.100527&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;3&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.366943&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.404535&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.169416&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;4&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.278531&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.382699&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.206622&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;5&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.220114&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.379538&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.223136&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;6&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.180076&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.384533&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.240543&quot;)), mdx(&quot;tr&quot;, {
    parentName: &quot;tbody&quot;
  }, mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;7&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.152284&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.390775&quot;), mdx(&quot;td&quot;, {
    parentName: &quot;tr&quot;,
    &quot;align&quot;: &quot;center&quot;
  }, &quot;0.256055&quot;)))), mdx(&quot;p&quot;, null, mdx(&quot;span&quot;, {
    parentName: &quot;p&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-wrapper&quot;,
    &quot;style&quot;: {
      &quot;position&quot;: &quot;relative&quot;,
      &quot;display&quot;: &quot;block&quot;,
      &quot;marginLeft&quot;: &quot;auto&quot;,
      &quot;marginRight&quot;: &quot;auto&quot;,
      &quot;maxWidth&quot;: &quot;490px&quot;
    }
  }, &quot;\n      &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;span&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-link&quot;,
    &quot;href&quot;: &quot;/static/4968cd1de5dc4c8cb3cbadd3b3801588/41d3c/output_49_1.png&quot;,
    &quot;style&quot;: {
      &quot;display&quot;: &quot;block&quot;
    },
    &quot;target&quot;: &quot;_blank&quot;,
    &quot;rel&quot;: &quot;noopener&quot;
  }, &quot;\n    &quot;, mdx(&quot;span&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-background-image&quot;,
    &quot;style&quot;: {
      &quot;paddingBottom&quot;: &quot;72.78481012658227%&quot;,
      &quot;position&quot;: &quot;relative&quot;,
      &quot;bottom&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;,
      &quot;backgroundImage&quot;: &quot;url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACXklEQVQ4y52RT08TQRjG9zt48SuYgISEePBuIn6HBoMaE60XPXKRqjF69WI8ATcPRk0jCUYM8k+FQOgChZZu6F/ows7u0m53d3Zn3sdsWy0NJlIneTIzyby/93mfUTKZzFXDMN6apjlpmuZUL2KMTR0Y1lShWJrQdf29pmnXlFxu7y4X+K9FAKRdR7lYRKlcBmPsoVIsFmIuFyACJ6KwF0kpQ243wqOq7hmGEQHvK9ns7qjLKQIKgIjonO46D6NDEN0ZY3GlWMiPuFz2BPz9KNqbFYQgDEOYphlX8vvaTceXkKeA/4KeAQKBEKLlMK9lRku2hJAQRB2HPYzeDazp+ZHUgUTJbjmUktqdW/Gcw203sJBL3zqqEybWIPIW6PRYv4V2g865ncvfRi6WKjFAIlWFeL0c0o90HbYTdrmQ1FKTgTPqBqqqeicaM6rT66B3qy7ezJhY2zmBrjvwTxwgSgOyrRamE01zBWEoYJosrlQqlZiUf365WVGugZIqp8nFBn1YdymVOaGVbYusQ4saVUZulRFsRjAZwYpkcDh1GLYdV9Lp9O3213blLwTgB4BWCTG9EeCzyjGT4vi07uNLysf3HR9fVR/b+z5WM77QDjm8hvVA0TQtFgQBhBBewAPumq5XNxzuGA73bdeTns8R+Bwi8Fwv4DwUvMbJK9nSNxzBNUZe5lg6xzUOix3fUxKJxMVkMnllc2uzb2lhaWDs0dj1+dn5ge3cTv+T50+H55aXBtXsXt/YeOLGys/Fwd0ttf/ls/HhjYXpocAsXXr14vGw+u3jkFHKXp6dW7jwC/SSU1VUgwWcAAAAAElFTkSuQmCC&apos;)&quot;,
      &quot;backgroundSize&quot;: &quot;cover&quot;,
      &quot;display&quot;: &quot;block&quot;
    }
  }), &quot;\n  &quot;, mdx(&quot;img&quot;, {
    parentName: &quot;a&quot;,
    &quot;className&quot;: &quot;gatsby-resp-image-image&quot;,
    &quot;alt&quot;: &quot;png&quot;,
    &quot;title&quot;: &quot;png&quot;,
    &quot;src&quot;: &quot;/static/4968cd1de5dc4c8cb3cbadd3b3801588/41d3c/output_49_1.png&quot;,
    &quot;srcSet&quot;: [&quot;/static/4968cd1de5dc4c8cb3cbadd3b3801588/c26ae/output_49_1.png 158w&quot;, &quot;/static/4968cd1de5dc4c8cb3cbadd3b3801588/6bdcf/output_49_1.png 315w&quot;, &quot;/static/4968cd1de5dc4c8cb3cbadd3b3801588/41d3c/output_49_1.png 490w&quot;],
    &quot;sizes&quot;: &quot;(max-width: 490px) 100vw, 490px&quot;,
    &quot;style&quot;: {
      &quot;width&quot;: &quot;100%&quot;,
      &quot;height&quot;: &quot;100%&quot;,
      &quot;margin&quot;: &quot;0&quot;,
      &quot;verticalAlign&quot;: &quot;middle&quot;,
      &quot;position&quot;: &quot;absolute&quot;,
      &quot;top&quot;: &quot;0&quot;,
      &quot;left&quot;: &quot;0&quot;
    },
    &quot;loading&quot;: &quot;lazy&quot;,
    &quot;decoding&quot;: &quot;async&quot;
  }), &quot;\n  &quot;), &quot;\n    &quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;# Load best weights\nencoderNetwork.load_weights(&apos;encoderNetwork&apos;)\ndecoderNetwork.load_weights(&apos;decoderNetwork&apos;)\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;&lt;tensorflow.python.training.tracking.util.CheckpointLoadStatus at 0x7fb3601083d0&gt;\n&quot;)), mdx(&quot;p&quot;, null, &quot;Let&apos;s check the best prediction of our model.&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;for i in range(7,16):\n    print(\&quot;English Sentence:\&quot;)\n    print(eng_test[i])\n    print(\&quot;\\nJapanese Translation:\&quot;)\n    print(best_prediction[i])\n    print(\&quot;\\nJapanese Reference:\&quot;)\n    print(jpn_test[i])\n    print(&apos;&apos;.ljust(60, &apos;-&apos;))\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;English Sentence:\nin september there are just a few people here and there on the beach\n\nJapanese Translation:\n\uFF19 \u6642 \u306B \u306F \u3053\u3053 \u306B \u4ED6 \u306E \u4EBA \u304C \u4F4F\u3093 \u3067 \u3044 \u306A\u3044 \u4EBA \u304C \u305D\u306E \u30D3\u30FC\u30C1 \u3067 \u4ED6 \u306E \u4EBA\u9054 \u304C \u6B8B\u308A \u306E \u3082\u3068 \u3092 \u3042\u3061\u3089 \u306B \u5EFA\u8A2D \u898B \u305F\n\nJapanese Reference:\n\uFF19\u6708 \u306E \u6D77 \u306F \u4EBA \u304C \u307E\u3070\u3089 \u3060 \u306D\n------------------------------------------------------------\nEnglish Sentence:\nwhile you are young you should read a lot\n\nJapanese Translation:\n\u82E5\u3044 \u9803 \u306F \u8AAD\u307F \u7D42\u308F\u3063 \u305F\u3089 \u3044\u3044 \u3088\n\nJapanese Reference:\n\u82E5\u3044 \u3046\u3061 \u306B \u305F\u304F\u3055\u3093 \u306E \u672C \u3092 \u8AAD\u3080 \u3079\u304D \u3060\n------------------------------------------------------------\nEnglish Sentence:\nhere i come\n\nJapanese Translation:\n\u3053\u3053 \u306B \u6765 \u305F \u306E\n\nJapanese Reference:\n\u3044\u307E \u884C\u304D \u307E\u3059\n------------------------------------------------------------\nEnglish Sentence:\nonce you have decided when you will be coming let me know\n\nJapanese Translation:\n\u6765\u308B \u304B \u541B \u306B \u306F \u9023\u7D61 \u3092 \u8A00\u3063 \u3066 \u304D \u305F \u3088\n\nJapanese Reference:\n\u3044\u3064 \u6765\u308B \u304B \u6C7A\u307E\u3063 \u305F\u3089 \u6559\u3048 \u3066\n------------------------------------------------------------\nEnglish Sentence:\nhe jumped on the train\n\nJapanese Translation:\n\u5F7C \u306F \u96FB\u8ECA \u306B \u65D7 \u3092 \u98DB\u3073\u8D8A\u3048 \u305F\n\nJapanese Reference:\n\u5F7C \u306F \u96FB\u8ECA \u306B \u98DB\u3073\u4E57\u3063 \u305F\n------------------------------------------------------------\nEnglish Sentence:\nhe passed away yesterday\n\nJapanese Translation:\n\u5F7C \u306F \u6628\u65E5 \u4EA1\u304F\u306A\u3063 \u305F\n\nJapanese Reference:\n\u5F7C \u306F \u6628\u65E5 \u304A \u4EA1\u304F\u306A\u308A \u306B \u306A\u308A \u307E\u3057 \u305F\n------------------------------------------------------------\nEnglish Sentence:\ni had no other choice\n\nJapanese Translation:\n\u4ED6 \u306B \u9078\u629E\u80A2 \u304C \u306A\u304B\u3063 \u305F\n\nJapanese Reference:\n\u4ED6 \u306B \u624B \u304C \u306A\u304B\u3063 \u305F \u306E \u3060\n------------------------------------------------------------\nEnglish Sentence:\nare you good at bowling\n\nJapanese Translation:\n\u30DC\u30FC\u30EA\u30F3\u30B0 \u306F \u5F97\u610F \u3067\u3059 \u304B\n\nJapanese Reference:\n\u30DC\u30A6\u30EA\u30F3\u30B0 \u306F \u5F97\u610F\n------------------------------------------------------------\nEnglish Sentence:\nit is strange that you do not know anything about that matter\n\nJapanese Translation:\n\u305D\u308C \u306B\u3064\u3044\u3066 \u4F55 \u3082 \u77E5\u3089 \u306A\u3044 \u3053\u3068 \u304C \u306A\u3044 \u3068\u3044\u3046 \u3053\u3068 \u306F \u5909 \u3060\n\nJapanese Reference:\n\u3042\u306A\u305F \u304C \u305D\u306E \u3053\u3068 \u306B\u3064\u3044\u3066 \u4F55 \u3082 \u77E5\u3089 \u306A\u3044 \u306E \u306F \u5909 \u3060\n------------------------------------------------------------\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;test-with-some-raw-input&quot;
  }, &quot;Test with Some Raw Input&quot;), mdx(&quot;p&quot;, null, &quot;Yeay now let&apos;s play with &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;our&quot;), &quot; Machine Translation with some raw input. We&apos;ll cross check the prediction from MT with Google Translate API to translate it back to english and see how bad &quot;, mdx(&quot;strong&quot;, {
    parentName: &quot;p&quot;
  }, &quot;our&quot;), &quot; MT is :).&quot;), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;from googletrans import Translator\n# Google Translate\ntranslator = Translator()\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;raw_input = [&apos;i love you&apos;, &apos;i am sorry&apos;, &apos;hello&apos;, &apos;thank you&apos;,\n             &apos;is there something i can help?&apos;]\n\nfor i in range(len(raw_input)):\n    prediction = Translate(raw_input[i])\n    print(\&quot;English Sentence:\&quot;)\n    print(raw_input[i])\n    print(\&quot;\\nJapanese Translation:\&quot;)\n    print(prediction)\n    print(\&quot;\\nEnglish Translation from prediction [GoogleTranslate]:\&quot;)\n    print(translator.translate(prediction).text)\n    print(&apos;&apos;.ljust(60, &apos;-&apos;))\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;
  }, &quot;English Sentence:\ni love you\n\nJapanese Translation:\n\u611B\u3057 \u3066\u308B \u3088\n\nEnglish Translation from prediction [GoogleTranslate]:\nI love you\n------------------------------------------------------------\nEnglish Sentence:\ni am sorry\n\nJapanese Translation:\n\u3059\u307F\u307E\u305B\u3093\n\nEnglish Translation from prediction [GoogleTranslate]:\nExcuse me\n------------------------------------------------------------\nEnglish Sentence:\nhello\n\nJapanese Translation:\n\u3082\u3057\u3082\u3057\n\nEnglish Translation from prediction [GoogleTranslate]:\nHello\n------------------------------------------------------------\nEnglish Sentence:\nthank you\n\nJapanese Translation:\n\u3042\u308A\u304C\u3068\u3046 \u3054\u3056\u3044 \u307E\u3059\n\nEnglish Translation from prediction [GoogleTranslate]:\nThank you\n------------------------------------------------------------\nEnglish Sentence:\nis there something i can help?\n\nJapanese Translation:\n\u4F55 \u304B \u624B\u4F1D\u3048\u308B \u3082\u306E \u304C \u3042\u308B \u306E\n\nEnglish Translation from prediction [GoogleTranslate]:\nThere is something to help\n------------------------------------------------------------\n&quot;)), mdx(&quot;pre&quot;, null, mdx(&quot;code&quot;, {
    parentName: &quot;pre&quot;,
    &quot;className&quot;: &quot;language-python&quot;
  }, &quot;import pickle\n\nwith open(&apos;en_tokenizer.pickle&apos;, &apos;wb&apos;) as handle:\n    pickle.dump(en_tokenizer, handle, protocol=pickle.HIGHEST_PROTOCOL)\nhandle.close()\n\nwith open(&apos;jp_tokenizer.pickle&apos;, &apos;wb&apos;) as handle:\n    pickle.dump(jp_tokenizer, handle, protocol=pickle.HIGHEST_PROTOCOL)\nhandle.close()\n&quot;)), mdx(&quot;h2&quot;, {
    &quot;id&quot;: &quot;reference&quot;
  }, &quot;Reference&quot;), mdx(&quot;ol&quot;, null, mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;TensorFlow Addons Networks : Sequence-to-Sequence NMT with Attention Mechanism &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.tensorflow.org/addons/tutorials/networks_seq2seq_nmt&quot;
  }, &quot;Link&quot;)), mdx(&quot;li&quot;, {
    parentName: &quot;ol&quot;
  }, &quot;seq2seq (Sequence to Sequence) Model for Deep Learning with PyTorch &quot;, mdx(&quot;a&quot;, {
    parentName: &quot;li&quot;,
    &quot;href&quot;: &quot;https://www.guru99.com/seq2seq-model.html&quot;
  }, &quot;Link&quot;))));
}
;
MDXContent.isMDXComponent = true;</content:encoded></item></channel></rss>